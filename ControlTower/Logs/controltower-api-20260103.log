2026-01-03 13:15:34.340 [INF]  - Starting ControlTower API
2026-01-03 13:15:49.500 [INF] Microsoft.Hosting.Lifetime - Now listening on: https://localhost:7145
2026-01-03 13:15:57.255 [INF] Microsoft.Hosting.Lifetime - Application started. Press Ctrl+C to shut down.
2026-01-03 13:15:58.976 [INF] Microsoft.Hosting.Lifetime - Hosting environment: Development
2026-01-03 13:16:00.169 [INF] Microsoft.Hosting.Lifetime - Content root path: C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower\ControlTower
2026-01-03 22:24:48.804 [INF]  - Starting ControlTower API
2026-01-03 22:24:54.011 [INF] Microsoft.Hosting.Lifetime - Now listening on: https://localhost:7145
2026-01-03 22:24:54.427 [INF] Microsoft.Hosting.Lifetime - Application started. Press Ctrl+C to shut down.
2026-01-03 22:24:54.441 [INF] Microsoft.Hosting.Lifetime - Hosting environment: Development
2026-01-03 22:24:54.448 [INF] Microsoft.Hosting.Lifetime - Content root path: C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower\ControlTower
2026-01-03 22:25:54.372 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (220ms) [Parameters=[@__signInDto_Email_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[ID], [u].[CompanyID], [u].[CreatedBy], [u].[CreatedDate], [u].[DateOfBirth], [u].[DepartmentID], [u].[Email], [u].[EmergencyContactName], [u].[EmergencyContactNumber], [u].[EmergencyRelationship], [u].[FirstName], [u].[Gender], [u].[IsDeleted], [u].[LastLogin], [u].[LastName], [u].[LastWorkingDate], [u].[LoginPassword], [u].[MobileNo], [u].[Nationality], [u].[OccupationID], [u].[OccupationLevelID], [u].[Rating], [u].[Religion], [u].[Remark], [u].[StaffCardID], [u].[StaffRFIDCardID], [u].[StartWorkingDate], [u].[SubDepartmentID], [u].[UpdatedBy], [u].[UpdatedDate], [u].[WorkPassCardExpiredDate], [u].[WorkPassCardIssuedDate], [u].[WorkPassCardNumber], [u].[WorkPermit], [s].[ID], [s].[CreatedBy], [s].[CreatedDate], [s].[DepartmentID], [s].[Description], [s].[IsDeleted], [s].[Name], [s].[Rating], [s].[Remark], [s].[UpdatedBy], [s].[UpdatedDate], [d].[ID], [d].[CreatedBy], [d].[CreatedDate], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Rating], [d].[Remark], [d].[UpdatedBy], [d].[UpdatedDate], [o].[ID], [o].[CreatedBy], [o].[CreatedDate], [o].[Description], [o].[IsDeleted], [o].[OccupationLevelID], [o].[OccupationName], [o].[Rating], [o].[Remark], [o].[UpdatedBy], [o].[UpdatedDate]
FROM [Users] AS [u]
INNER JOIN [SubDepartments] AS [s] ON [u].[SubDepartmentID] = [s].[ID]
INNER JOIN [Departments] AS [d] ON [s].[DepartmentID] = [d].[ID]
INNER JOIN [Occupations] AS [o] ON [u].[OccupationID] = [o].[ID]
WHERE [u].[Email] = @__signInDto_Email_0 AND [u].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:25:56.280 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (39ms) [Parameters=[@p1='?' (DbType = Guid), @p0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Users] SET [LastLogin] = @p0
OUTPUT 1
WHERE [ID] = @p1;
2026-01-03 22:25:56.367 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (15ms) [Parameters=[@__applicationName_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[ID], [a].[ApplicationName], [a].[CreatedBy], [a].[CreatedDate], [a].[Description], [a].[IsDeleted], [a].[Rating], [a].[Remark], [a].[UpdatedBy], [a].[UpdatedDate]
FROM [Applications] AS [a]
WHERE [a].[ApplicationName] = @__applicationName_0 AND [a].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:25:56.491 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (25ms) [Parameters=[@__user_ID_0='?' (DbType = Guid), @__newsPortalApp_ID_1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[ID], [u].[AccessLevelID], [u].[ApplicationID], [u].[CreatedBy], [u].[CreatedDate], [u].[GrantedBy], [u].[GrantedDate], [u].[IsDeleted], [u].[IsRevoked], [u].[Remark], [u].[RevokedDate], [u].[UpdatedBy], [u].[UpdatedDate], [u].[UserID], [a].[ID], [a].[CreatedBy], [a].[CreatedDate], [a].[Description], [a].[IsDeleted], [a].[LevelName], [a].[UpdatedBy], [a].[UpdatedDate]
FROM [UserApplicationAccesses] AS [u]
INNER JOIN [AccessLevels] AS [a] ON [u].[AccessLevelID] = [a].[ID]
WHERE [u].[UserID] = @__user_ID_0 AND [u].[ApplicationID] = @__newsPortalApp_ID_1 AND [u].[IsDeleted] = CAST(0 AS bit) AND [u].[IsRevoked] = CAST(0 AS bit)
2026-01-03 22:25:57.012 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ID], [a].[ApplicationName], [a].[Description], [a].[Remark], [a].[Rating], [a].[CreatedDate], [a].[UpdatedDate], CASE
    WHEN [u].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u].[FirstName], [u].[LastName], CASE
    WHEN [u0].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u0].[FirstName], [u0].[LastName]
FROM [Applications] AS [a]
LEFT JOIN [Users] AS [u] ON [a].[CreatedBy] = [u].[ID]
LEFT JOIN [Users] AS [u0] ON [a].[UpdatedBy] = [u0].[ID]
WHERE [a].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:25:57.186 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ID], [a].[ApplicationName], [a].[Description], [a].[Remark], [a].[Rating], [a].[CreatedDate], [a].[UpdatedDate], CASE
    WHEN [u].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u].[FirstName], [u].[LastName], CASE
    WHEN [u0].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u0].[FirstName], [u0].[LastName]
FROM [Applications] AS [a]
LEFT JOIN [Users] AS [u] ON [a].[CreatedBy] = [u].[ID]
LEFT JOIN [Users] AS [u0] ON [a].[UpdatedBy] = [u0].[ID]
WHERE [a].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:25:57.236 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (24ms) [Parameters=[@__employeeId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[ID], [u].[UserID], [u].[ApplicationID], [u].[AccessLevelID], [u].[GrantedDate], [u].[IsRevoked], [u].[RevokedDate], [u].[GrantedBy], [u].[Remark], [u].[CreatedDate], [u].[UpdatedDate], [u0].[FirstName], [u0].[LastName], [u0].[StaffCardID], [a].[ApplicationName], CASE
    WHEN [u1].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u1].[FirstName], [u1].[LastName], CASE
    WHEN [u2].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u2].[FirstName], [u2].[LastName], CASE
    WHEN [u3].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u3].[FirstName], [u3].[LastName]
FROM [UserApplicationAccesses] AS [u]
INNER JOIN [Users] AS [u0] ON [u].[UserID] = [u0].[ID]
INNER JOIN [Applications] AS [a] ON [u].[ApplicationID] = [a].[ID]
LEFT JOIN [Users] AS [u1] ON [u].[GrantedBy] = [u1].[ID]
LEFT JOIN [Users] AS [u2] ON [u].[CreatedBy] = [u2].[ID]
LEFT JOIN [Users] AS [u3] ON [u].[UpdatedBy] = [u3].[ID]
WHERE [u].[UserID] = @__employeeId_0 AND [u].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:25:57.288 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (3ms) [Parameters=[@__employeeId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[ID], [u].[UserID], [u].[ApplicationID], [u].[AccessLevelID], [u].[GrantedDate], [u].[IsRevoked], [u].[RevokedDate], [u].[GrantedBy], [u].[Remark], [u].[CreatedDate], [u].[UpdatedDate], [u0].[FirstName], [u0].[LastName], [u0].[StaffCardID], [a].[ApplicationName], CASE
    WHEN [u1].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u1].[FirstName], [u1].[LastName], CASE
    WHEN [u2].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u2].[FirstName], [u2].[LastName], CASE
    WHEN [u3].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u3].[FirstName], [u3].[LastName]
FROM [UserApplicationAccesses] AS [u]
INNER JOIN [Users] AS [u0] ON [u].[UserID] = [u0].[ID]
INNER JOIN [Applications] AS [a] ON [u].[ApplicationID] = [a].[ID]
LEFT JOIN [Users] AS [u1] ON [u].[GrantedBy] = [u1].[ID]
LEFT JOIN [Users] AS [u2] ON [u].[CreatedBy] = [u2].[ID]
LEFT JOIN [Users] AS [u3] ON [u].[UpdatedBy] = [u3].[ID]
WHERE [u].[UserID] = @__employeeId_0 AND [u].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:26:05.463 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[ID], [r].[Name], [r].[IsDeleted], [r].[CreatedDate], [r].[UpdatedDate], [r].[CreatedBy], [r].[UpdatedBy], CASE
    WHEN [u].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u].[FirstName], [u].[LastName], CASE
    WHEN [u0].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u0].[FirstName], [u0].[LastName]
FROM [ReportFormTypes] AS [r]
LEFT JOIN [Users] AS [u] ON [r].[CreatedBy] = [u].[ID]
LEFT JOIN [Users] AS [u0] ON [r].[UpdatedBy] = [u0].[ID]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:26:05.486 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[ID], [r].[Name], [r].[IsDeleted], [r].[CreatedDate], [r].[UpdatedDate], [r].[CreatedBy], [r].[UpdatedBy], CASE
    WHEN [u].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u].[FirstName], [u].[LastName], CASE
    WHEN [u0].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u0].[FirstName], [u0].[LastName]
FROM [ReportFormTypes] AS [r]
LEFT JOIN [Users] AS [u] ON [r].[CreatedBy] = [u].[ID]
LEFT JOIN [Users] AS [u0] ON [r].[UpdatedBy] = [u0].[ID]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:26:05.518 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [ReportForms] AS [r]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:26:05.767 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (116ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [r1].[ID], [r1].[ReportFormTypeID], [r0].[Name], [r1].[JobNo], [r1].[SystemNameWarehouseID], [s].[Name], [r1].[StationNameWarehouseID], [s0].[Name], (
    SELECT TOP(1) [c].[Customer]
    FROM [CMReportForms] AS [c]
    WHERE [c].[ReportFormID] = [r1].[ID] AND [c].[IsDeleted] = CAST(0 AS bit)), (
    SELECT TOP(1) [c0].[ProjectNo]
    FROM [CMReportForms] AS [c0]
    WHERE [c0].[ReportFormID] = [r1].[ID] AND [c0].[IsDeleted] = CAST(0 AS bit)), [r1].[IsDeleted], [r1].[CreatedDate], [r1].[UpdatedDate], [r1].[CreatedBy], [u].[FirstName] + N' ' + [u].[LastName], [r1].[UpdatedBy], CASE
    WHEN [u0].[ID] IS NOT NULL THEN COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'')
END, [r1].[UploadStatus], [r1].[UploadHostname], [r1].[UploadIPAddress], [r1].[FormStatus], [s2].[PMReportFormTypeID], [s2].[TypeName], [s2].[Customer], [s2].[ProjectNo], [s2].[FormStatusName], [s2].[c], [s4].[PMReportFormTypeID], [s4].[TypeName], [s4].[Customer], [s4].[ProjectNo], [s4].[FormStatusName], [s4].[c], [s6].[CMReportFormTypeID], [s6].[TypeName], [s6].[FormStatusName], [s6].[c]
FROM (
    SELECT [r].[ID], [r].[CreatedBy], [r].[CreatedDate], [r].[FormStatus], [r].[IsDeleted], [r].[JobNo], [r].[ReportFormTypeID], [r].[StationNameWarehouseID], [r].[SystemNameWarehouseID], [r].[UpdatedBy], [r].[UpdatedDate], [r].[UploadHostname], [r].[UploadIPAddress], [r].[UploadStatus]
    FROM [ReportForms] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [r].[CreatedDate] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [r1]
INNER JOIN [ReportFormTypes] AS [r0] ON [r1].[ReportFormTypeID] = [r0].[ID]
INNER JOIN [SystemNameWarehouses] AS [s] ON [r1].[SystemNameWarehouseID] = [s].[ID]
INNER JOIN [StationNameWarehouses] AS [s0] ON [r1].[StationNameWarehouseID] = [s0].[ID]
INNER JOIN [Users] AS [u] ON [r1].[CreatedBy] = [u].[ID]
LEFT JOIN [Users] AS [u0] ON [r1].[UpdatedBy] = [u0].[ID]
LEFT JOIN (
    SELECT [s1].[PMReportFormTypeID], [s1].[TypeName], [s1].[Customer], [s1].[ProjectNo], [s1].[FormStatusName], [s1].[c], [s1].[ReportFormID]
    FROM (
        SELECT [p].[PMReportFormTypeID], [p0].[Name] AS [TypeName], [p].[Customer], [p].[ProjectNo], [f].[Name] AS [FormStatusName], 1 AS [c], [p].[ReportFormID], ROW_NUMBER() OVER(PARTITION BY [p].[ReportFormID] ORDER BY [p].[ID], [p0].[ID], [f].[ID]) AS [row]
        FROM [PMReportFormRTU] AS [p]
        INNER JOIN [PMReportFormTypes] AS [p0] ON [p].[PMReportFormTypeID] = [p0].[ID]
        INNER JOIN [FormStatusWarehouses] AS [f] ON [p].[FormstatusID] = [f].[ID]
        WHERE [p].[IsDeleted] = CAST(0 AS bit)
    ) AS [s1]
    WHERE [s1].[row] <= 1
) AS [s2] ON [r1].[ID] = [s2].[ReportFormID]
LEFT JOIN (
    SELECT [s3].[PMReportFormTypeID], [s3].[TypeName], [s3].[Customer], [s3].[ProjectNo], [s3].[FormStatusName], [s3].[c], [s3].[ReportFormID]
    FROM (
        SELECT [p1].[PMReportFormTypeID], [p2].[Name] AS [TypeName], [p1].[Customer], [p1].[ProjectNo], [f0].[Name] AS [FormStatusName], 1 AS [c], [p1].[ReportFormID], ROW_NUMBER() OVER(PARTITION BY [p1].[ReportFormID] ORDER BY [p1].[ID], [p2].[ID], [f0].[ID]) AS [row]
        FROM [PMReportFormServer] AS [p1]
        INNER JOIN [PMReportFormTypes] AS [p2] ON [p1].[PMReportFormTypeID] = [p2].[ID]
        INNER JOIN [FormStatusWarehouses] AS [f0] ON [p1].[FormstatusID] = [f0].[ID]
        WHERE [p1].[IsDeleted] = CAST(0 AS bit)
    ) AS [s3]
    WHERE [s3].[row] <= 1
) AS [s4] ON [r1].[ID] = [s4].[ReportFormID]
LEFT JOIN (
    SELECT [s5].[CMReportFormTypeID], [s5].[TypeName], [s5].[FormStatusName], [s5].[c], [s5].[ReportFormID]
    FROM (
        SELECT [c1].[CMReportFormTypeID], [c2].[Name] AS [TypeName], [f1].[Name] AS [FormStatusName], 1 AS [c], [c1].[ReportFormID], ROW_NUMBER() OVER(PARTITION BY [c1].[ReportFormID] ORDER BY [c1].[ID], [c2].[ID], [f1].[ID]) AS [row]
        FROM [CMReportForms] AS [c1]
        INNER JOIN [CMReportFormTypes] AS [c2] ON [c1].[CMReportFormTypeID] = [c2].[ID]
        INNER JOIN [FormStatusWarehouses] AS [f1] ON [c1].[FormstatusID] = [f1].[ID]
        WHERE [c1].[IsDeleted] = CAST(0 AS bit)
    ) AS [s5]
    WHERE [s5].[row] <= 1
) AS [s6] ON [r1].[ID] = [s6].[ReportFormID]
ORDER BY [r1].[CreatedDate] DESC
2026-01-03 22:26:05.829 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [ReportForms] AS [r]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:26:05.842 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [r1].[ID], [r1].[ReportFormTypeID], [r0].[Name], [r1].[JobNo], [r1].[SystemNameWarehouseID], [s].[Name], [r1].[StationNameWarehouseID], [s0].[Name], (
    SELECT TOP(1) [c].[Customer]
    FROM [CMReportForms] AS [c]
    WHERE [c].[ReportFormID] = [r1].[ID] AND [c].[IsDeleted] = CAST(0 AS bit)), (
    SELECT TOP(1) [c0].[ProjectNo]
    FROM [CMReportForms] AS [c0]
    WHERE [c0].[ReportFormID] = [r1].[ID] AND [c0].[IsDeleted] = CAST(0 AS bit)), [r1].[IsDeleted], [r1].[CreatedDate], [r1].[UpdatedDate], [r1].[CreatedBy], [u].[FirstName] + N' ' + [u].[LastName], [r1].[UpdatedBy], CASE
    WHEN [u0].[ID] IS NOT NULL THEN COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'')
END, [r1].[UploadStatus], [r1].[UploadHostname], [r1].[UploadIPAddress], [r1].[FormStatus], [s2].[PMReportFormTypeID], [s2].[TypeName], [s2].[Customer], [s2].[ProjectNo], [s2].[FormStatusName], [s2].[c], [s4].[PMReportFormTypeID], [s4].[TypeName], [s4].[Customer], [s4].[ProjectNo], [s4].[FormStatusName], [s4].[c], [s6].[CMReportFormTypeID], [s6].[TypeName], [s6].[FormStatusName], [s6].[c]
FROM (
    SELECT [r].[ID], [r].[CreatedBy], [r].[CreatedDate], [r].[FormStatus], [r].[IsDeleted], [r].[JobNo], [r].[ReportFormTypeID], [r].[StationNameWarehouseID], [r].[SystemNameWarehouseID], [r].[UpdatedBy], [r].[UpdatedDate], [r].[UploadHostname], [r].[UploadIPAddress], [r].[UploadStatus]
    FROM [ReportForms] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [r].[CreatedDate] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [r1]
INNER JOIN [ReportFormTypes] AS [r0] ON [r1].[ReportFormTypeID] = [r0].[ID]
INNER JOIN [SystemNameWarehouses] AS [s] ON [r1].[SystemNameWarehouseID] = [s].[ID]
INNER JOIN [StationNameWarehouses] AS [s0] ON [r1].[StationNameWarehouseID] = [s0].[ID]
INNER JOIN [Users] AS [u] ON [r1].[CreatedBy] = [u].[ID]
LEFT JOIN [Users] AS [u0] ON [r1].[UpdatedBy] = [u0].[ID]
LEFT JOIN (
    SELECT [s1].[PMReportFormTypeID], [s1].[TypeName], [s1].[Customer], [s1].[ProjectNo], [s1].[FormStatusName], [s1].[c], [s1].[ReportFormID]
    FROM (
        SELECT [p].[PMReportFormTypeID], [p0].[Name] AS [TypeName], [p].[Customer], [p].[ProjectNo], [f].[Name] AS [FormStatusName], 1 AS [c], [p].[ReportFormID], ROW_NUMBER() OVER(PARTITION BY [p].[ReportFormID] ORDER BY [p].[ID], [p0].[ID], [f].[ID]) AS [row]
        FROM [PMReportFormRTU] AS [p]
        INNER JOIN [PMReportFormTypes] AS [p0] ON [p].[PMReportFormTypeID] = [p0].[ID]
        INNER JOIN [FormStatusWarehouses] AS [f] ON [p].[FormstatusID] = [f].[ID]
        WHERE [p].[IsDeleted] = CAST(0 AS bit)
    ) AS [s1]
    WHERE [s1].[row] <= 1
) AS [s2] ON [r1].[ID] = [s2].[ReportFormID]
LEFT JOIN (
    SELECT [s3].[PMReportFormTypeID], [s3].[TypeName], [s3].[Customer], [s3].[ProjectNo], [s3].[FormStatusName], [s3].[c], [s3].[ReportFormID]
    FROM (
        SELECT [p1].[PMReportFormTypeID], [p2].[Name] AS [TypeName], [p1].[Customer], [p1].[ProjectNo], [f0].[Name] AS [FormStatusName], 1 AS [c], [p1].[ReportFormID], ROW_NUMBER() OVER(PARTITION BY [p1].[ReportFormID] ORDER BY [p1].[ID], [p2].[ID], [f0].[ID]) AS [row]
        FROM [PMReportFormServer] AS [p1]
        INNER JOIN [PMReportFormTypes] AS [p2] ON [p1].[PMReportFormTypeID] = [p2].[ID]
        INNER JOIN [FormStatusWarehouses] AS [f0] ON [p1].[FormstatusID] = [f0].[ID]
        WHERE [p1].[IsDeleted] = CAST(0 AS bit)
    ) AS [s3]
    WHERE [s3].[row] <= 1
) AS [s4] ON [r1].[ID] = [s4].[ReportFormID]
LEFT JOIN (
    SELECT [s5].[CMReportFormTypeID], [s5].[TypeName], [s5].[FormStatusName], [s5].[c], [s5].[ReportFormID]
    FROM (
        SELECT [c1].[CMReportFormTypeID], [c2].[Name] AS [TypeName], [f1].[Name] AS [FormStatusName], 1 AS [c], [c1].[ReportFormID], ROW_NUMBER() OVER(PARTITION BY [c1].[ReportFormID] ORDER BY [c1].[ID], [c2].[ID], [f1].[ID]) AS [row]
        FROM [CMReportForms] AS [c1]
        INNER JOIN [CMReportFormTypes] AS [c2] ON [c1].[CMReportFormTypeID] = [c2].[ID]
        INNER JOIN [FormStatusWarehouses] AS [f1] ON [c1].[FormstatusID] = [f1].[ID]
        WHERE [c1].[IsDeleted] = CAST(0 AS bit)
    ) AS [s5]
    WHERE [s5].[row] <= 1
) AS [s6] ON [r1].[ID] = [s6].[ReportFormID]
ORDER BY [r1].[CreatedDate] DESC
2026-01-03 22:37:53.756 [INF]  - Starting ControlTower API
2026-01-03 22:37:59.176 [INF] Microsoft.Hosting.Lifetime - Now listening on: https://localhost:7145
2026-01-03 22:38:00.208 [INF] Microsoft.Hosting.Lifetime - Application started. Press Ctrl+C to shut down.
2026-01-03 22:38:00.418 [INF] Microsoft.Hosting.Lifetime - Hosting environment: Development
2026-01-03 22:38:00.433 [INF] Microsoft.Hosting.Lifetime - Content root path: C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower\ControlTower
2026-01-03 22:39:29.422 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (176ms) [Parameters=[@__signInDto_Email_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[ID], [u].[CompanyID], [u].[CreatedBy], [u].[CreatedDate], [u].[DateOfBirth], [u].[DepartmentID], [u].[Email], [u].[EmergencyContactName], [u].[EmergencyContactNumber], [u].[EmergencyRelationship], [u].[FirstName], [u].[Gender], [u].[IsDeleted], [u].[LastLogin], [u].[LastName], [u].[LastWorkingDate], [u].[LoginPassword], [u].[MobileNo], [u].[Nationality], [u].[OccupationID], [u].[OccupationLevelID], [u].[Rating], [u].[Religion], [u].[Remark], [u].[StaffCardID], [u].[StaffRFIDCardID], [u].[StartWorkingDate], [u].[SubDepartmentID], [u].[UpdatedBy], [u].[UpdatedDate], [u].[WorkPassCardExpiredDate], [u].[WorkPassCardIssuedDate], [u].[WorkPassCardNumber], [u].[WorkPermit], [s].[ID], [s].[CreatedBy], [s].[CreatedDate], [s].[DepartmentID], [s].[Description], [s].[IsDeleted], [s].[Name], [s].[Rating], [s].[Remark], [s].[UpdatedBy], [s].[UpdatedDate], [d].[ID], [d].[CreatedBy], [d].[CreatedDate], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Rating], [d].[Remark], [d].[UpdatedBy], [d].[UpdatedDate], [o].[ID], [o].[CreatedBy], [o].[CreatedDate], [o].[Description], [o].[IsDeleted], [o].[OccupationLevelID], [o].[OccupationName], [o].[Rating], [o].[Remark], [o].[UpdatedBy], [o].[UpdatedDate]
FROM [Users] AS [u]
INNER JOIN [SubDepartments] AS [s] ON [u].[SubDepartmentID] = [s].[ID]
INNER JOIN [Departments] AS [d] ON [s].[DepartmentID] = [d].[ID]
INNER JOIN [Occupations] AS [o] ON [u].[OccupationID] = [o].[ID]
WHERE [u].[Email] = @__signInDto_Email_0 AND [u].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:39:33.436 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (40ms) [Parameters=[@p1='?' (DbType = Guid), @p0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Users] SET [LastLogin] = @p0
OUTPUT 1
WHERE [ID] = @p1;
2026-01-03 22:39:33.513 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (9ms) [Parameters=[@__applicationName_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[ID], [a].[ApplicationName], [a].[CreatedBy], [a].[CreatedDate], [a].[Description], [a].[IsDeleted], [a].[Rating], [a].[Remark], [a].[UpdatedBy], [a].[UpdatedDate]
FROM [Applications] AS [a]
WHERE [a].[ApplicationName] = @__applicationName_0 AND [a].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:39:33.659 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (32ms) [Parameters=[@__user_ID_0='?' (DbType = Guid), @__newsPortalApp_ID_1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[ID], [u].[AccessLevelID], [u].[ApplicationID], [u].[CreatedBy], [u].[CreatedDate], [u].[GrantedBy], [u].[GrantedDate], [u].[IsDeleted], [u].[IsRevoked], [u].[Remark], [u].[RevokedDate], [u].[UpdatedBy], [u].[UpdatedDate], [u].[UserID], [a].[ID], [a].[CreatedBy], [a].[CreatedDate], [a].[Description], [a].[IsDeleted], [a].[LevelName], [a].[UpdatedBy], [a].[UpdatedDate]
FROM [UserApplicationAccesses] AS [u]
INNER JOIN [AccessLevels] AS [a] ON [u].[AccessLevelID] = [a].[ID]
WHERE [u].[UserID] = @__user_ID_0 AND [u].[ApplicationID] = @__newsPortalApp_ID_1 AND [u].[IsDeleted] = CAST(0 AS bit) AND [u].[IsRevoked] = CAST(0 AS bit)
2026-01-03 22:39:34.677 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (15ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ID], [a].[ApplicationName], [a].[Description], [a].[Remark], [a].[Rating], [a].[CreatedDate], [a].[UpdatedDate], CASE
    WHEN [u].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u].[FirstName], [u].[LastName], CASE
    WHEN [u0].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u0].[FirstName], [u0].[LastName]
FROM [Applications] AS [a]
LEFT JOIN [Users] AS [u] ON [a].[CreatedBy] = [u].[ID]
LEFT JOIN [Users] AS [u0] ON [a].[UpdatedBy] = [u0].[ID]
WHERE [a].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:39:35.933 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ID], [a].[ApplicationName], [a].[Description], [a].[Remark], [a].[Rating], [a].[CreatedDate], [a].[UpdatedDate], CASE
    WHEN [u].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u].[FirstName], [u].[LastName], CASE
    WHEN [u0].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u0].[FirstName], [u0].[LastName]
FROM [Applications] AS [a]
LEFT JOIN [Users] AS [u] ON [a].[CreatedBy] = [u].[ID]
LEFT JOIN [Users] AS [u0] ON [a].[UpdatedBy] = [u0].[ID]
WHERE [a].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:39:36.222 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (48ms) [Parameters=[@__employeeId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[ID], [u].[UserID], [u].[ApplicationID], [u].[AccessLevelID], [u].[GrantedDate], [u].[IsRevoked], [u].[RevokedDate], [u].[GrantedBy], [u].[Remark], [u].[CreatedDate], [u].[UpdatedDate], [u0].[FirstName], [u0].[LastName], [u0].[StaffCardID], [a].[ApplicationName], CASE
    WHEN [u1].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u1].[FirstName], [u1].[LastName], CASE
    WHEN [u2].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u2].[FirstName], [u2].[LastName], CASE
    WHEN [u3].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u3].[FirstName], [u3].[LastName]
FROM [UserApplicationAccesses] AS [u]
INNER JOIN [Users] AS [u0] ON [u].[UserID] = [u0].[ID]
INNER JOIN [Applications] AS [a] ON [u].[ApplicationID] = [a].[ID]
LEFT JOIN [Users] AS [u1] ON [u].[GrantedBy] = [u1].[ID]
LEFT JOIN [Users] AS [u2] ON [u].[CreatedBy] = [u2].[ID]
LEFT JOIN [Users] AS [u3] ON [u].[UpdatedBy] = [u3].[ID]
WHERE [u].[UserID] = @__employeeId_0 AND [u].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:39:36.870 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (71ms) [Parameters=[@__employeeId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[ID], [u].[UserID], [u].[ApplicationID], [u].[AccessLevelID], [u].[GrantedDate], [u].[IsRevoked], [u].[RevokedDate], [u].[GrantedBy], [u].[Remark], [u].[CreatedDate], [u].[UpdatedDate], [u0].[FirstName], [u0].[LastName], [u0].[StaffCardID], [a].[ApplicationName], CASE
    WHEN [u1].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u1].[FirstName], [u1].[LastName], CASE
    WHEN [u2].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u2].[FirstName], [u2].[LastName], CASE
    WHEN [u3].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u3].[FirstName], [u3].[LastName]
FROM [UserApplicationAccesses] AS [u]
INNER JOIN [Users] AS [u0] ON [u].[UserID] = [u0].[ID]
INNER JOIN [Applications] AS [a] ON [u].[ApplicationID] = [a].[ID]
LEFT JOIN [Users] AS [u1] ON [u].[GrantedBy] = [u1].[ID]
LEFT JOIN [Users] AS [u2] ON [u].[CreatedBy] = [u2].[ID]
LEFT JOIN [Users] AS [u3] ON [u].[UpdatedBy] = [u3].[ID]
WHERE [u].[UserID] = @__employeeId_0 AND [u].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:39:38.538 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (15ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[ID], [r].[Name], [r].[IsDeleted], [r].[CreatedDate], [r].[UpdatedDate], [r].[CreatedBy], [r].[UpdatedBy], CASE
    WHEN [u].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u].[FirstName], [u].[LastName], CASE
    WHEN [u0].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u0].[FirstName], [u0].[LastName]
FROM [ReportFormTypes] AS [r]
LEFT JOIN [Users] AS [u] ON [r].[CreatedBy] = [u].[ID]
LEFT JOIN [Users] AS [u0] ON [r].[UpdatedBy] = [u0].[ID]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:39:38.569 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[ID], [r].[Name], [r].[IsDeleted], [r].[CreatedDate], [r].[UpdatedDate], [r].[CreatedBy], [r].[UpdatedBy], CASE
    WHEN [u].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u].[FirstName], [u].[LastName], CASE
    WHEN [u0].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u0].[FirstName], [u0].[LastName]
FROM [ReportFormTypes] AS [r]
LEFT JOIN [Users] AS [u] ON [r].[CreatedBy] = [u].[ID]
LEFT JOIN [Users] AS [u0] ON [r].[UpdatedBy] = [u0].[ID]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:39:38.619 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [ReportForms] AS [r]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:39:38.831 [ERR] Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware - An unhandled exception has occurred while executing the request.
System.InvalidOperationException: The LINQ expression 'DbSet<ReportForm>()
    .Where(rf => !(rf.IsDeleted))
    .Include(rf => rf.ReportFormType)
    .GroupJoin(
        inner: DbSet<PMReportFormRTU>()
            .Where(pm => !(pm.IsDeleted))
            .Include(pm => pm.FormStatusWarehouse), 
        outerKeySelector: rf => rf.ID, 
        innerKeySelector: pm => pm.ReportFormID, 
        resultSelector: (rf, pm) => new { 
            rf = rf, 
            PMRTUStatus = pm
                .AsQueryable()
                .FirstOrDefault()
         })' could not be translated. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.Expand(Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryTranslationPreprocessor.Process(Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at ControlTower.Controllers.ReportManagementSystem.ReportFormController.GetDashboardStatistics(Nullable`1 startDate, Nullable`1 endDate, Nullable`1 reportFormTypeId, String formStatus) in C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower\ControlTower\Controllers\ReportManagementSystem\ReportFormController.cs:line 1155
   at lambda_method1809(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2026-01-03 22:39:38.976 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [ReportForms] AS [r]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:39:39.029 [ERR] Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware - An unhandled exception has occurred while executing the request.
System.InvalidOperationException: The LINQ expression 'DbSet<ReportForm>()
    .Where(rf => !(rf.IsDeleted))
    .Include(rf => rf.ReportFormType)
    .GroupJoin(
        inner: DbSet<PMReportFormRTU>()
            .Where(pm => !(pm.IsDeleted))
            .Include(pm => pm.FormStatusWarehouse), 
        outerKeySelector: rf => rf.ID, 
        innerKeySelector: pm => pm.ReportFormID, 
        resultSelector: (rf, pm) => new { 
            rf = rf, 
            PMRTUStatus = pm
                .AsQueryable()
                .FirstOrDefault()
         })' could not be translated. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.Expand(Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryTranslationPreprocessor.Process(Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at ControlTower.Controllers.ReportManagementSystem.ReportFormController.GetDashboardStatistics(Nullable`1 startDate, Nullable`1 endDate, Nullable`1 reportFormTypeId, String formStatus) in C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower\ControlTower\Controllers\ReportManagementSystem\ReportFormController.cs:line 1155
   at lambda_method1809(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2026-01-03 22:39:49.615 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [ReportForms] AS [r]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:39:49.703 [ERR] Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware - An unhandled exception has occurred while executing the request.
System.InvalidOperationException: The LINQ expression 'DbSet<ReportForm>()
    .Where(rf => !(rf.IsDeleted))
    .Include(rf => rf.ReportFormType)
    .GroupJoin(
        inner: DbSet<PMReportFormRTU>()
            .Where(pm => !(pm.IsDeleted))
            .Include(pm => pm.FormStatusWarehouse), 
        outerKeySelector: rf => rf.ID, 
        innerKeySelector: pm => pm.ReportFormID, 
        resultSelector: (rf, pm) => new { 
            rf = rf, 
            PMRTUStatus = pm
                .AsQueryable()
                .FirstOrDefault()
         })' could not be translated. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.Expand(Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryTranslationPreprocessor.Process(Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at ControlTower.Controllers.ReportManagementSystem.ReportFormController.GetDashboardStatistics(Nullable`1 startDate, Nullable`1 endDate, Nullable`1 reportFormTypeId, String formStatus) in C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower\ControlTower\Controllers\ReportManagementSystem\ReportFormController.cs:line 1155
   at lambda_method1809(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2026-01-03 22:39:59.592 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[ID], [r].[Name], [r].[IsDeleted], [r].[CreatedDate], [r].[UpdatedDate], [r].[CreatedBy], [r].[UpdatedBy], CASE
    WHEN [u].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u].[FirstName], [u].[LastName], CASE
    WHEN [u0].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u0].[FirstName], [u0].[LastName]
FROM [ReportFormTypes] AS [r]
LEFT JOIN [Users] AS [u] ON [r].[CreatedBy] = [u].[ID]
LEFT JOIN [Users] AS [u0] ON [r].[UpdatedBy] = [u0].[ID]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:39:59.723 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[ID], [r].[Name], [r].[IsDeleted], [r].[CreatedDate], [r].[UpdatedDate], [r].[CreatedBy], [r].[UpdatedBy], CASE
    WHEN [u].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u].[FirstName], [u].[LastName], CASE
    WHEN [u0].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u0].[FirstName], [u0].[LastName]
FROM [ReportFormTypes] AS [r]
LEFT JOIN [Users] AS [u] ON [r].[CreatedBy] = [u].[ID]
LEFT JOIN [Users] AS [u0] ON [r].[UpdatedBy] = [u0].[ID]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:39:59.770 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (26ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [ReportForms] AS [r]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:40:00.278 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (282ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [r1].[ID], [r1].[ReportFormTypeID], [r0].[Name], [r1].[JobNo], [r1].[SystemNameWarehouseID], [s].[Name], [r1].[StationNameWarehouseID], [s0].[Name], (
    SELECT TOP(1) [c].[Customer]
    FROM [CMReportForms] AS [c]
    WHERE [c].[ReportFormID] = [r1].[ID] AND [c].[IsDeleted] = CAST(0 AS bit)), (
    SELECT TOP(1) [c0].[ProjectNo]
    FROM [CMReportForms] AS [c0]
    WHERE [c0].[ReportFormID] = [r1].[ID] AND [c0].[IsDeleted] = CAST(0 AS bit)), [r1].[IsDeleted], [r1].[CreatedDate], [r1].[UpdatedDate], [r1].[CreatedBy], [u].[FirstName] + N' ' + [u].[LastName], [r1].[UpdatedBy], CASE
    WHEN [u0].[ID] IS NOT NULL THEN COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'')
END, [r1].[UploadStatus], [r1].[UploadHostname], [r1].[UploadIPAddress], [r1].[FormStatus], [s2].[PMReportFormTypeID], [s2].[TypeName], [s2].[Customer], [s2].[ProjectNo], [s2].[FormStatusName], [s2].[c], [s4].[PMReportFormTypeID], [s4].[TypeName], [s4].[Customer], [s4].[ProjectNo], [s4].[FormStatusName], [s4].[c], [s6].[CMReportFormTypeID], [s6].[TypeName], [s6].[FormStatusName], [s6].[c]
FROM (
    SELECT [r].[ID], [r].[CreatedBy], [r].[CreatedDate], [r].[FormStatus], [r].[IsDeleted], [r].[JobNo], [r].[ReportFormTypeID], [r].[StationNameWarehouseID], [r].[SystemNameWarehouseID], [r].[UpdatedBy], [r].[UpdatedDate], [r].[UploadHostname], [r].[UploadIPAddress], [r].[UploadStatus]
    FROM [ReportForms] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [r].[CreatedDate] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [r1]
INNER JOIN [ReportFormTypes] AS [r0] ON [r1].[ReportFormTypeID] = [r0].[ID]
INNER JOIN [SystemNameWarehouses] AS [s] ON [r1].[SystemNameWarehouseID] = [s].[ID]
INNER JOIN [StationNameWarehouses] AS [s0] ON [r1].[StationNameWarehouseID] = [s0].[ID]
INNER JOIN [Users] AS [u] ON [r1].[CreatedBy] = [u].[ID]
LEFT JOIN [Users] AS [u0] ON [r1].[UpdatedBy] = [u0].[ID]
LEFT JOIN (
    SELECT [s1].[PMReportFormTypeID], [s1].[TypeName], [s1].[Customer], [s1].[ProjectNo], [s1].[FormStatusName], [s1].[c], [s1].[ReportFormID]
    FROM (
        SELECT [p].[PMReportFormTypeID], [p0].[Name] AS [TypeName], [p].[Customer], [p].[ProjectNo], [f].[Name] AS [FormStatusName], 1 AS [c], [p].[ReportFormID], ROW_NUMBER() OVER(PARTITION BY [p].[ReportFormID] ORDER BY [p].[ID], [p0].[ID], [f].[ID]) AS [row]
        FROM [PMReportFormRTU] AS [p]
        INNER JOIN [PMReportFormTypes] AS [p0] ON [p].[PMReportFormTypeID] = [p0].[ID]
        INNER JOIN [FormStatusWarehouses] AS [f] ON [p].[FormstatusID] = [f].[ID]
        WHERE [p].[IsDeleted] = CAST(0 AS bit)
    ) AS [s1]
    WHERE [s1].[row] <= 1
) AS [s2] ON [r1].[ID] = [s2].[ReportFormID]
LEFT JOIN (
    SELECT [s3].[PMReportFormTypeID], [s3].[TypeName], [s3].[Customer], [s3].[ProjectNo], [s3].[FormStatusName], [s3].[c], [s3].[ReportFormID]
    FROM (
        SELECT [p1].[PMReportFormTypeID], [p2].[Name] AS [TypeName], [p1].[Customer], [p1].[ProjectNo], [f0].[Name] AS [FormStatusName], 1 AS [c], [p1].[ReportFormID], ROW_NUMBER() OVER(PARTITION BY [p1].[ReportFormID] ORDER BY [p1].[ID], [p2].[ID], [f0].[ID]) AS [row]
        FROM [PMReportFormServer] AS [p1]
        INNER JOIN [PMReportFormTypes] AS [p2] ON [p1].[PMReportFormTypeID] = [p2].[ID]
        INNER JOIN [FormStatusWarehouses] AS [f0] ON [p1].[FormstatusID] = [f0].[ID]
        WHERE [p1].[IsDeleted] = CAST(0 AS bit)
    ) AS [s3]
    WHERE [s3].[row] <= 1
) AS [s4] ON [r1].[ID] = [s4].[ReportFormID]
LEFT JOIN (
    SELECT [s5].[CMReportFormTypeID], [s5].[TypeName], [s5].[FormStatusName], [s5].[c], [s5].[ReportFormID]
    FROM (
        SELECT [c1].[CMReportFormTypeID], [c2].[Name] AS [TypeName], [f1].[Name] AS [FormStatusName], 1 AS [c], [c1].[ReportFormID], ROW_NUMBER() OVER(PARTITION BY [c1].[ReportFormID] ORDER BY [c1].[ID], [c2].[ID], [f1].[ID]) AS [row]
        FROM [CMReportForms] AS [c1]
        INNER JOIN [CMReportFormTypes] AS [c2] ON [c1].[CMReportFormTypeID] = [c2].[ID]
        INNER JOIN [FormStatusWarehouses] AS [f1] ON [c1].[FormstatusID] = [f1].[ID]
        WHERE [c1].[IsDeleted] = CAST(0 AS bit)
    ) AS [s5]
    WHERE [s5].[row] <= 1
) AS [s6] ON [r1].[ID] = [s6].[ReportFormID]
ORDER BY [r1].[CreatedDate] DESC
2026-01-03 22:40:00.470 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [ReportForms] AS [r]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:40:00.492 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [r1].[ID], [r1].[ReportFormTypeID], [r0].[Name], [r1].[JobNo], [r1].[SystemNameWarehouseID], [s].[Name], [r1].[StationNameWarehouseID], [s0].[Name], (
    SELECT TOP(1) [c].[Customer]
    FROM [CMReportForms] AS [c]
    WHERE [c].[ReportFormID] = [r1].[ID] AND [c].[IsDeleted] = CAST(0 AS bit)), (
    SELECT TOP(1) [c0].[ProjectNo]
    FROM [CMReportForms] AS [c0]
    WHERE [c0].[ReportFormID] = [r1].[ID] AND [c0].[IsDeleted] = CAST(0 AS bit)), [r1].[IsDeleted], [r1].[CreatedDate], [r1].[UpdatedDate], [r1].[CreatedBy], [u].[FirstName] + N' ' + [u].[LastName], [r1].[UpdatedBy], CASE
    WHEN [u0].[ID] IS NOT NULL THEN COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'')
END, [r1].[UploadStatus], [r1].[UploadHostname], [r1].[UploadIPAddress], [r1].[FormStatus], [s2].[PMReportFormTypeID], [s2].[TypeName], [s2].[Customer], [s2].[ProjectNo], [s2].[FormStatusName], [s2].[c], [s4].[PMReportFormTypeID], [s4].[TypeName], [s4].[Customer], [s4].[ProjectNo], [s4].[FormStatusName], [s4].[c], [s6].[CMReportFormTypeID], [s6].[TypeName], [s6].[FormStatusName], [s6].[c]
FROM (
    SELECT [r].[ID], [r].[CreatedBy], [r].[CreatedDate], [r].[FormStatus], [r].[IsDeleted], [r].[JobNo], [r].[ReportFormTypeID], [r].[StationNameWarehouseID], [r].[SystemNameWarehouseID], [r].[UpdatedBy], [r].[UpdatedDate], [r].[UploadHostname], [r].[UploadIPAddress], [r].[UploadStatus]
    FROM [ReportForms] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [r].[CreatedDate] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [r1]
INNER JOIN [ReportFormTypes] AS [r0] ON [r1].[ReportFormTypeID] = [r0].[ID]
INNER JOIN [SystemNameWarehouses] AS [s] ON [r1].[SystemNameWarehouseID] = [s].[ID]
INNER JOIN [StationNameWarehouses] AS [s0] ON [r1].[StationNameWarehouseID] = [s0].[ID]
INNER JOIN [Users] AS [u] ON [r1].[CreatedBy] = [u].[ID]
LEFT JOIN [Users] AS [u0] ON [r1].[UpdatedBy] = [u0].[ID]
LEFT JOIN (
    SELECT [s1].[PMReportFormTypeID], [s1].[TypeName], [s1].[Customer], [s1].[ProjectNo], [s1].[FormStatusName], [s1].[c], [s1].[ReportFormID]
    FROM (
        SELECT [p].[PMReportFormTypeID], [p0].[Name] AS [TypeName], [p].[Customer], [p].[ProjectNo], [f].[Name] AS [FormStatusName], 1 AS [c], [p].[ReportFormID], ROW_NUMBER() OVER(PARTITION BY [p].[ReportFormID] ORDER BY [p].[ID], [p0].[ID], [f].[ID]) AS [row]
        FROM [PMReportFormRTU] AS [p]
        INNER JOIN [PMReportFormTypes] AS [p0] ON [p].[PMReportFormTypeID] = [p0].[ID]
        INNER JOIN [FormStatusWarehouses] AS [f] ON [p].[FormstatusID] = [f].[ID]
        WHERE [p].[IsDeleted] = CAST(0 AS bit)
    ) AS [s1]
    WHERE [s1].[row] <= 1
) AS [s2] ON [r1].[ID] = [s2].[ReportFormID]
LEFT JOIN (
    SELECT [s3].[PMReportFormTypeID], [s3].[TypeName], [s3].[Customer], [s3].[ProjectNo], [s3].[FormStatusName], [s3].[c], [s3].[ReportFormID]
    FROM (
        SELECT [p1].[PMReportFormTypeID], [p2].[Name] AS [TypeName], [p1].[Customer], [p1].[ProjectNo], [f0].[Name] AS [FormStatusName], 1 AS [c], [p1].[ReportFormID], ROW_NUMBER() OVER(PARTITION BY [p1].[ReportFormID] ORDER BY [p1].[ID], [p2].[ID], [f0].[ID]) AS [row]
        FROM [PMReportFormServer] AS [p1]
        INNER JOIN [PMReportFormTypes] AS [p2] ON [p1].[PMReportFormTypeID] = [p2].[ID]
        INNER JOIN [FormStatusWarehouses] AS [f0] ON [p1].[FormstatusID] = [f0].[ID]
        WHERE [p1].[IsDeleted] = CAST(0 AS bit)
    ) AS [s3]
    WHERE [s3].[row] <= 1
) AS [s4] ON [r1].[ID] = [s4].[ReportFormID]
LEFT JOIN (
    SELECT [s5].[CMReportFormTypeID], [s5].[TypeName], [s5].[FormStatusName], [s5].[c], [s5].[ReportFormID]
    FROM (
        SELECT [c1].[CMReportFormTypeID], [c2].[Name] AS [TypeName], [f1].[Name] AS [FormStatusName], 1 AS [c], [c1].[ReportFormID], ROW_NUMBER() OVER(PARTITION BY [c1].[ReportFormID] ORDER BY [c1].[ID], [c2].[ID], [f1].[ID]) AS [row]
        FROM [CMReportForms] AS [c1]
        INNER JOIN [CMReportFormTypes] AS [c2] ON [c1].[CMReportFormTypeID] = [c2].[ID]
        INNER JOIN [FormStatusWarehouses] AS [f1] ON [c1].[FormstatusID] = [f1].[ID]
        WHERE [c1].[IsDeleted] = CAST(0 AS bit)
    ) AS [s5]
    WHERE [s5].[row] <= 1
) AS [s6] ON [r1].[ID] = [s6].[ReportFormID]
ORDER BY [r1].[CreatedDate] DESC
2026-01-03 22:40:03.412 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (264ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[ID], [r].[Name], [r].[IsDeleted], [r].[CreatedDate], [r].[UpdatedDate], [r].[CreatedBy], [r].[UpdatedBy], CASE
    WHEN [u].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u].[FirstName], [u].[LastName], CASE
    WHEN [u0].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u0].[FirstName], [u0].[LastName]
FROM [ReportFormTypes] AS [r]
LEFT JOIN [Users] AS [u] ON [r].[CreatedBy] = [u].[ID]
LEFT JOIN [Users] AS [u0] ON [r].[UpdatedBy] = [u0].[ID]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:40:03.412 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (24ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [ReportForms] AS [r]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:40:05.935 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (204ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[ID], [r].[Name], [r].[IsDeleted], [r].[CreatedDate], [r].[UpdatedDate], [r].[CreatedBy], [r].[UpdatedBy], CASE
    WHEN [u].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u].[FirstName], [u].[LastName], CASE
    WHEN [u0].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u0].[FirstName], [u0].[LastName]
FROM [ReportFormTypes] AS [r]
LEFT JOIN [Users] AS [u] ON [r].[CreatedBy] = [u].[ID]
LEFT JOIN [Users] AS [u0] ON [r].[UpdatedBy] = [u0].[ID]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:40:06.337 [ERR] Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware - An unhandled exception has occurred while executing the request.
System.InvalidOperationException: The LINQ expression 'DbSet<ReportForm>()
    .Where(rf => !(rf.IsDeleted))
    .Include(rf => rf.ReportFormType)
    .GroupJoin(
        inner: DbSet<PMReportFormRTU>()
            .Where(pm => !(pm.IsDeleted))
            .Include(pm => pm.FormStatusWarehouse), 
        outerKeySelector: rf => rf.ID, 
        innerKeySelector: pm => pm.ReportFormID, 
        resultSelector: (rf, pm) => new { 
            rf = rf, 
            PMRTUStatus = pm
                .AsQueryable()
                .FirstOrDefault()
         })' could not be translated. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.Expand(Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryTranslationPreprocessor.Process(Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at ControlTower.Controllers.ReportManagementSystem.ReportFormController.GetDashboardStatistics(Nullable`1 startDate, Nullable`1 endDate, Nullable`1 reportFormTypeId, String formStatus) in C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower\ControlTower\Controllers\ReportManagementSystem\ReportFormController.cs:line 1155
   at lambda_method1809(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2026-01-03 22:40:06.932 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (17ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [ReportForms] AS [r]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:40:07.119 [ERR] Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware - An unhandled exception has occurred while executing the request.
System.InvalidOperationException: The LINQ expression 'DbSet<ReportForm>()
    .Where(rf => !(rf.IsDeleted))
    .Include(rf => rf.ReportFormType)
    .GroupJoin(
        inner: DbSet<PMReportFormRTU>()
            .Where(pm => !(pm.IsDeleted))
            .Include(pm => pm.FormStatusWarehouse), 
        outerKeySelector: rf => rf.ID, 
        innerKeySelector: pm => pm.ReportFormID, 
        resultSelector: (rf, pm) => new { 
            rf = rf, 
            PMRTUStatus = pm
                .AsQueryable()
                .FirstOrDefault()
         })' could not be translated. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.Expand(Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryTranslationPreprocessor.Process(Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at ControlTower.Controllers.ReportManagementSystem.ReportFormController.GetDashboardStatistics(Nullable`1 startDate, Nullable`1 endDate, Nullable`1 reportFormTypeId, String formStatus) in C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower\ControlTower\Controllers\ReportManagementSystem\ReportFormController.cs:line 1155
   at lambda_method1809(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2026-01-03 22:41:30.217 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (51ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[ID], [r].[Name], [r].[IsDeleted], [r].[CreatedDate], [r].[UpdatedDate], [r].[CreatedBy], [r].[UpdatedBy], CASE
    WHEN [u].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u].[FirstName], [u].[LastName], CASE
    WHEN [u0].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u0].[FirstName], [u0].[LastName]
FROM [ReportFormTypes] AS [r]
LEFT JOIN [Users] AS [u] ON [r].[CreatedBy] = [u].[ID]
LEFT JOIN [Users] AS [u0] ON [r].[UpdatedBy] = [u0].[ID]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:41:30.296 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (137ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [ReportForms] AS [r]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:41:30.343 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[ID], [r].[Name], [r].[IsDeleted], [r].[CreatedDate], [r].[UpdatedDate], [r].[CreatedBy], [r].[UpdatedBy], CASE
    WHEN [u].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u].[FirstName], [u].[LastName], CASE
    WHEN [u0].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u0].[FirstName], [u0].[LastName]
FROM [ReportFormTypes] AS [r]
LEFT JOIN [Users] AS [u] ON [r].[CreatedBy] = [u].[ID]
LEFT JOIN [Users] AS [u0] ON [r].[UpdatedBy] = [u0].[ID]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:41:30.480 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (146ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [r1].[ID], [r1].[ReportFormTypeID], [r0].[Name], [r1].[JobNo], [r1].[SystemNameWarehouseID], [s].[Name], [r1].[StationNameWarehouseID], [s0].[Name], (
    SELECT TOP(1) [c].[Customer]
    FROM [CMReportForms] AS [c]
    WHERE [c].[ReportFormID] = [r1].[ID] AND [c].[IsDeleted] = CAST(0 AS bit)), (
    SELECT TOP(1) [c0].[ProjectNo]
    FROM [CMReportForms] AS [c0]
    WHERE [c0].[ReportFormID] = [r1].[ID] AND [c0].[IsDeleted] = CAST(0 AS bit)), [r1].[IsDeleted], [r1].[CreatedDate], [r1].[UpdatedDate], [r1].[CreatedBy], [u].[FirstName] + N' ' + [u].[LastName], [r1].[UpdatedBy], CASE
    WHEN [u0].[ID] IS NOT NULL THEN COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'')
END, [r1].[UploadStatus], [r1].[UploadHostname], [r1].[UploadIPAddress], [r1].[FormStatus], [s2].[PMReportFormTypeID], [s2].[TypeName], [s2].[Customer], [s2].[ProjectNo], [s2].[FormStatusName], [s2].[c], [s4].[PMReportFormTypeID], [s4].[TypeName], [s4].[Customer], [s4].[ProjectNo], [s4].[FormStatusName], [s4].[c], [s6].[CMReportFormTypeID], [s6].[TypeName], [s6].[FormStatusName], [s6].[c]
FROM (
    SELECT [r].[ID], [r].[CreatedBy], [r].[CreatedDate], [r].[FormStatus], [r].[IsDeleted], [r].[JobNo], [r].[ReportFormTypeID], [r].[StationNameWarehouseID], [r].[SystemNameWarehouseID], [r].[UpdatedBy], [r].[UpdatedDate], [r].[UploadHostname], [r].[UploadIPAddress], [r].[UploadStatus]
    FROM [ReportForms] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [r].[CreatedDate] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [r1]
INNER JOIN [ReportFormTypes] AS [r0] ON [r1].[ReportFormTypeID] = [r0].[ID]
INNER JOIN [SystemNameWarehouses] AS [s] ON [r1].[SystemNameWarehouseID] = [s].[ID]
INNER JOIN [StationNameWarehouses] AS [s0] ON [r1].[StationNameWarehouseID] = [s0].[ID]
INNER JOIN [Users] AS [u] ON [r1].[CreatedBy] = [u].[ID]
LEFT JOIN [Users] AS [u0] ON [r1].[UpdatedBy] = [u0].[ID]
LEFT JOIN (
    SELECT [s1].[PMReportFormTypeID], [s1].[TypeName], [s1].[Customer], [s1].[ProjectNo], [s1].[FormStatusName], [s1].[c], [s1].[ReportFormID]
    FROM (
        SELECT [p].[PMReportFormTypeID], [p0].[Name] AS [TypeName], [p].[Customer], [p].[ProjectNo], [f].[Name] AS [FormStatusName], 1 AS [c], [p].[ReportFormID], ROW_NUMBER() OVER(PARTITION BY [p].[ReportFormID] ORDER BY [p].[ID], [p0].[ID], [f].[ID]) AS [row]
        FROM [PMReportFormRTU] AS [p]
        INNER JOIN [PMReportFormTypes] AS [p0] ON [p].[PMReportFormTypeID] = [p0].[ID]
        INNER JOIN [FormStatusWarehouses] AS [f] ON [p].[FormstatusID] = [f].[ID]
        WHERE [p].[IsDeleted] = CAST(0 AS bit)
    ) AS [s1]
    WHERE [s1].[row] <= 1
) AS [s2] ON [r1].[ID] = [s2].[ReportFormID]
LEFT JOIN (
    SELECT [s3].[PMReportFormTypeID], [s3].[TypeName], [s3].[Customer], [s3].[ProjectNo], [s3].[FormStatusName], [s3].[c], [s3].[ReportFormID]
    FROM (
        SELECT [p1].[PMReportFormTypeID], [p2].[Name] AS [TypeName], [p1].[Customer], [p1].[ProjectNo], [f0].[Name] AS [FormStatusName], 1 AS [c], [p1].[ReportFormID], ROW_NUMBER() OVER(PARTITION BY [p1].[ReportFormID] ORDER BY [p1].[ID], [p2].[ID], [f0].[ID]) AS [row]
        FROM [PMReportFormServer] AS [p1]
        INNER JOIN [PMReportFormTypes] AS [p2] ON [p1].[PMReportFormTypeID] = [p2].[ID]
        INNER JOIN [FormStatusWarehouses] AS [f0] ON [p1].[FormstatusID] = [f0].[ID]
        WHERE [p1].[IsDeleted] = CAST(0 AS bit)
    ) AS [s3]
    WHERE [s3].[row] <= 1
) AS [s4] ON [r1].[ID] = [s4].[ReportFormID]
LEFT JOIN (
    SELECT [s5].[CMReportFormTypeID], [s5].[TypeName], [s5].[FormStatusName], [s5].[c], [s5].[ReportFormID]
    FROM (
        SELECT [c1].[CMReportFormTypeID], [c2].[Name] AS [TypeName], [f1].[Name] AS [FormStatusName], 1 AS [c], [c1].[ReportFormID], ROW_NUMBER() OVER(PARTITION BY [c1].[ReportFormID] ORDER BY [c1].[ID], [c2].[ID], [f1].[ID]) AS [row]
        FROM [CMReportForms] AS [c1]
        INNER JOIN [CMReportFormTypes] AS [c2] ON [c1].[CMReportFormTypeID] = [c2].[ID]
        INNER JOIN [FormStatusWarehouses] AS [f1] ON [c1].[FormstatusID] = [f1].[ID]
        WHERE [c1].[IsDeleted] = CAST(0 AS bit)
    ) AS [s5]
    WHERE [s5].[row] <= 1
) AS [s6] ON [r1].[ID] = [s6].[ReportFormID]
ORDER BY [r1].[CreatedDate] DESC
2026-01-03 22:41:30.519 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [ReportForms] AS [r]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:41:30.535 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [r1].[ID], [r1].[ReportFormTypeID], [r0].[Name], [r1].[JobNo], [r1].[SystemNameWarehouseID], [s].[Name], [r1].[StationNameWarehouseID], [s0].[Name], (
    SELECT TOP(1) [c].[Customer]
    FROM [CMReportForms] AS [c]
    WHERE [c].[ReportFormID] = [r1].[ID] AND [c].[IsDeleted] = CAST(0 AS bit)), (
    SELECT TOP(1) [c0].[ProjectNo]
    FROM [CMReportForms] AS [c0]
    WHERE [c0].[ReportFormID] = [r1].[ID] AND [c0].[IsDeleted] = CAST(0 AS bit)), [r1].[IsDeleted], [r1].[CreatedDate], [r1].[UpdatedDate], [r1].[CreatedBy], [u].[FirstName] + N' ' + [u].[LastName], [r1].[UpdatedBy], CASE
    WHEN [u0].[ID] IS NOT NULL THEN COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'')
END, [r1].[UploadStatus], [r1].[UploadHostname], [r1].[UploadIPAddress], [r1].[FormStatus], [s2].[PMReportFormTypeID], [s2].[TypeName], [s2].[Customer], [s2].[ProjectNo], [s2].[FormStatusName], [s2].[c], [s4].[PMReportFormTypeID], [s4].[TypeName], [s4].[Customer], [s4].[ProjectNo], [s4].[FormStatusName], [s4].[c], [s6].[CMReportFormTypeID], [s6].[TypeName], [s6].[FormStatusName], [s6].[c]
FROM (
    SELECT [r].[ID], [r].[CreatedBy], [r].[CreatedDate], [r].[FormStatus], [r].[IsDeleted], [r].[JobNo], [r].[ReportFormTypeID], [r].[StationNameWarehouseID], [r].[SystemNameWarehouseID], [r].[UpdatedBy], [r].[UpdatedDate], [r].[UploadHostname], [r].[UploadIPAddress], [r].[UploadStatus]
    FROM [ReportForms] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [r].[CreatedDate] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [r1]
INNER JOIN [ReportFormTypes] AS [r0] ON [r1].[ReportFormTypeID] = [r0].[ID]
INNER JOIN [SystemNameWarehouses] AS [s] ON [r1].[SystemNameWarehouseID] = [s].[ID]
INNER JOIN [StationNameWarehouses] AS [s0] ON [r1].[StationNameWarehouseID] = [s0].[ID]
INNER JOIN [Users] AS [u] ON [r1].[CreatedBy] = [u].[ID]
LEFT JOIN [Users] AS [u0] ON [r1].[UpdatedBy] = [u0].[ID]
LEFT JOIN (
    SELECT [s1].[PMReportFormTypeID], [s1].[TypeName], [s1].[Customer], [s1].[ProjectNo], [s1].[FormStatusName], [s1].[c], [s1].[ReportFormID]
    FROM (
        SELECT [p].[PMReportFormTypeID], [p0].[Name] AS [TypeName], [p].[Customer], [p].[ProjectNo], [f].[Name] AS [FormStatusName], 1 AS [c], [p].[ReportFormID], ROW_NUMBER() OVER(PARTITION BY [p].[ReportFormID] ORDER BY [p].[ID], [p0].[ID], [f].[ID]) AS [row]
        FROM [PMReportFormRTU] AS [p]
        INNER JOIN [PMReportFormTypes] AS [p0] ON [p].[PMReportFormTypeID] = [p0].[ID]
        INNER JOIN [FormStatusWarehouses] AS [f] ON [p].[FormstatusID] = [f].[ID]
        WHERE [p].[IsDeleted] = CAST(0 AS bit)
    ) AS [s1]
    WHERE [s1].[row] <= 1
) AS [s2] ON [r1].[ID] = [s2].[ReportFormID]
LEFT JOIN (
    SELECT [s3].[PMReportFormTypeID], [s3].[TypeName], [s3].[Customer], [s3].[ProjectNo], [s3].[FormStatusName], [s3].[c], [s3].[ReportFormID]
    FROM (
        SELECT [p1].[PMReportFormTypeID], [p2].[Name] AS [TypeName], [p1].[Customer], [p1].[ProjectNo], [f0].[Name] AS [FormStatusName], 1 AS [c], [p1].[ReportFormID], ROW_NUMBER() OVER(PARTITION BY [p1].[ReportFormID] ORDER BY [p1].[ID], [p2].[ID], [f0].[ID]) AS [row]
        FROM [PMReportFormServer] AS [p1]
        INNER JOIN [PMReportFormTypes] AS [p2] ON [p1].[PMReportFormTypeID] = [p2].[ID]
        INNER JOIN [FormStatusWarehouses] AS [f0] ON [p1].[FormstatusID] = [f0].[ID]
        WHERE [p1].[IsDeleted] = CAST(0 AS bit)
    ) AS [s3]
    WHERE [s3].[row] <= 1
) AS [s4] ON [r1].[ID] = [s4].[ReportFormID]
LEFT JOIN (
    SELECT [s5].[CMReportFormTypeID], [s5].[TypeName], [s5].[FormStatusName], [s5].[c], [s5].[ReportFormID]
    FROM (
        SELECT [c1].[CMReportFormTypeID], [c2].[Name] AS [TypeName], [f1].[Name] AS [FormStatusName], 1 AS [c], [c1].[ReportFormID], ROW_NUMBER() OVER(PARTITION BY [c1].[ReportFormID] ORDER BY [c1].[ID], [c2].[ID], [f1].[ID]) AS [row]
        FROM [CMReportForms] AS [c1]
        INNER JOIN [CMReportFormTypes] AS [c2] ON [c1].[CMReportFormTypeID] = [c2].[ID]
        INNER JOIN [FormStatusWarehouses] AS [f1] ON [c1].[FormstatusID] = [f1].[ID]
        WHERE [c1].[IsDeleted] = CAST(0 AS bit)
    ) AS [s5]
    WHERE [s5].[row] <= 1
) AS [s6] ON [r1].[ID] = [s6].[ReportFormID]
ORDER BY [r1].[CreatedDate] DESC
2026-01-03 22:41:33.330 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[ID], [r].[Name], [r].[IsDeleted], [r].[CreatedDate], [r].[UpdatedDate], [r].[CreatedBy], [r].[UpdatedBy], CASE
    WHEN [u].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u].[FirstName], [u].[LastName], CASE
    WHEN [u0].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u0].[FirstName], [u0].[LastName]
FROM [ReportFormTypes] AS [r]
LEFT JOIN [Users] AS [u] ON [r].[CreatedBy] = [u].[ID]
LEFT JOIN [Users] AS [u0] ON [r].[UpdatedBy] = [u0].[ID]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:41:41.473 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (42ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [ReportForms] AS [r]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:41:41.559 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (19ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[ID], [r].[Name], [r].[IsDeleted], [r].[CreatedDate], [r].[UpdatedDate], [r].[CreatedBy], [r].[UpdatedBy], CASE
    WHEN [u].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u].[FirstName], [u].[LastName], CASE
    WHEN [u0].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u0].[FirstName], [u0].[LastName]
FROM [ReportFormTypes] AS [r]
LEFT JOIN [Users] AS [u] ON [r].[CreatedBy] = [u].[ID]
LEFT JOIN [Users] AS [u0] ON [r].[UpdatedBy] = [u0].[ID]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:41:41.636 [ERR] Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware - An unhandled exception has occurred while executing the request.
System.InvalidOperationException: The LINQ expression 'DbSet<ReportForm>()
    .Where(rf => !(rf.IsDeleted))
    .Include(rf => rf.ReportFormType)
    .GroupJoin(
        inner: DbSet<PMReportFormRTU>()
            .Where(pm => !(pm.IsDeleted))
            .Include(pm => pm.FormStatusWarehouse), 
        outerKeySelector: rf => rf.ID, 
        innerKeySelector: pm => pm.ReportFormID, 
        resultSelector: (rf, pm) => new { 
            rf = rf, 
            PMRTUStatus = pm
                .AsQueryable()
                .FirstOrDefault()
         })' could not be translated. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.Expand(Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryTranslationPreprocessor.Process(Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at ControlTower.Controllers.ReportManagementSystem.ReportFormController.GetDashboardStatistics(Nullable`1 startDate, Nullable`1 endDate, Nullable`1 reportFormTypeId, String formStatus) in C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower\ControlTower\Controllers\ReportManagementSystem\ReportFormController.cs:line 1155
   at lambda_method1809(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2026-01-03 22:41:43.031 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (28ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [ReportForms] AS [r]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:41:43.106 [ERR] Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware - An unhandled exception has occurred while executing the request.
System.InvalidOperationException: The LINQ expression 'DbSet<ReportForm>()
    .Where(rf => !(rf.IsDeleted))
    .Include(rf => rf.ReportFormType)
    .GroupJoin(
        inner: DbSet<PMReportFormRTU>()
            .Where(pm => !(pm.IsDeleted))
            .Include(pm => pm.FormStatusWarehouse), 
        outerKeySelector: rf => rf.ID, 
        innerKeySelector: pm => pm.ReportFormID, 
        resultSelector: (rf, pm) => new { 
            rf = rf, 
            PMRTUStatus = pm
                .AsQueryable()
                .FirstOrDefault()
         })' could not be translated. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.Expand(Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryTranslationPreprocessor.Process(Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at ControlTower.Controllers.ReportManagementSystem.ReportFormController.GetDashboardStatistics(Nullable`1 startDate, Nullable`1 endDate, Nullable`1 reportFormTypeId, String formStatus) in C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower\ControlTower\Controllers\ReportManagementSystem\ReportFormController.cs:line 1155
   at lambda_method1809(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2026-01-03 22:44:47.593 [INF]  - Starting ControlTower API
2026-01-03 22:44:50.808 [INF] Microsoft.Hosting.Lifetime - Now listening on: https://localhost:7145
2026-01-03 22:44:53.026 [INF] Microsoft.Hosting.Lifetime - Application started. Press Ctrl+C to shut down.
2026-01-03 22:44:53.155 [INF] Microsoft.Hosting.Lifetime - Hosting environment: Development
2026-01-03 22:44:53.469 [INF] Microsoft.Hosting.Lifetime - Content root path: C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower\ControlTower
2026-01-03 22:45:34.359 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (417ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ID], [a].[ApplicationName], [a].[Description], [a].[Remark], [a].[Rating], [a].[CreatedDate], [a].[UpdatedDate], CASE
    WHEN [u].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u].[FirstName], [u].[LastName], CASE
    WHEN [u0].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u0].[FirstName], [u0].[LastName]
FROM [Applications] AS [a]
LEFT JOIN [Users] AS [u] ON [a].[CreatedBy] = [u].[ID]
LEFT JOIN [Users] AS [u0] ON [a].[UpdatedBy] = [u0].[ID]
WHERE [a].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:45:34.359 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (414ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ID], [a].[ApplicationName], [a].[Description], [a].[Remark], [a].[Rating], [a].[CreatedDate], [a].[UpdatedDate], CASE
    WHEN [u].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u].[FirstName], [u].[LastName], CASE
    WHEN [u0].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u0].[FirstName], [u0].[LastName]
FROM [Applications] AS [a]
LEFT JOIN [Users] AS [u] ON [a].[CreatedBy] = [u].[ID]
LEFT JOIN [Users] AS [u0] ON [a].[UpdatedBy] = [u0].[ID]
WHERE [a].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:45:38.048 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (187ms) [Parameters=[@__employeeId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[ID], [u].[UserID], [u].[ApplicationID], [u].[AccessLevelID], [u].[GrantedDate], [u].[IsRevoked], [u].[RevokedDate], [u].[GrantedBy], [u].[Remark], [u].[CreatedDate], [u].[UpdatedDate], [u0].[FirstName], [u0].[LastName], [u0].[StaffCardID], [a].[ApplicationName], CASE
    WHEN [u1].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u1].[FirstName], [u1].[LastName], CASE
    WHEN [u2].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u2].[FirstName], [u2].[LastName], CASE
    WHEN [u3].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u3].[FirstName], [u3].[LastName]
FROM [UserApplicationAccesses] AS [u]
INNER JOIN [Users] AS [u0] ON [u].[UserID] = [u0].[ID]
INNER JOIN [Applications] AS [a] ON [u].[ApplicationID] = [a].[ID]
LEFT JOIN [Users] AS [u1] ON [u].[GrantedBy] = [u1].[ID]
LEFT JOIN [Users] AS [u2] ON [u].[CreatedBy] = [u2].[ID]
LEFT JOIN [Users] AS [u3] ON [u].[UpdatedBy] = [u3].[ID]
WHERE [u].[UserID] = @__employeeId_0 AND [u].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:45:38.279 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (37ms) [Parameters=[@__employeeId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[ID], [u].[UserID], [u].[ApplicationID], [u].[AccessLevelID], [u].[GrantedDate], [u].[IsRevoked], [u].[RevokedDate], [u].[GrantedBy], [u].[Remark], [u].[CreatedDate], [u].[UpdatedDate], [u0].[FirstName], [u0].[LastName], [u0].[StaffCardID], [a].[ApplicationName], CASE
    WHEN [u1].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u1].[FirstName], [u1].[LastName], CASE
    WHEN [u2].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u2].[FirstName], [u2].[LastName], CASE
    WHEN [u3].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u3].[FirstName], [u3].[LastName]
FROM [UserApplicationAccesses] AS [u]
INNER JOIN [Users] AS [u0] ON [u].[UserID] = [u0].[ID]
INNER JOIN [Applications] AS [a] ON [u].[ApplicationID] = [a].[ID]
LEFT JOIN [Users] AS [u1] ON [u].[GrantedBy] = [u1].[ID]
LEFT JOIN [Users] AS [u2] ON [u].[CreatedBy] = [u2].[ID]
LEFT JOIN [Users] AS [u3] ON [u].[UpdatedBy] = [u3].[ID]
WHERE [u].[UserID] = @__employeeId_0 AND [u].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:45:40.423 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (77ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[ID], [r].[Name], [r].[IsDeleted], [r].[CreatedDate], [r].[UpdatedDate], [r].[CreatedBy], [r].[UpdatedBy], CASE
    WHEN [u].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u].[FirstName], [u].[LastName], CASE
    WHEN [u0].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u0].[FirstName], [u0].[LastName]
FROM [ReportFormTypes] AS [r]
LEFT JOIN [Users] AS [u] ON [r].[CreatedBy] = [u].[ID]
LEFT JOIN [Users] AS [u0] ON [r].[UpdatedBy] = [u0].[ID]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:45:40.605 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (38ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[ID], [r].[Name], [r].[IsDeleted], [r].[CreatedDate], [r].[UpdatedDate], [r].[CreatedBy], [r].[UpdatedBy], CASE
    WHEN [u].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u].[FirstName], [u].[LastName], CASE
    WHEN [u0].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u0].[FirstName], [u0].[LastName]
FROM [ReportFormTypes] AS [r]
LEFT JOIN [Users] AS [u] ON [r].[CreatedBy] = [u].[ID]
LEFT JOIN [Users] AS [u0] ON [r].[UpdatedBy] = [u0].[ID]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:45:40.730 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (24ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [ReportForms] AS [r]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:45:41.180 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (42ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[ID], [r].[CreatedBy], [r].[CreatedDate], [r].[FormStatus], [r].[IsDeleted], [r].[JobNo], [r].[ReportFormTypeID], [r].[StationNameWarehouseID], [r].[SystemNameWarehouseID], [r].[UpdatedBy], [r].[UpdatedDate], [r].[UploadHostname], [r].[UploadIPAddress], [r].[UploadStatus], [r0].[ID], [r0].[CreatedBy], [r0].[CreatedDate], [r0].[IsDeleted], [r0].[Name], [r0].[UpdatedBy], [r0].[UpdatedDate], [s].[ID], [s].[IsDeleted], [s].[Name], [s0].[ID], [s0].[IsDeleted], [s0].[Name], [s0].[SystemNameWarehouseID], [u].[ID], [u].[CompanyID], [u].[CreatedBy], [u].[CreatedDate], [u].[DateOfBirth], [u].[DepartmentID], [u].[Email], [u].[EmergencyContactName], [u].[EmergencyContactNumber], [u].[EmergencyRelationship], [u].[FirstName], [u].[Gender], [u].[IsDeleted], [u].[LastLogin], [u].[LastName], [u].[LastWorkingDate], [u].[LoginPassword], [u].[MobileNo], [u].[Nationality], [u].[OccupationID], [u].[OccupationLevelID], [u].[Rating], [u].[Religion], [u].[Remark], [u].[StaffCardID], [u].[StaffRFIDCardID], [u].[StartWorkingDate], [u].[SubDepartmentID], [u].[UpdatedBy], [u].[UpdatedDate], [u].[WorkPassCardExpiredDate], [u].[WorkPassCardIssuedDate], [u].[WorkPassCardNumber], [u].[WorkPermit]
FROM [ReportForms] AS [r]
INNER JOIN [ReportFormTypes] AS [r0] ON [r].[ReportFormTypeID] = [r0].[ID]
INNER JOIN [SystemNameWarehouses] AS [s] ON [r].[SystemNameWarehouseID] = [s].[ID]
INNER JOIN [StationNameWarehouses] AS [s0] ON [r].[StationNameWarehouseID] = [s0].[ID]
INNER JOIN [Users] AS [u] ON [r].[CreatedBy] = [u].[ID]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:45:43.301 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (40ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[ID], [p].[ApprovedBy], [p].[AttendedBy], [p].[CleaningOfCabinet], [p].[CreatedBy], [p].[CreatedDate], [p].[Customer], [p].[DateOfService], [p].[FormstatusID], [p].[IsDeleted], [p].[PMReportFormTypeID], [p].[ProjectNo], [p].[Remarks], [p].[ReportFormID], [p].[ReportTitle], [p].[UpdatedBy], [p].[UpdatedDate], [f].[ID], [f].[CreatedBy], [f].[CreatedDate], [f].[IsDeleted], [f].[Name], [f].[UpdatedBy], [f].[UpdatedDate], [p0].[ID], [p0].[CreatedBy], [p0].[CreatedDate], [p0].[IsDeleted], [p0].[Name], [p0].[UpdatedBy], [p0].[UpdatedDate]
FROM [PMReportFormRTU] AS [p]
INNER JOIN [FormStatusWarehouses] AS [f] ON [p].[FormstatusID] = [f].[ID]
INNER JOIN [PMReportFormTypes] AS [p0] ON [p].[PMReportFormTypeID] = [p0].[ID]
WHERE [p].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:45:43.508 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (55ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[ID], [p].[AttendedBy], [p].[CompletionDate], [p].[CreatedBy], [p].[CreatedDate], [p].[Customer], [p].[FormstatusID], [p].[IsDeleted], [p].[PMReportFormTypeID], [p].[ProjectNo], [p].[Remarks], [p].[ReportFormID], [p].[ReportTitle], [p].[StartDate], [p].[UpdatedBy], [p].[UpdatedDate], [p].[WitnessedBy], [f].[ID], [f].[CreatedBy], [f].[CreatedDate], [f].[IsDeleted], [f].[Name], [f].[UpdatedBy], [f].[UpdatedDate], [p0].[ID], [p0].[CreatedBy], [p0].[CreatedDate], [p0].[IsDeleted], [p0].[Name], [p0].[UpdatedBy], [p0].[UpdatedDate]
FROM [PMReportFormServer] AS [p]
INNER JOIN [FormStatusWarehouses] AS [f] ON [p].[FormstatusID] = [f].[ID]
INNER JOIN [PMReportFormTypes] AS [p0] ON [p].[PMReportFormTypeID] = [p0].[ID]
WHERE [p].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:45:44.805 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (49ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[ID], [c].[ActionTakenDescription], [c].[ApprovedBy], [c].[ArrivalDate], [c].[AttendedBy], [c].[CMReportFormTypeID], [c].[CompletionDate], [c].[CreatedBy], [c].[CreatedDate], [c].[Customer], [c].[FailureDetectedDate], [c].[FormstatusID], [c].[FurtherActionTakenID], [c].[IsDeleted], [c].[IssueFoundDescription], [c].[IssueReportedDescription], [c].[ProjectNo], [c].[Remark], [c].[ReportFormID], [c].[ReportTitle], [c].[ResponseDate], [c].[UpdatedBy], [c].[UpdatedDate], [f].[ID], [f].[CreatedBy], [f].[CreatedDate], [f].[IsDeleted], [f].[Name], [f].[UpdatedBy], [f].[UpdatedDate], [c0].[ID], [c0].[CreatedBy], [c0].[CreatedDate], [c0].[IsDeleted], [c0].[Name], [c0].[UpdatedBy], [c0].[UpdatedDate]
FROM [CMReportForms] AS [c]
INNER JOIN [FormStatusWarehouses] AS [f] ON [c].[FormstatusID] = [f].[ID]
INNER JOIN [CMReportFormTypes] AS [c0] ON [c].[CMReportFormTypeID] = [c0].[ID]
WHERE [c].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:45:45.026 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (49ms) [Parameters=[@__twelveMonthsAgo_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [r0].[Year], [r0].[Month], COUNT(*) AS [Count]
FROM (
    SELECT DATEPART(year, [r].[CreatedDate]) AS [Year], DATEPART(month, [r].[CreatedDate]) AS [Month]
    FROM [ReportForms] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[CreatedDate] >= @__twelveMonthsAgo_0
) AS [r0]
GROUP BY [r0].[Year], [r0].[Month]
ORDER BY [r0].[Year], [r0].[Month]
2026-01-03 22:45:45.127 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [ReportForms] AS [r]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:45:45.140 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[ID], [r].[CreatedBy], [r].[CreatedDate], [r].[FormStatus], [r].[IsDeleted], [r].[JobNo], [r].[ReportFormTypeID], [r].[StationNameWarehouseID], [r].[SystemNameWarehouseID], [r].[UpdatedBy], [r].[UpdatedDate], [r].[UploadHostname], [r].[UploadIPAddress], [r].[UploadStatus], [r0].[ID], [r0].[CreatedBy], [r0].[CreatedDate], [r0].[IsDeleted], [r0].[Name], [r0].[UpdatedBy], [r0].[UpdatedDate], [s].[ID], [s].[IsDeleted], [s].[Name], [s0].[ID], [s0].[IsDeleted], [s0].[Name], [s0].[SystemNameWarehouseID], [u].[ID], [u].[CompanyID], [u].[CreatedBy], [u].[CreatedDate], [u].[DateOfBirth], [u].[DepartmentID], [u].[Email], [u].[EmergencyContactName], [u].[EmergencyContactNumber], [u].[EmergencyRelationship], [u].[FirstName], [u].[Gender], [u].[IsDeleted], [u].[LastLogin], [u].[LastName], [u].[LastWorkingDate], [u].[LoginPassword], [u].[MobileNo], [u].[Nationality], [u].[OccupationID], [u].[OccupationLevelID], [u].[Rating], [u].[Religion], [u].[Remark], [u].[StaffCardID], [u].[StaffRFIDCardID], [u].[StartWorkingDate], [u].[SubDepartmentID], [u].[UpdatedBy], [u].[UpdatedDate], [u].[WorkPassCardExpiredDate], [u].[WorkPassCardIssuedDate], [u].[WorkPassCardNumber], [u].[WorkPermit]
FROM [ReportForms] AS [r]
INNER JOIN [ReportFormTypes] AS [r0] ON [r].[ReportFormTypeID] = [r0].[ID]
INNER JOIN [SystemNameWarehouses] AS [s] ON [r].[SystemNameWarehouseID] = [s].[ID]
INNER JOIN [StationNameWarehouses] AS [s0] ON [r].[StationNameWarehouseID] = [s0].[ID]
INNER JOIN [Users] AS [u] ON [r].[CreatedBy] = [u].[ID]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:45:45.156 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[ID], [p].[ApprovedBy], [p].[AttendedBy], [p].[CleaningOfCabinet], [p].[CreatedBy], [p].[CreatedDate], [p].[Customer], [p].[DateOfService], [p].[FormstatusID], [p].[IsDeleted], [p].[PMReportFormTypeID], [p].[ProjectNo], [p].[Remarks], [p].[ReportFormID], [p].[ReportTitle], [p].[UpdatedBy], [p].[UpdatedDate], [f].[ID], [f].[CreatedBy], [f].[CreatedDate], [f].[IsDeleted], [f].[Name], [f].[UpdatedBy], [f].[UpdatedDate], [p0].[ID], [p0].[CreatedBy], [p0].[CreatedDate], [p0].[IsDeleted], [p0].[Name], [p0].[UpdatedBy], [p0].[UpdatedDate]
FROM [PMReportFormRTU] AS [p]
INNER JOIN [FormStatusWarehouses] AS [f] ON [p].[FormstatusID] = [f].[ID]
INNER JOIN [PMReportFormTypes] AS [p0] ON [p].[PMReportFormTypeID] = [p0].[ID]
WHERE [p].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:45:45.172 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[ID], [p].[AttendedBy], [p].[CompletionDate], [p].[CreatedBy], [p].[CreatedDate], [p].[Customer], [p].[FormstatusID], [p].[IsDeleted], [p].[PMReportFormTypeID], [p].[ProjectNo], [p].[Remarks], [p].[ReportFormID], [p].[ReportTitle], [p].[StartDate], [p].[UpdatedBy], [p].[UpdatedDate], [p].[WitnessedBy], [f].[ID], [f].[CreatedBy], [f].[CreatedDate], [f].[IsDeleted], [f].[Name], [f].[UpdatedBy], [f].[UpdatedDate], [p0].[ID], [p0].[CreatedBy], [p0].[CreatedDate], [p0].[IsDeleted], [p0].[Name], [p0].[UpdatedBy], [p0].[UpdatedDate]
FROM [PMReportFormServer] AS [p]
INNER JOIN [FormStatusWarehouses] AS [f] ON [p].[FormstatusID] = [f].[ID]
INNER JOIN [PMReportFormTypes] AS [p0] ON [p].[PMReportFormTypeID] = [p0].[ID]
WHERE [p].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:45:45.185 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[ID], [c].[ActionTakenDescription], [c].[ApprovedBy], [c].[ArrivalDate], [c].[AttendedBy], [c].[CMReportFormTypeID], [c].[CompletionDate], [c].[CreatedBy], [c].[CreatedDate], [c].[Customer], [c].[FailureDetectedDate], [c].[FormstatusID], [c].[FurtherActionTakenID], [c].[IsDeleted], [c].[IssueFoundDescription], [c].[IssueReportedDescription], [c].[ProjectNo], [c].[Remark], [c].[ReportFormID], [c].[ReportTitle], [c].[ResponseDate], [c].[UpdatedBy], [c].[UpdatedDate], [f].[ID], [f].[CreatedBy], [f].[CreatedDate], [f].[IsDeleted], [f].[Name], [f].[UpdatedBy], [f].[UpdatedDate], [c0].[ID], [c0].[CreatedBy], [c0].[CreatedDate], [c0].[IsDeleted], [c0].[Name], [c0].[UpdatedBy], [c0].[UpdatedDate]
FROM [CMReportForms] AS [c]
INNER JOIN [FormStatusWarehouses] AS [f] ON [c].[FormstatusID] = [f].[ID]
INNER JOIN [CMReportFormTypes] AS [c0] ON [c].[CMReportFormTypeID] = [c0].[ID]
WHERE [c].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:45:45.213 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (11ms) [Parameters=[@__twelveMonthsAgo_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [r0].[Year], [r0].[Month], COUNT(*) AS [Count]
FROM (
    SELECT DATEPART(year, [r].[CreatedDate]) AS [Year], DATEPART(month, [r].[CreatedDate]) AS [Month]
    FROM [ReportForms] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[CreatedDate] >= @__twelveMonthsAgo_0
) AS [r0]
GROUP BY [r0].[Year], [r0].[Month]
ORDER BY [r0].[Year], [r0].[Month]
2026-01-03 22:46:10.220 [ERR] Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware - An unhandled exception has occurred while executing the request.
System.InvalidOperationException: The LINQ expression 'DbSet<ReportForm>()
    .Where(r => !(r.IsDeleted))
    .Where(r => r.ReportFormTypeID == __reportFormTypeId_Value_0)
    .LeftJoin(
        inner: DbSet<PMReportFormRTU>()
            .Where(p => !(p.IsDeleted)), 
        outerKeySelector: r => (object)r.ID, 
        innerKeySelector: p => (object)p.ReportFormID, 
        resultSelector: (r, p) => new TransparentIdentifier<ReportForm, PMReportFormRTU>(
            Outer = r, 
            Inner = p
        ))
    .LeftJoin(
        inner: DbSet<PMReportFormServer>()
            .Where(p0 => !(p0.IsDeleted)), 
        outerKeySelector: ti => (object)ti.Outer.ID, 
        innerKeySelector: p0 => (object)p0.ReportFormID, 
        resultSelector: (ti, p0) => new TransparentIdentifier<TransparentIdentifier<ReportForm, PMReportFormRTU>, PMReportFormServer>(
            Outer = ti, 
            Inner = p0
        ))
    .LeftJoin(
        inner: DbSet<CMReportForm>()
            .Where(c => !(c.IsDeleted)), 
        outerKeySelector: ti0 => (object)ti0.Outer.Outer.ID, 
        innerKeySelector: c => (object)c.ReportFormID, 
        resultSelector: (ti0, c) => new TransparentIdentifier<TransparentIdentifier<TransparentIdentifier<ReportForm, PMReportFormRTU>, PMReportFormServer>, CMReportForm>(
            Outer = ti0, 
            Inner = c
        ))
    .LeftJoin(
        inner: DbSet<FormStatusWarehouse>(), 
        outerKeySelector: ti1 => EF.Property<Guid?>(ti1.Outer.Outer.Inner, "FormstatusID"), 
        innerKeySelector: f => EF.Property<Guid?>(f, "ID"), 
        resultSelector: (o, i) => new TransparentIdentifier<TransparentIdentifier<TransparentIdentifier<TransparentIdentifier<ReportForm, PMReportFormRTU>, PMReportFormServer>, CMReportForm>, FormStatusWarehouse>(
            Outer = o, 
            Inner = i
        ))
    .LeftJoin(
        inner: DbSet<FormStatusWarehouse>(), 
        outerKeySelector: ti1 => EF.Property<Guid?>(ti1.Outer.Outer.Inner, "FormstatusID"), 
        innerKeySelector: f0 => EF.Property<Guid?>(f0, "ID"), 
        resultSelector: (o, i) => new TransparentIdentifier<TransparentIdentifier<TransparentIdentifier<TransparentIdentifier<TransparentIdentifier<ReportForm, PMReportFormRTU>, PMReportFormServer>, CMReportForm>, FormStatusWarehouse>, FormStatusWarehouse>(
            Outer = o, 
            Inner = i
        ))
    .LeftJoin(
        inner: DbSet<FormStatusWarehouse>(), 
        outerKeySelector: ti1 => EF.Property<Guid?>(ti1.Outer.Outer.Inner, "FormstatusID"), 
        innerKeySelector: f1 => EF.Property<Guid?>(f1, "ID"), 
        resultSelector: (o, i) => new TransparentIdentifier<TransparentIdentifier<TransparentIdentifier<TransparentIdentifier<TransparentIdentifier<TransparentIdentifier<ReportForm, PMReportFormRTU>, PMReportFormServer>, CMReportForm>, FormStatusWarehouse>, FormStatusWarehouse>, FormStatusWarehouse>(
            Outer = o, 
            Inner = i
        ))
    .Where(ti1 => ti1.Outer.Outer.Inner.Name != null && ti1.Outer.Outer.Inner.Name.Equals(
        value: __formStatus_1, 
        comparisonType: OrdinalIgnoreCase) || ti1.Outer.Inner.Name != null && ti1.Outer.Inner.Name.Equals(
        value: __formStatus_1, 
        comparisonType: OrdinalIgnoreCase) || ti1.Inner.Name != null && ti1.Inner.Name.Equals(
        value: __formStatus_1, 
        comparisonType: OrdinalIgnoreCase) || ti1.Outer.Outer.Inner.Name == null && ti1.Outer.Inner.Name == null && ti1.Inner.Name == null && ti1.Outer.Outer.Outer.Outer.Outer.Outer.FormStatus != null && ti1.Outer.Outer.Outer.Outer.Outer.Outer.FormStatus.Equals(
        value: __formStatus_1, 
        comparisonType: OrdinalIgnoreCase))' could not be translated. Additional information: Translation of the 'string.Equals' overload with a 'StringComparison' parameter is not supported. See https://go.microsoft.com/fwlink/?linkid=2129535 for more information.
Translation of the 'string.Equals' overload with a 'StringComparison' parameter is not supported. See https://go.microsoft.com/fwlink/?linkid=2129535 for more information.
Translation of the 'string.Equals' overload with a 'StringComparison' parameter is not supported. See https://go.microsoft.com/fwlink/?linkid=2129535 for more information.
Translation of the 'string.Equals' overload with a 'StringComparison' parameter is not supported. See https://go.microsoft.com/fwlink/?linkid=2129535 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ExecuteAsync[TSource,TResult](MethodInfo operatorMethodInfo, IQueryable`1 source, Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ExecuteAsync[TSource,TResult](MethodInfo operatorMethodInfo, IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.CountAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at ControlTower.Controllers.ReportManagementSystem.ReportFormController.GetDashboardStatistics(Nullable`1 startDate, Nullable`1 endDate, Nullable`1 reportFormTypeId, String formStatus) in C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower\ControlTower\Controllers\ReportManagementSystem\ReportFormController.cs:line 1152
   at lambda_method115(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2026-01-03 22:46:26.304 [ERR] Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware - An unhandled exception has occurred while executing the request.
System.InvalidOperationException: The LINQ expression 'DbSet<ReportForm>()
    .Where(r => !(r.IsDeleted))
    .Where(r => r.ReportFormTypeID == __reportFormTypeId_Value_0)
    .LeftJoin(
        inner: DbSet<PMReportFormRTU>()
            .Where(p => !(p.IsDeleted)), 
        outerKeySelector: r => (object)r.ID, 
        innerKeySelector: p => (object)p.ReportFormID, 
        resultSelector: (r, p) => new TransparentIdentifier<ReportForm, PMReportFormRTU>(
            Outer = r, 
            Inner = p
        ))
    .LeftJoin(
        inner: DbSet<PMReportFormServer>()
            .Where(p0 => !(p0.IsDeleted)), 
        outerKeySelector: ti => (object)ti.Outer.ID, 
        innerKeySelector: p0 => (object)p0.ReportFormID, 
        resultSelector: (ti, p0) => new TransparentIdentifier<TransparentIdentifier<ReportForm, PMReportFormRTU>, PMReportFormServer>(
            Outer = ti, 
            Inner = p0
        ))
    .LeftJoin(
        inner: DbSet<CMReportForm>()
            .Where(c => !(c.IsDeleted)), 
        outerKeySelector: ti0 => (object)ti0.Outer.Outer.ID, 
        innerKeySelector: c => (object)c.ReportFormID, 
        resultSelector: (ti0, c) => new TransparentIdentifier<TransparentIdentifier<TransparentIdentifier<ReportForm, PMReportFormRTU>, PMReportFormServer>, CMReportForm>(
            Outer = ti0, 
            Inner = c
        ))
    .LeftJoin(
        inner: DbSet<FormStatusWarehouse>(), 
        outerKeySelector: ti1 => EF.Property<Guid?>(ti1.Outer.Outer.Inner, "FormstatusID"), 
        innerKeySelector: f => EF.Property<Guid?>(f, "ID"), 
        resultSelector: (o, i) => new TransparentIdentifier<TransparentIdentifier<TransparentIdentifier<TransparentIdentifier<ReportForm, PMReportFormRTU>, PMReportFormServer>, CMReportForm>, FormStatusWarehouse>(
            Outer = o, 
            Inner = i
        ))
    .LeftJoin(
        inner: DbSet<FormStatusWarehouse>(), 
        outerKeySelector: ti1 => EF.Property<Guid?>(ti1.Outer.Outer.Inner, "FormstatusID"), 
        innerKeySelector: f0 => EF.Property<Guid?>(f0, "ID"), 
        resultSelector: (o, i) => new TransparentIdentifier<TransparentIdentifier<TransparentIdentifier<TransparentIdentifier<TransparentIdentifier<ReportForm, PMReportFormRTU>, PMReportFormServer>, CMReportForm>, FormStatusWarehouse>, FormStatusWarehouse>(
            Outer = o, 
            Inner = i
        ))
    .LeftJoin(
        inner: DbSet<FormStatusWarehouse>(), 
        outerKeySelector: ti1 => EF.Property<Guid?>(ti1.Outer.Outer.Inner, "FormstatusID"), 
        innerKeySelector: f1 => EF.Property<Guid?>(f1, "ID"), 
        resultSelector: (o, i) => new TransparentIdentifier<TransparentIdentifier<TransparentIdentifier<TransparentIdentifier<TransparentIdentifier<TransparentIdentifier<ReportForm, PMReportFormRTU>, PMReportFormServer>, CMReportForm>, FormStatusWarehouse>, FormStatusWarehouse>, FormStatusWarehouse>(
            Outer = o, 
            Inner = i
        ))
    .Where(ti1 => ti1.Outer.Outer.Inner.Name != null && ti1.Outer.Outer.Inner.Name.Equals(
        value: __formStatus_1, 
        comparisonType: OrdinalIgnoreCase) || ti1.Outer.Inner.Name != null && ti1.Outer.Inner.Name.Equals(
        value: __formStatus_1, 
        comparisonType: OrdinalIgnoreCase) || ti1.Inner.Name != null && ti1.Inner.Name.Equals(
        value: __formStatus_1, 
        comparisonType: OrdinalIgnoreCase) || ti1.Outer.Outer.Inner.Name == null && ti1.Outer.Inner.Name == null && ti1.Inner.Name == null && ti1.Outer.Outer.Outer.Outer.Outer.Outer.FormStatus != null && ti1.Outer.Outer.Outer.Outer.Outer.Outer.FormStatus.Equals(
        value: __formStatus_1, 
        comparisonType: OrdinalIgnoreCase))' could not be translated. Additional information: Translation of the 'string.Equals' overload with a 'StringComparison' parameter is not supported. See https://go.microsoft.com/fwlink/?linkid=2129535 for more information.
Translation of the 'string.Equals' overload with a 'StringComparison' parameter is not supported. See https://go.microsoft.com/fwlink/?linkid=2129535 for more information.
Translation of the 'string.Equals' overload with a 'StringComparison' parameter is not supported. See https://go.microsoft.com/fwlink/?linkid=2129535 for more information.
Translation of the 'string.Equals' overload with a 'StringComparison' parameter is not supported. See https://go.microsoft.com/fwlink/?linkid=2129535 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ExecuteAsync[TSource,TResult](MethodInfo operatorMethodInfo, IQueryable`1 source, Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ExecuteAsync[TSource,TResult](MethodInfo operatorMethodInfo, IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.CountAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at ControlTower.Controllers.ReportManagementSystem.ReportFormController.GetDashboardStatistics(Nullable`1 startDate, Nullable`1 endDate, Nullable`1 reportFormTypeId, String formStatus) in C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower\ControlTower\Controllers\ReportManagementSystem\ReportFormController.cs:line 1152
   at lambda_method115(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2026-01-03 22:46:32.427 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (15ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [ReportForms] AS [r]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:46:32.675 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (143ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[ID], [r].[CreatedBy], [r].[CreatedDate], [r].[FormStatus], [r].[IsDeleted], [r].[JobNo], [r].[ReportFormTypeID], [r].[StationNameWarehouseID], [r].[SystemNameWarehouseID], [r].[UpdatedBy], [r].[UpdatedDate], [r].[UploadHostname], [r].[UploadIPAddress], [r].[UploadStatus], [r0].[ID], [r0].[CreatedBy], [r0].[CreatedDate], [r0].[IsDeleted], [r0].[Name], [r0].[UpdatedBy], [r0].[UpdatedDate], [s].[ID], [s].[IsDeleted], [s].[Name], [s0].[ID], [s0].[IsDeleted], [s0].[Name], [s0].[SystemNameWarehouseID], [u].[ID], [u].[CompanyID], [u].[CreatedBy], [u].[CreatedDate], [u].[DateOfBirth], [u].[DepartmentID], [u].[Email], [u].[EmergencyContactName], [u].[EmergencyContactNumber], [u].[EmergencyRelationship], [u].[FirstName], [u].[Gender], [u].[IsDeleted], [u].[LastLogin], [u].[LastName], [u].[LastWorkingDate], [u].[LoginPassword], [u].[MobileNo], [u].[Nationality], [u].[OccupationID], [u].[OccupationLevelID], [u].[Rating], [u].[Religion], [u].[Remark], [u].[StaffCardID], [u].[StaffRFIDCardID], [u].[StartWorkingDate], [u].[SubDepartmentID], [u].[UpdatedBy], [u].[UpdatedDate], [u].[WorkPassCardExpiredDate], [u].[WorkPassCardIssuedDate], [u].[WorkPassCardNumber], [u].[WorkPermit]
FROM [ReportForms] AS [r]
INNER JOIN [ReportFormTypes] AS [r0] ON [r].[ReportFormTypeID] = [r0].[ID]
INNER JOIN [SystemNameWarehouses] AS [s] ON [r].[SystemNameWarehouseID] = [s].[ID]
INNER JOIN [StationNameWarehouses] AS [s0] ON [r].[StationNameWarehouseID] = [s0].[ID]
INNER JOIN [Users] AS [u] ON [r].[CreatedBy] = [u].[ID]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:46:33.607 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (121ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[ID], [p].[ApprovedBy], [p].[AttendedBy], [p].[CleaningOfCabinet], [p].[CreatedBy], [p].[CreatedDate], [p].[Customer], [p].[DateOfService], [p].[FormstatusID], [p].[IsDeleted], [p].[PMReportFormTypeID], [p].[ProjectNo], [p].[Remarks], [p].[ReportFormID], [p].[ReportTitle], [p].[UpdatedBy], [p].[UpdatedDate], [f].[ID], [f].[CreatedBy], [f].[CreatedDate], [f].[IsDeleted], [f].[Name], [f].[UpdatedBy], [f].[UpdatedDate], [p0].[ID], [p0].[CreatedBy], [p0].[CreatedDate], [p0].[IsDeleted], [p0].[Name], [p0].[UpdatedBy], [p0].[UpdatedDate]
FROM [PMReportFormRTU] AS [p]
INNER JOIN [FormStatusWarehouses] AS [f] ON [p].[FormstatusID] = [f].[ID]
INNER JOIN [PMReportFormTypes] AS [p0] ON [p].[PMReportFormTypeID] = [p0].[ID]
WHERE [p].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:46:34.047 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (53ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[ID], [p].[AttendedBy], [p].[CompletionDate], [p].[CreatedBy], [p].[CreatedDate], [p].[Customer], [p].[FormstatusID], [p].[IsDeleted], [p].[PMReportFormTypeID], [p].[ProjectNo], [p].[Remarks], [p].[ReportFormID], [p].[ReportTitle], [p].[StartDate], [p].[UpdatedBy], [p].[UpdatedDate], [p].[WitnessedBy], [f].[ID], [f].[CreatedBy], [f].[CreatedDate], [f].[IsDeleted], [f].[Name], [f].[UpdatedBy], [f].[UpdatedDate], [p0].[ID], [p0].[CreatedBy], [p0].[CreatedDate], [p0].[IsDeleted], [p0].[Name], [p0].[UpdatedBy], [p0].[UpdatedDate]
FROM [PMReportFormServer] AS [p]
INNER JOIN [FormStatusWarehouses] AS [f] ON [p].[FormstatusID] = [f].[ID]
INNER JOIN [PMReportFormTypes] AS [p0] ON [p].[PMReportFormTypeID] = [p0].[ID]
WHERE [p].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:46:34.169 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (28ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[ID], [c].[ActionTakenDescription], [c].[ApprovedBy], [c].[ArrivalDate], [c].[AttendedBy], [c].[CMReportFormTypeID], [c].[CompletionDate], [c].[CreatedBy], [c].[CreatedDate], [c].[Customer], [c].[FailureDetectedDate], [c].[FormstatusID], [c].[FurtherActionTakenID], [c].[IsDeleted], [c].[IssueFoundDescription], [c].[IssueReportedDescription], [c].[ProjectNo], [c].[Remark], [c].[ReportFormID], [c].[ReportTitle], [c].[ResponseDate], [c].[UpdatedBy], [c].[UpdatedDate], [f].[ID], [f].[CreatedBy], [f].[CreatedDate], [f].[IsDeleted], [f].[Name], [f].[UpdatedBy], [f].[UpdatedDate], [c0].[ID], [c0].[CreatedBy], [c0].[CreatedDate], [c0].[IsDeleted], [c0].[Name], [c0].[UpdatedBy], [c0].[UpdatedDate]
FROM [CMReportForms] AS [c]
INNER JOIN [FormStatusWarehouses] AS [f] ON [c].[FormstatusID] = [f].[ID]
INNER JOIN [CMReportFormTypes] AS [c0] ON [c].[CMReportFormTypeID] = [c0].[ID]
WHERE [c].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:46:34.403 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (10ms) [Parameters=[@__twelveMonthsAgo_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [r0].[Year], [r0].[Month], COUNT(*) AS [Count]
FROM (
    SELECT DATEPART(year, [r].[CreatedDate]) AS [Year], DATEPART(month, [r].[CreatedDate]) AS [Month]
    FROM [ReportForms] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[CreatedDate] >= @__twelveMonthsAgo_0
) AS [r0]
GROUP BY [r0].[Year], [r0].[Month]
ORDER BY [r0].[Year], [r0].[Month]
2026-01-03 22:49:56.916 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (29ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [ReportForms] AS [r]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:49:56.922 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (26ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[ID], [r].[Name], [r].[IsDeleted], [r].[CreatedDate], [r].[UpdatedDate], [r].[CreatedBy], [r].[UpdatedBy], CASE
    WHEN [u].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u].[FirstName], [u].[LastName], CASE
    WHEN [u0].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u0].[FirstName], [u0].[LastName]
FROM [ReportFormTypes] AS [r]
LEFT JOIN [Users] AS [u] ON [r].[CreatedBy] = [u].[ID]
LEFT JOIN [Users] AS [u0] ON [r].[UpdatedBy] = [u0].[ID]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:49:56.970 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (36ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[ID], [r].[CreatedBy], [r].[CreatedDate], [r].[FormStatus], [r].[IsDeleted], [r].[JobNo], [r].[ReportFormTypeID], [r].[StationNameWarehouseID], [r].[SystemNameWarehouseID], [r].[UpdatedBy], [r].[UpdatedDate], [r].[UploadHostname], [r].[UploadIPAddress], [r].[UploadStatus], [r0].[ID], [r0].[CreatedBy], [r0].[CreatedDate], [r0].[IsDeleted], [r0].[Name], [r0].[UpdatedBy], [r0].[UpdatedDate], [s].[ID], [s].[IsDeleted], [s].[Name], [s0].[ID], [s0].[IsDeleted], [s0].[Name], [s0].[SystemNameWarehouseID], [u].[ID], [u].[CompanyID], [u].[CreatedBy], [u].[CreatedDate], [u].[DateOfBirth], [u].[DepartmentID], [u].[Email], [u].[EmergencyContactName], [u].[EmergencyContactNumber], [u].[EmergencyRelationship], [u].[FirstName], [u].[Gender], [u].[IsDeleted], [u].[LastLogin], [u].[LastName], [u].[LastWorkingDate], [u].[LoginPassword], [u].[MobileNo], [u].[Nationality], [u].[OccupationID], [u].[OccupationLevelID], [u].[Rating], [u].[Religion], [u].[Remark], [u].[StaffCardID], [u].[StaffRFIDCardID], [u].[StartWorkingDate], [u].[SubDepartmentID], [u].[UpdatedBy], [u].[UpdatedDate], [u].[WorkPassCardExpiredDate], [u].[WorkPassCardIssuedDate], [u].[WorkPassCardNumber], [u].[WorkPermit]
FROM [ReportForms] AS [r]
INNER JOIN [ReportFormTypes] AS [r0] ON [r].[ReportFormTypeID] = [r0].[ID]
INNER JOIN [SystemNameWarehouses] AS [s] ON [r].[SystemNameWarehouseID] = [s].[ID]
INNER JOIN [StationNameWarehouses] AS [s0] ON [r].[StationNameWarehouseID] = [s0].[ID]
INNER JOIN [Users] AS [u] ON [r].[CreatedBy] = [u].[ID]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:49:57.051 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (47ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[ID], [p].[ApprovedBy], [p].[AttendedBy], [p].[CleaningOfCabinet], [p].[CreatedBy], [p].[CreatedDate], [p].[Customer], [p].[DateOfService], [p].[FormstatusID], [p].[IsDeleted], [p].[PMReportFormTypeID], [p].[ProjectNo], [p].[Remarks], [p].[ReportFormID], [p].[ReportTitle], [p].[UpdatedBy], [p].[UpdatedDate], [f].[ID], [f].[CreatedBy], [f].[CreatedDate], [f].[IsDeleted], [f].[Name], [f].[UpdatedBy], [f].[UpdatedDate], [p0].[ID], [p0].[CreatedBy], [p0].[CreatedDate], [p0].[IsDeleted], [p0].[Name], [p0].[UpdatedBy], [p0].[UpdatedDate]
FROM [PMReportFormRTU] AS [p]
INNER JOIN [FormStatusWarehouses] AS [f] ON [p].[FormstatusID] = [f].[ID]
INNER JOIN [PMReportFormTypes] AS [p0] ON [p].[PMReportFormTypeID] = [p0].[ID]
WHERE [p].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:49:57.086 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (20ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[ID], [p].[AttendedBy], [p].[CompletionDate], [p].[CreatedBy], [p].[CreatedDate], [p].[Customer], [p].[FormstatusID], [p].[IsDeleted], [p].[PMReportFormTypeID], [p].[ProjectNo], [p].[Remarks], [p].[ReportFormID], [p].[ReportTitle], [p].[StartDate], [p].[UpdatedBy], [p].[UpdatedDate], [p].[WitnessedBy], [f].[ID], [f].[CreatedBy], [f].[CreatedDate], [f].[IsDeleted], [f].[Name], [f].[UpdatedBy], [f].[UpdatedDate], [p0].[ID], [p0].[CreatedBy], [p0].[CreatedDate], [p0].[IsDeleted], [p0].[Name], [p0].[UpdatedBy], [p0].[UpdatedDate]
FROM [PMReportFormServer] AS [p]
INNER JOIN [FormStatusWarehouses] AS [f] ON [p].[FormstatusID] = [f].[ID]
INNER JOIN [PMReportFormTypes] AS [p0] ON [p].[PMReportFormTypeID] = [p0].[ID]
WHERE [p].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:49:57.135 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (29ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[ID], [c].[ActionTakenDescription], [c].[ApprovedBy], [c].[ArrivalDate], [c].[AttendedBy], [c].[CMReportFormTypeID], [c].[CompletionDate], [c].[CreatedBy], [c].[CreatedDate], [c].[Customer], [c].[FailureDetectedDate], [c].[FormstatusID], [c].[FurtherActionTakenID], [c].[IsDeleted], [c].[IssueFoundDescription], [c].[IssueReportedDescription], [c].[ProjectNo], [c].[Remark], [c].[ReportFormID], [c].[ReportTitle], [c].[ResponseDate], [c].[UpdatedBy], [c].[UpdatedDate], [f].[ID], [f].[CreatedBy], [f].[CreatedDate], [f].[IsDeleted], [f].[Name], [f].[UpdatedBy], [f].[UpdatedDate], [c0].[ID], [c0].[CreatedBy], [c0].[CreatedDate], [c0].[IsDeleted], [c0].[Name], [c0].[UpdatedBy], [c0].[UpdatedDate]
FROM [CMReportForms] AS [c]
INNER JOIN [FormStatusWarehouses] AS [f] ON [c].[FormstatusID] = [f].[ID]
INNER JOIN [CMReportFormTypes] AS [c0] ON [c].[CMReportFormTypeID] = [c0].[ID]
WHERE [c].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:49:57.202 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (36ms) [Parameters=[@__twelveMonthsAgo_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [r0].[Year], [r0].[Month], COUNT(*) AS [Count]
FROM (
    SELECT DATEPART(year, [r].[CreatedDate]) AS [Year], DATEPART(month, [r].[CreatedDate]) AS [Month]
    FROM [ReportForms] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[CreatedDate] >= @__twelveMonthsAgo_0
) AS [r0]
GROUP BY [r0].[Year], [r0].[Month]
ORDER BY [r0].[Year], [r0].[Month]
2026-01-03 22:51:54.547 [INF]  - Starting ControlTower API
2026-01-03 22:51:58.570 [INF] Microsoft.Hosting.Lifetime - Now listening on: https://localhost:7145
2026-01-03 22:51:59.294 [INF] Microsoft.Hosting.Lifetime - Application started. Press Ctrl+C to shut down.
2026-01-03 22:51:59.301 [INF] Microsoft.Hosting.Lifetime - Hosting environment: Development
2026-01-03 22:51:59.307 [INF] Microsoft.Hosting.Lifetime - Content root path: C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower\ControlTower
2026-01-03 22:52:33.436 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (264ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [ReportForms] AS [r]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:52:33.436 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (257ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [ReportForms] AS [r]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:52:33.436 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (262ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[ID], [r].[Name], [r].[IsDeleted], [r].[CreatedDate], [r].[UpdatedDate], [r].[CreatedBy], [r].[UpdatedBy], CASE
    WHEN [u].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u].[FirstName], [u].[LastName], CASE
    WHEN [u0].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u0].[FirstName], [u0].[LastName]
FROM [ReportFormTypes] AS [r]
LEFT JOIN [Users] AS [u] ON [r].[CreatedBy] = [u].[ID]
LEFT JOIN [Users] AS [u0] ON [r].[UpdatedBy] = [u0].[ID]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:52:33.436 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (257ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[ID], [r].[Name], [r].[IsDeleted], [r].[CreatedDate], [r].[UpdatedDate], [r].[CreatedBy], [r].[UpdatedBy], CASE
    WHEN [u].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u].[FirstName], [u].[LastName], CASE
    WHEN [u0].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u0].[FirstName], [u0].[LastName]
FROM [ReportFormTypes] AS [r]
LEFT JOIN [Users] AS [u] ON [r].[CreatedBy] = [u].[ID]
LEFT JOIN [Users] AS [u0] ON [r].[UpdatedBy] = [u0].[ID]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:52:36.206 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (124ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[ID], [r].[CreatedBy], [r].[CreatedDate], [r].[FormStatus], [r].[IsDeleted], [r].[JobNo], [r].[ReportFormTypeID], [r].[StationNameWarehouseID], [r].[SystemNameWarehouseID], [r].[UpdatedBy], [r].[UpdatedDate], [r].[UploadHostname], [r].[UploadIPAddress], [r].[UploadStatus], [r0].[ID], [r0].[CreatedBy], [r0].[CreatedDate], [r0].[IsDeleted], [r0].[Name], [r0].[UpdatedBy], [r0].[UpdatedDate], [s].[ID], [s].[IsDeleted], [s].[Name], [s0].[ID], [s0].[IsDeleted], [s0].[Name], [s0].[SystemNameWarehouseID], [u].[ID], [u].[CompanyID], [u].[CreatedBy], [u].[CreatedDate], [u].[DateOfBirth], [u].[DepartmentID], [u].[Email], [u].[EmergencyContactName], [u].[EmergencyContactNumber], [u].[EmergencyRelationship], [u].[FirstName], [u].[Gender], [u].[IsDeleted], [u].[LastLogin], [u].[LastName], [u].[LastWorkingDate], [u].[LoginPassword], [u].[MobileNo], [u].[Nationality], [u].[OccupationID], [u].[OccupationLevelID], [u].[Rating], [u].[Religion], [u].[Remark], [u].[StaffCardID], [u].[StaffRFIDCardID], [u].[StartWorkingDate], [u].[SubDepartmentID], [u].[UpdatedBy], [u].[UpdatedDate], [u].[WorkPassCardExpiredDate], [u].[WorkPassCardIssuedDate], [u].[WorkPassCardNumber], [u].[WorkPermit]
FROM [ReportForms] AS [r]
INNER JOIN [ReportFormTypes] AS [r0] ON [r].[ReportFormTypeID] = [r0].[ID]
INNER JOIN [SystemNameWarehouses] AS [s] ON [r].[SystemNameWarehouseID] = [s].[ID]
INNER JOIN [StationNameWarehouses] AS [s0] ON [r].[StationNameWarehouseID] = [s0].[ID]
INNER JOIN [Users] AS [u] ON [r].[CreatedBy] = [u].[ID]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:52:36.206 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (126ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[ID], [r].[CreatedBy], [r].[CreatedDate], [r].[FormStatus], [r].[IsDeleted], [r].[JobNo], [r].[ReportFormTypeID], [r].[StationNameWarehouseID], [r].[SystemNameWarehouseID], [r].[UpdatedBy], [r].[UpdatedDate], [r].[UploadHostname], [r].[UploadIPAddress], [r].[UploadStatus], [r0].[ID], [r0].[CreatedBy], [r0].[CreatedDate], [r0].[IsDeleted], [r0].[Name], [r0].[UpdatedBy], [r0].[UpdatedDate], [s].[ID], [s].[IsDeleted], [s].[Name], [s0].[ID], [s0].[IsDeleted], [s0].[Name], [s0].[SystemNameWarehouseID], [u].[ID], [u].[CompanyID], [u].[CreatedBy], [u].[CreatedDate], [u].[DateOfBirth], [u].[DepartmentID], [u].[Email], [u].[EmergencyContactName], [u].[EmergencyContactNumber], [u].[EmergencyRelationship], [u].[FirstName], [u].[Gender], [u].[IsDeleted], [u].[LastLogin], [u].[LastName], [u].[LastWorkingDate], [u].[LoginPassword], [u].[MobileNo], [u].[Nationality], [u].[OccupationID], [u].[OccupationLevelID], [u].[Rating], [u].[Religion], [u].[Remark], [u].[StaffCardID], [u].[StaffRFIDCardID], [u].[StartWorkingDate], [u].[SubDepartmentID], [u].[UpdatedBy], [u].[UpdatedDate], [u].[WorkPassCardExpiredDate], [u].[WorkPassCardIssuedDate], [u].[WorkPassCardNumber], [u].[WorkPermit]
FROM [ReportForms] AS [r]
INNER JOIN [ReportFormTypes] AS [r0] ON [r].[ReportFormTypeID] = [r0].[ID]
INNER JOIN [SystemNameWarehouses] AS [s] ON [r].[SystemNameWarehouseID] = [s].[ID]
INNER JOIN [StationNameWarehouses] AS [s0] ON [r].[StationNameWarehouseID] = [s0].[ID]
INNER JOIN [Users] AS [u] ON [r].[CreatedBy] = [u].[ID]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:52:47.555 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (332ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[ID], [p].[ApprovedBy], [p].[AttendedBy], [p].[CleaningOfCabinet], [p].[CreatedBy], [p].[CreatedDate], [p].[Customer], [p].[DateOfService], [p].[FormstatusID], [p].[IsDeleted], [p].[PMReportFormTypeID], [p].[ProjectNo], [p].[Remarks], [p].[ReportFormID], [p].[ReportTitle], [p].[UpdatedBy], [p].[UpdatedDate], [f].[ID], [f].[CreatedBy], [f].[CreatedDate], [f].[IsDeleted], [f].[Name], [f].[UpdatedBy], [f].[UpdatedDate], [p0].[ID], [p0].[CreatedBy], [p0].[CreatedDate], [p0].[IsDeleted], [p0].[Name], [p0].[UpdatedBy], [p0].[UpdatedDate]
FROM [PMReportFormRTU] AS [p]
INNER JOIN [FormStatusWarehouses] AS [f] ON [p].[FormstatusID] = [f].[ID]
INNER JOIN [PMReportFormTypes] AS [p0] ON [p].[PMReportFormTypeID] = [p0].[ID]
WHERE [p].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:52:47.585 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (222ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[ID], [p].[ApprovedBy], [p].[AttendedBy], [p].[CleaningOfCabinet], [p].[CreatedBy], [p].[CreatedDate], [p].[Customer], [p].[DateOfService], [p].[FormstatusID], [p].[IsDeleted], [p].[PMReportFormTypeID], [p].[ProjectNo], [p].[Remarks], [p].[ReportFormID], [p].[ReportTitle], [p].[UpdatedBy], [p].[UpdatedDate], [f].[ID], [f].[CreatedBy], [f].[CreatedDate], [f].[IsDeleted], [f].[Name], [f].[UpdatedBy], [f].[UpdatedDate], [p0].[ID], [p0].[CreatedBy], [p0].[CreatedDate], [p0].[IsDeleted], [p0].[Name], [p0].[UpdatedBy], [p0].[UpdatedDate]
FROM [PMReportFormRTU] AS [p]
INNER JOIN [FormStatusWarehouses] AS [f] ON [p].[FormstatusID] = [f].[ID]
INNER JOIN [PMReportFormTypes] AS [p0] ON [p].[PMReportFormTypeID] = [p0].[ID]
WHERE [p].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:52:51.238 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (69ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[ID], [p].[AttendedBy], [p].[CompletionDate], [p].[CreatedBy], [p].[CreatedDate], [p].[Customer], [p].[FormstatusID], [p].[IsDeleted], [p].[PMReportFormTypeID], [p].[ProjectNo], [p].[Remarks], [p].[ReportFormID], [p].[ReportTitle], [p].[StartDate], [p].[UpdatedBy], [p].[UpdatedDate], [p].[WitnessedBy], [f].[ID], [f].[CreatedBy], [f].[CreatedDate], [f].[IsDeleted], [f].[Name], [f].[UpdatedBy], [f].[UpdatedDate], [p0].[ID], [p0].[CreatedBy], [p0].[CreatedDate], [p0].[IsDeleted], [p0].[Name], [p0].[UpdatedBy], [p0].[UpdatedDate]
FROM [PMReportFormServer] AS [p]
INNER JOIN [FormStatusWarehouses] AS [f] ON [p].[FormstatusID] = [f].[ID]
INNER JOIN [PMReportFormTypes] AS [p0] ON [p].[PMReportFormTypeID] = [p0].[ID]
WHERE [p].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:52:51.420 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (81ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[ID], [p].[AttendedBy], [p].[CompletionDate], [p].[CreatedBy], [p].[CreatedDate], [p].[Customer], [p].[FormstatusID], [p].[IsDeleted], [p].[PMReportFormTypeID], [p].[ProjectNo], [p].[Remarks], [p].[ReportFormID], [p].[ReportTitle], [p].[StartDate], [p].[UpdatedBy], [p].[UpdatedDate], [p].[WitnessedBy], [f].[ID], [f].[CreatedBy], [f].[CreatedDate], [f].[IsDeleted], [f].[Name], [f].[UpdatedBy], [f].[UpdatedDate], [p0].[ID], [p0].[CreatedBy], [p0].[CreatedDate], [p0].[IsDeleted], [p0].[Name], [p0].[UpdatedBy], [p0].[UpdatedDate]
FROM [PMReportFormServer] AS [p]
INNER JOIN [FormStatusWarehouses] AS [f] ON [p].[FormstatusID] = [f].[ID]
INNER JOIN [PMReportFormTypes] AS [p0] ON [p].[PMReportFormTypeID] = [p0].[ID]
WHERE [p].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:52:55.567 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (90ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[ID], [c].[ActionTakenDescription], [c].[ApprovedBy], [c].[ArrivalDate], [c].[AttendedBy], [c].[CMReportFormTypeID], [c].[CompletionDate], [c].[CreatedBy], [c].[CreatedDate], [c].[Customer], [c].[FailureDetectedDate], [c].[FormstatusID], [c].[FurtherActionTakenID], [c].[IsDeleted], [c].[IssueFoundDescription], [c].[IssueReportedDescription], [c].[ProjectNo], [c].[Remark], [c].[ReportFormID], [c].[ReportTitle], [c].[ResponseDate], [c].[UpdatedBy], [c].[UpdatedDate], [f].[ID], [f].[CreatedBy], [f].[CreatedDate], [f].[IsDeleted], [f].[Name], [f].[UpdatedBy], [f].[UpdatedDate], [c0].[ID], [c0].[CreatedBy], [c0].[CreatedDate], [c0].[IsDeleted], [c0].[Name], [c0].[UpdatedBy], [c0].[UpdatedDate]
FROM [CMReportForms] AS [c]
INNER JOIN [FormStatusWarehouses] AS [f] ON [c].[FormstatusID] = [f].[ID]
INNER JOIN [CMReportFormTypes] AS [c0] ON [c].[CMReportFormTypeID] = [c0].[ID]
WHERE [c].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:52:55.597 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (31ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[ID], [c].[ActionTakenDescription], [c].[ApprovedBy], [c].[ArrivalDate], [c].[AttendedBy], [c].[CMReportFormTypeID], [c].[CompletionDate], [c].[CreatedBy], [c].[CreatedDate], [c].[Customer], [c].[FailureDetectedDate], [c].[FormstatusID], [c].[FurtherActionTakenID], [c].[IsDeleted], [c].[IssueFoundDescription], [c].[IssueReportedDescription], [c].[ProjectNo], [c].[Remark], [c].[ReportFormID], [c].[ReportTitle], [c].[ResponseDate], [c].[UpdatedBy], [c].[UpdatedDate], [f].[ID], [f].[CreatedBy], [f].[CreatedDate], [f].[IsDeleted], [f].[Name], [f].[UpdatedBy], [f].[UpdatedDate], [c0].[ID], [c0].[CreatedBy], [c0].[CreatedDate], [c0].[IsDeleted], [c0].[Name], [c0].[UpdatedBy], [c0].[UpdatedDate]
FROM [CMReportForms] AS [c]
INNER JOIN [FormStatusWarehouses] AS [f] ON [c].[FormstatusID] = [f].[ID]
INNER JOIN [CMReportFormTypes] AS [c0] ON [c].[CMReportFormTypeID] = [c0].[ID]
WHERE [c].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:52:59.907 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (843ms) [Parameters=[@__twelveMonthsAgo_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [r0].[Year], [r0].[Month], COUNT(*) AS [Count]
FROM (
    SELECT DATEPART(year, [r].[CreatedDate]) AS [Year], DATEPART(month, [r].[CreatedDate]) AS [Month]
    FROM [ReportForms] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[CreatedDate] >= @__twelveMonthsAgo_0
) AS [r0]
GROUP BY [r0].[Year], [r0].[Month]
ORDER BY [r0].[Year], [r0].[Month]
2026-01-03 22:52:59.910 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (803ms) [Parameters=[@__twelveMonthsAgo_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [r0].[Year], [r0].[Month], COUNT(*) AS [Count]
FROM (
    SELECT DATEPART(year, [r].[CreatedDate]) AS [Year], DATEPART(month, [r].[CreatedDate]) AS [Month]
    FROM [ReportForms] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[CreatedDate] >= @__twelveMonthsAgo_0
) AS [r0]
GROUP BY [r0].[Year], [r0].[Month]
ORDER BY [r0].[Year], [r0].[Month]
2026-01-03 22:53:02.474 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (895ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[ID], [r].[Name], [r].[IsDeleted], [r].[CreatedDate], [r].[UpdatedDate], [r].[CreatedBy], [r].[UpdatedBy], CASE
    WHEN [u].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u].[FirstName], [u].[LastName], CASE
    WHEN [u0].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u0].[FirstName], [u0].[LastName]
FROM [ReportFormTypes] AS [r]
LEFT JOIN [Users] AS [u] ON [r].[CreatedBy] = [u].[ID]
LEFT JOIN [Users] AS [u0] ON [r].[UpdatedBy] = [u0].[ID]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:53:04.339 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (431ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [ReportForms] AS [r]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:53:06.126 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (490ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[ID], [r].[Name], [r].[IsDeleted], [r].[CreatedDate], [r].[UpdatedDate], [r].[CreatedBy], [r].[UpdatedBy], CASE
    WHEN [u].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u].[FirstName], [u].[LastName], CASE
    WHEN [u0].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u0].[FirstName], [u0].[LastName]
FROM [ReportFormTypes] AS [r]
LEFT JOIN [Users] AS [u] ON [r].[CreatedBy] = [u].[ID]
LEFT JOIN [Users] AS [u0] ON [r].[UpdatedBy] = [u0].[ID]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:53:08.157 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (170ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [r1].[ID], [r1].[ReportFormTypeID], [r0].[Name], [r1].[JobNo], [r1].[SystemNameWarehouseID], [s].[Name], [r1].[StationNameWarehouseID], [s0].[Name], (
    SELECT TOP(1) [c].[Customer]
    FROM [CMReportForms] AS [c]
    WHERE [c].[ReportFormID] = [r1].[ID] AND [c].[IsDeleted] = CAST(0 AS bit)), (
    SELECT TOP(1) [c0].[ProjectNo]
    FROM [CMReportForms] AS [c0]
    WHERE [c0].[ReportFormID] = [r1].[ID] AND [c0].[IsDeleted] = CAST(0 AS bit)), [r1].[IsDeleted], [r1].[CreatedDate], [r1].[UpdatedDate], [r1].[CreatedBy], [u].[FirstName] + N' ' + [u].[LastName], [r1].[UpdatedBy], CASE
    WHEN [u0].[ID] IS NOT NULL THEN COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'')
END, [r1].[UploadStatus], [r1].[UploadHostname], [r1].[UploadIPAddress], [r1].[FormStatus], [s2].[PMReportFormTypeID], [s2].[TypeName], [s2].[Customer], [s2].[ProjectNo], [s2].[FormStatusName], [s2].[c], [s4].[PMReportFormTypeID], [s4].[TypeName], [s4].[Customer], [s4].[ProjectNo], [s4].[FormStatusName], [s4].[c], [s6].[CMReportFormTypeID], [s6].[TypeName], [s6].[FormStatusName], [s6].[c]
FROM (
    SELECT [r].[ID], [r].[CreatedBy], [r].[CreatedDate], [r].[FormStatus], [r].[IsDeleted], [r].[JobNo], [r].[ReportFormTypeID], [r].[StationNameWarehouseID], [r].[SystemNameWarehouseID], [r].[UpdatedBy], [r].[UpdatedDate], [r].[UploadHostname], [r].[UploadIPAddress], [r].[UploadStatus]
    FROM [ReportForms] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [r].[CreatedDate] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [r1]
INNER JOIN [ReportFormTypes] AS [r0] ON [r1].[ReportFormTypeID] = [r0].[ID]
INNER JOIN [SystemNameWarehouses] AS [s] ON [r1].[SystemNameWarehouseID] = [s].[ID]
INNER JOIN [StationNameWarehouses] AS [s0] ON [r1].[StationNameWarehouseID] = [s0].[ID]
INNER JOIN [Users] AS [u] ON [r1].[CreatedBy] = [u].[ID]
LEFT JOIN [Users] AS [u0] ON [r1].[UpdatedBy] = [u0].[ID]
LEFT JOIN (
    SELECT [s1].[PMReportFormTypeID], [s1].[TypeName], [s1].[Customer], [s1].[ProjectNo], [s1].[FormStatusName], [s1].[c], [s1].[ReportFormID]
    FROM (
        SELECT [p].[PMReportFormTypeID], [p0].[Name] AS [TypeName], [p].[Customer], [p].[ProjectNo], [f].[Name] AS [FormStatusName], 1 AS [c], [p].[ReportFormID], ROW_NUMBER() OVER(PARTITION BY [p].[ReportFormID] ORDER BY [p].[ID], [p0].[ID], [f].[ID]) AS [row]
        FROM [PMReportFormRTU] AS [p]
        INNER JOIN [PMReportFormTypes] AS [p0] ON [p].[PMReportFormTypeID] = [p0].[ID]
        INNER JOIN [FormStatusWarehouses] AS [f] ON [p].[FormstatusID] = [f].[ID]
        WHERE [p].[IsDeleted] = CAST(0 AS bit)
    ) AS [s1]
    WHERE [s1].[row] <= 1
) AS [s2] ON [r1].[ID] = [s2].[ReportFormID]
LEFT JOIN (
    SELECT [s3].[PMReportFormTypeID], [s3].[TypeName], [s3].[Customer], [s3].[ProjectNo], [s3].[FormStatusName], [s3].[c], [s3].[ReportFormID]
    FROM (
        SELECT [p1].[PMReportFormTypeID], [p2].[Name] AS [TypeName], [p1].[Customer], [p1].[ProjectNo], [f0].[Name] AS [FormStatusName], 1 AS [c], [p1].[ReportFormID], ROW_NUMBER() OVER(PARTITION BY [p1].[ReportFormID] ORDER BY [p1].[ID], [p2].[ID], [f0].[ID]) AS [row]
        FROM [PMReportFormServer] AS [p1]
        INNER JOIN [PMReportFormTypes] AS [p2] ON [p1].[PMReportFormTypeID] = [p2].[ID]
        INNER JOIN [FormStatusWarehouses] AS [f0] ON [p1].[FormstatusID] = [f0].[ID]
        WHERE [p1].[IsDeleted] = CAST(0 AS bit)
    ) AS [s3]
    WHERE [s3].[row] <= 1
) AS [s4] ON [r1].[ID] = [s4].[ReportFormID]
LEFT JOIN (
    SELECT [s5].[CMReportFormTypeID], [s5].[TypeName], [s5].[FormStatusName], [s5].[c], [s5].[ReportFormID]
    FROM (
        SELECT [c1].[CMReportFormTypeID], [c2].[Name] AS [TypeName], [f1].[Name] AS [FormStatusName], 1 AS [c], [c1].[ReportFormID], ROW_NUMBER() OVER(PARTITION BY [c1].[ReportFormID] ORDER BY [c1].[ID], [c2].[ID], [f1].[ID]) AS [row]
        FROM [CMReportForms] AS [c1]
        INNER JOIN [CMReportFormTypes] AS [c2] ON [c1].[CMReportFormTypeID] = [c2].[ID]
        INNER JOIN [FormStatusWarehouses] AS [f1] ON [c1].[FormstatusID] = [f1].[ID]
        WHERE [c1].[IsDeleted] = CAST(0 AS bit)
    ) AS [s5]
    WHERE [s5].[row] <= 1
) AS [s6] ON [r1].[ID] = [s6].[ReportFormID]
ORDER BY [r1].[CreatedDate] DESC
2026-01-03 22:53:12.189 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (421ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [ReportForms] AS [r]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:53:13.425 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (77ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [r1].[ID], [r1].[ReportFormTypeID], [r0].[Name], [r1].[JobNo], [r1].[SystemNameWarehouseID], [s].[Name], [r1].[StationNameWarehouseID], [s0].[Name], (
    SELECT TOP(1) [c].[Customer]
    FROM [CMReportForms] AS [c]
    WHERE [c].[ReportFormID] = [r1].[ID] AND [c].[IsDeleted] = CAST(0 AS bit)), (
    SELECT TOP(1) [c0].[ProjectNo]
    FROM [CMReportForms] AS [c0]
    WHERE [c0].[ReportFormID] = [r1].[ID] AND [c0].[IsDeleted] = CAST(0 AS bit)), [r1].[IsDeleted], [r1].[CreatedDate], [r1].[UpdatedDate], [r1].[CreatedBy], [u].[FirstName] + N' ' + [u].[LastName], [r1].[UpdatedBy], CASE
    WHEN [u0].[ID] IS NOT NULL THEN COALESCE([u0].[FirstName], N'') + N' ' + COALESCE([u0].[LastName], N'')
END, [r1].[UploadStatus], [r1].[UploadHostname], [r1].[UploadIPAddress], [r1].[FormStatus], [s2].[PMReportFormTypeID], [s2].[TypeName], [s2].[Customer], [s2].[ProjectNo], [s2].[FormStatusName], [s2].[c], [s4].[PMReportFormTypeID], [s4].[TypeName], [s4].[Customer], [s4].[ProjectNo], [s4].[FormStatusName], [s4].[c], [s6].[CMReportFormTypeID], [s6].[TypeName], [s6].[FormStatusName], [s6].[c]
FROM (
    SELECT [r].[ID], [r].[CreatedBy], [r].[CreatedDate], [r].[FormStatus], [r].[IsDeleted], [r].[JobNo], [r].[ReportFormTypeID], [r].[StationNameWarehouseID], [r].[SystemNameWarehouseID], [r].[UpdatedBy], [r].[UpdatedDate], [r].[UploadHostname], [r].[UploadIPAddress], [r].[UploadStatus]
    FROM [ReportForms] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [r].[CreatedDate] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [r1]
INNER JOIN [ReportFormTypes] AS [r0] ON [r1].[ReportFormTypeID] = [r0].[ID]
INNER JOIN [SystemNameWarehouses] AS [s] ON [r1].[SystemNameWarehouseID] = [s].[ID]
INNER JOIN [StationNameWarehouses] AS [s0] ON [r1].[StationNameWarehouseID] = [s0].[ID]
INNER JOIN [Users] AS [u] ON [r1].[CreatedBy] = [u].[ID]
LEFT JOIN [Users] AS [u0] ON [r1].[UpdatedBy] = [u0].[ID]
LEFT JOIN (
    SELECT [s1].[PMReportFormTypeID], [s1].[TypeName], [s1].[Customer], [s1].[ProjectNo], [s1].[FormStatusName], [s1].[c], [s1].[ReportFormID]
    FROM (
        SELECT [p].[PMReportFormTypeID], [p0].[Name] AS [TypeName], [p].[Customer], [p].[ProjectNo], [f].[Name] AS [FormStatusName], 1 AS [c], [p].[ReportFormID], ROW_NUMBER() OVER(PARTITION BY [p].[ReportFormID] ORDER BY [p].[ID], [p0].[ID], [f].[ID]) AS [row]
        FROM [PMReportFormRTU] AS [p]
        INNER JOIN [PMReportFormTypes] AS [p0] ON [p].[PMReportFormTypeID] = [p0].[ID]
        INNER JOIN [FormStatusWarehouses] AS [f] ON [p].[FormstatusID] = [f].[ID]
        WHERE [p].[IsDeleted] = CAST(0 AS bit)
    ) AS [s1]
    WHERE [s1].[row] <= 1
) AS [s2] ON [r1].[ID] = [s2].[ReportFormID]
LEFT JOIN (
    SELECT [s3].[PMReportFormTypeID], [s3].[TypeName], [s3].[Customer], [s3].[ProjectNo], [s3].[FormStatusName], [s3].[c], [s3].[ReportFormID]
    FROM (
        SELECT [p1].[PMReportFormTypeID], [p2].[Name] AS [TypeName], [p1].[Customer], [p1].[ProjectNo], [f0].[Name] AS [FormStatusName], 1 AS [c], [p1].[ReportFormID], ROW_NUMBER() OVER(PARTITION BY [p1].[ReportFormID] ORDER BY [p1].[ID], [p2].[ID], [f0].[ID]) AS [row]
        FROM [PMReportFormServer] AS [p1]
        INNER JOIN [PMReportFormTypes] AS [p2] ON [p1].[PMReportFormTypeID] = [p2].[ID]
        INNER JOIN [FormStatusWarehouses] AS [f0] ON [p1].[FormstatusID] = [f0].[ID]
        WHERE [p1].[IsDeleted] = CAST(0 AS bit)
    ) AS [s3]
    WHERE [s3].[row] <= 1
) AS [s4] ON [r1].[ID] = [s4].[ReportFormID]
LEFT JOIN (
    SELECT [s5].[CMReportFormTypeID], [s5].[TypeName], [s5].[FormStatusName], [s5].[c], [s5].[ReportFormID]
    FROM (
        SELECT [c1].[CMReportFormTypeID], [c2].[Name] AS [TypeName], [f1].[Name] AS [FormStatusName], 1 AS [c], [c1].[ReportFormID], ROW_NUMBER() OVER(PARTITION BY [c1].[ReportFormID] ORDER BY [c1].[ID], [c2].[ID], [f1].[ID]) AS [row]
        FROM [CMReportForms] AS [c1]
        INNER JOIN [CMReportFormTypes] AS [c2] ON [c1].[CMReportFormTypeID] = [c2].[ID]
        INNER JOIN [FormStatusWarehouses] AS [f1] ON [c1].[FormstatusID] = [f1].[ID]
        WHERE [c1].[IsDeleted] = CAST(0 AS bit)
    ) AS [s5]
    WHERE [s5].[row] <= 1
) AS [s6] ON [r1].[ID] = [s6].[ReportFormID]
ORDER BY [r1].[CreatedDate] DESC
2026-01-03 22:53:15.119 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (84ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [ReportForms] AS [r]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:53:15.193 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (103ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[ID], [r].[Name], [r].[IsDeleted], [r].[CreatedDate], [r].[UpdatedDate], [r].[CreatedBy], [r].[UpdatedBy], CASE
    WHEN [u].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u].[FirstName], [u].[LastName], CASE
    WHEN [u0].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u0].[FirstName], [u0].[LastName]
FROM [ReportFormTypes] AS [r]
LEFT JOIN [Users] AS [u] ON [r].[CreatedBy] = [u].[ID]
LEFT JOIN [Users] AS [u0] ON [r].[UpdatedBy] = [u0].[ID]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:53:15.319 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (16ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[ID], [r].[CreatedBy], [r].[CreatedDate], [r].[FormStatus], [r].[IsDeleted], [r].[JobNo], [r].[ReportFormTypeID], [r].[StationNameWarehouseID], [r].[SystemNameWarehouseID], [r].[UpdatedBy], [r].[UpdatedDate], [r].[UploadHostname], [r].[UploadIPAddress], [r].[UploadStatus], [r0].[ID], [r0].[CreatedBy], [r0].[CreatedDate], [r0].[IsDeleted], [r0].[Name], [r0].[UpdatedBy], [r0].[UpdatedDate], [s].[ID], [s].[IsDeleted], [s].[Name], [s0].[ID], [s0].[IsDeleted], [s0].[Name], [s0].[SystemNameWarehouseID], [u].[ID], [u].[CompanyID], [u].[CreatedBy], [u].[CreatedDate], [u].[DateOfBirth], [u].[DepartmentID], [u].[Email], [u].[EmergencyContactName], [u].[EmergencyContactNumber], [u].[EmergencyRelationship], [u].[FirstName], [u].[Gender], [u].[IsDeleted], [u].[LastLogin], [u].[LastName], [u].[LastWorkingDate], [u].[LoginPassword], [u].[MobileNo], [u].[Nationality], [u].[OccupationID], [u].[OccupationLevelID], [u].[Rating], [u].[Religion], [u].[Remark], [u].[StaffCardID], [u].[StaffRFIDCardID], [u].[StartWorkingDate], [u].[SubDepartmentID], [u].[UpdatedBy], [u].[UpdatedDate], [u].[WorkPassCardExpiredDate], [u].[WorkPassCardIssuedDate], [u].[WorkPassCardNumber], [u].[WorkPermit]
FROM [ReportForms] AS [r]
INNER JOIN [ReportFormTypes] AS [r0] ON [r].[ReportFormTypeID] = [r0].[ID]
INNER JOIN [SystemNameWarehouses] AS [s] ON [r].[SystemNameWarehouseID] = [s].[ID]
INNER JOIN [StationNameWarehouses] AS [s0] ON [r].[StationNameWarehouseID] = [s0].[ID]
INNER JOIN [Users] AS [u] ON [r].[CreatedBy] = [u].[ID]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:53:15.646 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (15ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[ID], [r].[Name], [r].[IsDeleted], [r].[CreatedDate], [r].[UpdatedDate], [r].[CreatedBy], [r].[UpdatedBy], CASE
    WHEN [u].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u].[FirstName], [u].[LastName], CASE
    WHEN [u0].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u0].[FirstName], [u0].[LastName]
FROM [ReportFormTypes] AS [r]
LEFT JOIN [Users] AS [u] ON [r].[CreatedBy] = [u].[ID]
LEFT JOIN [Users] AS [u0] ON [r].[UpdatedBy] = [u0].[ID]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:53:15.794 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (123ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[ID], [p].[ApprovedBy], [p].[AttendedBy], [p].[CleaningOfCabinet], [p].[CreatedBy], [p].[CreatedDate], [p].[Customer], [p].[DateOfService], [p].[FormstatusID], [p].[IsDeleted], [p].[PMReportFormTypeID], [p].[ProjectNo], [p].[Remarks], [p].[ReportFormID], [p].[ReportTitle], [p].[UpdatedBy], [p].[UpdatedDate], [f].[ID], [f].[CreatedBy], [f].[CreatedDate], [f].[IsDeleted], [f].[Name], [f].[UpdatedBy], [f].[UpdatedDate], [p0].[ID], [p0].[CreatedBy], [p0].[CreatedDate], [p0].[IsDeleted], [p0].[Name], [p0].[UpdatedBy], [p0].[UpdatedDate]
FROM [PMReportFormRTU] AS [p]
INNER JOIN [FormStatusWarehouses] AS [f] ON [p].[FormstatusID] = [f].[ID]
INNER JOIN [PMReportFormTypes] AS [p0] ON [p].[PMReportFormTypeID] = [p0].[ID]
WHERE [p].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:53:15.954 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[ID], [p].[AttendedBy], [p].[CompletionDate], [p].[CreatedBy], [p].[CreatedDate], [p].[Customer], [p].[FormstatusID], [p].[IsDeleted], [p].[PMReportFormTypeID], [p].[ProjectNo], [p].[Remarks], [p].[ReportFormID], [p].[ReportTitle], [p].[StartDate], [p].[UpdatedBy], [p].[UpdatedDate], [p].[WitnessedBy], [f].[ID], [f].[CreatedBy], [f].[CreatedDate], [f].[IsDeleted], [f].[Name], [f].[UpdatedBy], [f].[UpdatedDate], [p0].[ID], [p0].[CreatedBy], [p0].[CreatedDate], [p0].[IsDeleted], [p0].[Name], [p0].[UpdatedBy], [p0].[UpdatedDate]
FROM [PMReportFormServer] AS [p]
INNER JOIN [FormStatusWarehouses] AS [f] ON [p].[FormstatusID] = [f].[ID]
INNER JOIN [PMReportFormTypes] AS [p0] ON [p].[PMReportFormTypeID] = [p0].[ID]
WHERE [p].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:53:16.497 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (59ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[ID], [c].[ActionTakenDescription], [c].[ApprovedBy], [c].[ArrivalDate], [c].[AttendedBy], [c].[CMReportFormTypeID], [c].[CompletionDate], [c].[CreatedBy], [c].[CreatedDate], [c].[Customer], [c].[FailureDetectedDate], [c].[FormstatusID], [c].[FurtherActionTakenID], [c].[IsDeleted], [c].[IssueFoundDescription], [c].[IssueReportedDescription], [c].[ProjectNo], [c].[Remark], [c].[ReportFormID], [c].[ReportTitle], [c].[ResponseDate], [c].[UpdatedBy], [c].[UpdatedDate], [f].[ID], [f].[CreatedBy], [f].[CreatedDate], [f].[IsDeleted], [f].[Name], [f].[UpdatedBy], [f].[UpdatedDate], [c0].[ID], [c0].[CreatedBy], [c0].[CreatedDate], [c0].[IsDeleted], [c0].[Name], [c0].[UpdatedBy], [c0].[UpdatedDate]
FROM [CMReportForms] AS [c]
INNER JOIN [FormStatusWarehouses] AS [f] ON [c].[FormstatusID] = [f].[ID]
INNER JOIN [CMReportFormTypes] AS [c0] ON [c].[CMReportFormTypeID] = [c0].[ID]
WHERE [c].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:53:17.670 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (23ms) [Parameters=[@__twelveMonthsAgo_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [r0].[Year], [r0].[Month], COUNT(*) AS [Count]
FROM (
    SELECT DATEPART(year, [r].[CreatedDate]) AS [Year], DATEPART(month, [r].[CreatedDate]) AS [Month]
    FROM [ReportForms] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[CreatedDate] >= @__twelveMonthsAgo_0
) AS [r0]
GROUP BY [r0].[Year], [r0].[Month]
ORDER BY [r0].[Year], [r0].[Month]
2026-01-03 22:53:18.335 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (421ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [ReportForms] AS [r]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:53:18.496 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (28ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[ID], [r].[CreatedBy], [r].[CreatedDate], [r].[FormStatus], [r].[IsDeleted], [r].[JobNo], [r].[ReportFormTypeID], [r].[StationNameWarehouseID], [r].[SystemNameWarehouseID], [r].[UpdatedBy], [r].[UpdatedDate], [r].[UploadHostname], [r].[UploadIPAddress], [r].[UploadStatus], [r0].[ID], [r0].[CreatedBy], [r0].[CreatedDate], [r0].[IsDeleted], [r0].[Name], [r0].[UpdatedBy], [r0].[UpdatedDate], [s].[ID], [s].[IsDeleted], [s].[Name], [s0].[ID], [s0].[IsDeleted], [s0].[Name], [s0].[SystemNameWarehouseID], [u].[ID], [u].[CompanyID], [u].[CreatedBy], [u].[CreatedDate], [u].[DateOfBirth], [u].[DepartmentID], [u].[Email], [u].[EmergencyContactName], [u].[EmergencyContactNumber], [u].[EmergencyRelationship], [u].[FirstName], [u].[Gender], [u].[IsDeleted], [u].[LastLogin], [u].[LastName], [u].[LastWorkingDate], [u].[LoginPassword], [u].[MobileNo], [u].[Nationality], [u].[OccupationID], [u].[OccupationLevelID], [u].[Rating], [u].[Religion], [u].[Remark], [u].[StaffCardID], [u].[StaffRFIDCardID], [u].[StartWorkingDate], [u].[SubDepartmentID], [u].[UpdatedBy], [u].[UpdatedDate], [u].[WorkPassCardExpiredDate], [u].[WorkPassCardIssuedDate], [u].[WorkPassCardNumber], [u].[WorkPermit]
FROM [ReportForms] AS [r]
INNER JOIN [ReportFormTypes] AS [r0] ON [r].[ReportFormTypeID] = [r0].[ID]
INNER JOIN [SystemNameWarehouses] AS [s] ON [r].[SystemNameWarehouseID] = [s].[ID]
INNER JOIN [StationNameWarehouses] AS [s0] ON [r].[StationNameWarehouseID] = [s0].[ID]
INNER JOIN [Users] AS [u] ON [r].[CreatedBy] = [u].[ID]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:53:18.545 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[ID], [p].[ApprovedBy], [p].[AttendedBy], [p].[CleaningOfCabinet], [p].[CreatedBy], [p].[CreatedDate], [p].[Customer], [p].[DateOfService], [p].[FormstatusID], [p].[IsDeleted], [p].[PMReportFormTypeID], [p].[ProjectNo], [p].[Remarks], [p].[ReportFormID], [p].[ReportTitle], [p].[UpdatedBy], [p].[UpdatedDate], [f].[ID], [f].[CreatedBy], [f].[CreatedDate], [f].[IsDeleted], [f].[Name], [f].[UpdatedBy], [f].[UpdatedDate], [p0].[ID], [p0].[CreatedBy], [p0].[CreatedDate], [p0].[IsDeleted], [p0].[Name], [p0].[UpdatedBy], [p0].[UpdatedDate]
FROM [PMReportFormRTU] AS [p]
INNER JOIN [FormStatusWarehouses] AS [f] ON [p].[FormstatusID] = [f].[ID]
INNER JOIN [PMReportFormTypes] AS [p0] ON [p].[PMReportFormTypeID] = [p0].[ID]
WHERE [p].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:53:18.565 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[ID], [p].[AttendedBy], [p].[CompletionDate], [p].[CreatedBy], [p].[CreatedDate], [p].[Customer], [p].[FormstatusID], [p].[IsDeleted], [p].[PMReportFormTypeID], [p].[ProjectNo], [p].[Remarks], [p].[ReportFormID], [p].[ReportTitle], [p].[StartDate], [p].[UpdatedBy], [p].[UpdatedDate], [p].[WitnessedBy], [f].[ID], [f].[CreatedBy], [f].[CreatedDate], [f].[IsDeleted], [f].[Name], [f].[UpdatedBy], [f].[UpdatedDate], [p0].[ID], [p0].[CreatedBy], [p0].[CreatedDate], [p0].[IsDeleted], [p0].[Name], [p0].[UpdatedBy], [p0].[UpdatedDate]
FROM [PMReportFormServer] AS [p]
INNER JOIN [FormStatusWarehouses] AS [f] ON [p].[FormstatusID] = [f].[ID]
INNER JOIN [PMReportFormTypes] AS [p0] ON [p].[PMReportFormTypeID] = [p0].[ID]
WHERE [p].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:53:18.669 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[ID], [c].[ActionTakenDescription], [c].[ApprovedBy], [c].[ArrivalDate], [c].[AttendedBy], [c].[CMReportFormTypeID], [c].[CompletionDate], [c].[CreatedBy], [c].[CreatedDate], [c].[Customer], [c].[FailureDetectedDate], [c].[FormstatusID], [c].[FurtherActionTakenID], [c].[IsDeleted], [c].[IssueFoundDescription], [c].[IssueReportedDescription], [c].[ProjectNo], [c].[Remark], [c].[ReportFormID], [c].[ReportTitle], [c].[ResponseDate], [c].[UpdatedBy], [c].[UpdatedDate], [f].[ID], [f].[CreatedBy], [f].[CreatedDate], [f].[IsDeleted], [f].[Name], [f].[UpdatedBy], [f].[UpdatedDate], [c0].[ID], [c0].[CreatedBy], [c0].[CreatedDate], [c0].[IsDeleted], [c0].[Name], [c0].[UpdatedBy], [c0].[UpdatedDate]
FROM [CMReportForms] AS [c]
INNER JOIN [FormStatusWarehouses] AS [f] ON [c].[FormstatusID] = [f].[ID]
INNER JOIN [CMReportFormTypes] AS [c0] ON [c].[CMReportFormTypeID] = [c0].[ID]
WHERE [c].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:53:18.699 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (7ms) [Parameters=[@__twelveMonthsAgo_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [r0].[Year], [r0].[Month], COUNT(*) AS [Count]
FROM (
    SELECT DATEPART(year, [r].[CreatedDate]) AS [Year], DATEPART(month, [r].[CreatedDate]) AS [Month]
    FROM [ReportForms] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[CreatedDate] >= @__twelveMonthsAgo_0
) AS [r0]
GROUP BY [r0].[Year], [r0].[Month]
ORDER BY [r0].[Year], [r0].[Month]
2026-01-03 22:54:41.839 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (2,120ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [ReportForms] AS [r]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:54:41.839 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (1,855ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[ID], [r].[Name], [r].[IsDeleted], [r].[CreatedDate], [r].[UpdatedDate], [r].[CreatedBy], [r].[UpdatedBy], CASE
    WHEN [u].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u].[FirstName], [u].[LastName], CASE
    WHEN [u0].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u0].[FirstName], [u0].[LastName]
FROM [ReportFormTypes] AS [r]
LEFT JOIN [Users] AS [u] ON [r].[CreatedBy] = [u].[ID]
LEFT JOIN [Users] AS [u0] ON [r].[UpdatedBy] = [u0].[ID]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:54:41.922 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[ID], [r].[Name], [r].[IsDeleted], [r].[CreatedDate], [r].[UpdatedDate], [r].[CreatedBy], [r].[UpdatedBy], CASE
    WHEN [u].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u].[FirstName], [u].[LastName], CASE
    WHEN [u0].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u0].[FirstName], [u0].[LastName]
FROM [ReportFormTypes] AS [r]
LEFT JOIN [Users] AS [u] ON [r].[CreatedBy] = [u].[ID]
LEFT JOIN [Users] AS [u0] ON [r].[UpdatedBy] = [u0].[ID]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:54:41.930 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (62ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[ID], [r].[CreatedBy], [r].[CreatedDate], [r].[FormStatus], [r].[IsDeleted], [r].[JobNo], [r].[ReportFormTypeID], [r].[StationNameWarehouseID], [r].[SystemNameWarehouseID], [r].[UpdatedBy], [r].[UpdatedDate], [r].[UploadHostname], [r].[UploadIPAddress], [r].[UploadStatus], [r0].[ID], [r0].[CreatedBy], [r0].[CreatedDate], [r0].[IsDeleted], [r0].[Name], [r0].[UpdatedBy], [r0].[UpdatedDate], [s].[ID], [s].[IsDeleted], [s].[Name], [s0].[ID], [s0].[IsDeleted], [s0].[Name], [s0].[SystemNameWarehouseID], [u].[ID], [u].[CompanyID], [u].[CreatedBy], [u].[CreatedDate], [u].[DateOfBirth], [u].[DepartmentID], [u].[Email], [u].[EmergencyContactName], [u].[EmergencyContactNumber], [u].[EmergencyRelationship], [u].[FirstName], [u].[Gender], [u].[IsDeleted], [u].[LastLogin], [u].[LastName], [u].[LastWorkingDate], [u].[LoginPassword], [u].[MobileNo], [u].[Nationality], [u].[OccupationID], [u].[OccupationLevelID], [u].[Rating], [u].[Religion], [u].[Remark], [u].[StaffCardID], [u].[StaffRFIDCardID], [u].[StartWorkingDate], [u].[SubDepartmentID], [u].[UpdatedBy], [u].[UpdatedDate], [u].[WorkPassCardExpiredDate], [u].[WorkPassCardIssuedDate], [u].[WorkPassCardNumber], [u].[WorkPermit]
FROM [ReportForms] AS [r]
INNER JOIN [ReportFormTypes] AS [r0] ON [r].[ReportFormTypeID] = [r0].[ID]
INNER JOIN [SystemNameWarehouses] AS [s] ON [r].[SystemNameWarehouseID] = [s].[ID]
INNER JOIN [StationNameWarehouses] AS [s0] ON [r].[StationNameWarehouseID] = [s0].[ID]
INNER JOIN [Users] AS [u] ON [r].[CreatedBy] = [u].[ID]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:54:41.988 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (31ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[ID], [p].[ApprovedBy], [p].[AttendedBy], [p].[CleaningOfCabinet], [p].[CreatedBy], [p].[CreatedDate], [p].[Customer], [p].[DateOfService], [p].[FormstatusID], [p].[IsDeleted], [p].[PMReportFormTypeID], [p].[ProjectNo], [p].[Remarks], [p].[ReportFormID], [p].[ReportTitle], [p].[UpdatedBy], [p].[UpdatedDate], [f].[ID], [f].[CreatedBy], [f].[CreatedDate], [f].[IsDeleted], [f].[Name], [f].[UpdatedBy], [f].[UpdatedDate], [p0].[ID], [p0].[CreatedBy], [p0].[CreatedDate], [p0].[IsDeleted], [p0].[Name], [p0].[UpdatedBy], [p0].[UpdatedDate]
FROM [PMReportFormRTU] AS [p]
INNER JOIN [FormStatusWarehouses] AS [f] ON [p].[FormstatusID] = [f].[ID]
INNER JOIN [PMReportFormTypes] AS [p0] ON [p].[PMReportFormTypeID] = [p0].[ID]
WHERE [p].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:54:42.031 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (29ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[ID], [p].[AttendedBy], [p].[CompletionDate], [p].[CreatedBy], [p].[CreatedDate], [p].[Customer], [p].[FormstatusID], [p].[IsDeleted], [p].[PMReportFormTypeID], [p].[ProjectNo], [p].[Remarks], [p].[ReportFormID], [p].[ReportTitle], [p].[StartDate], [p].[UpdatedBy], [p].[UpdatedDate], [p].[WitnessedBy], [f].[ID], [f].[CreatedBy], [f].[CreatedDate], [f].[IsDeleted], [f].[Name], [f].[UpdatedBy], [f].[UpdatedDate], [p0].[ID], [p0].[CreatedBy], [p0].[CreatedDate], [p0].[IsDeleted], [p0].[Name], [p0].[UpdatedBy], [p0].[UpdatedDate]
FROM [PMReportFormServer] AS [p]
INNER JOIN [FormStatusWarehouses] AS [f] ON [p].[FormstatusID] = [f].[ID]
INNER JOIN [PMReportFormTypes] AS [p0] ON [p].[PMReportFormTypeID] = [p0].[ID]
WHERE [p].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:54:42.058 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (14ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[ID], [c].[ActionTakenDescription], [c].[ApprovedBy], [c].[ArrivalDate], [c].[AttendedBy], [c].[CMReportFormTypeID], [c].[CompletionDate], [c].[CreatedBy], [c].[CreatedDate], [c].[Customer], [c].[FailureDetectedDate], [c].[FormstatusID], [c].[FurtherActionTakenID], [c].[IsDeleted], [c].[IssueFoundDescription], [c].[IssueReportedDescription], [c].[ProjectNo], [c].[Remark], [c].[ReportFormID], [c].[ReportTitle], [c].[ResponseDate], [c].[UpdatedBy], [c].[UpdatedDate], [f].[ID], [f].[CreatedBy], [f].[CreatedDate], [f].[IsDeleted], [f].[Name], [f].[UpdatedBy], [f].[UpdatedDate], [c0].[ID], [c0].[CreatedBy], [c0].[CreatedDate], [c0].[IsDeleted], [c0].[Name], [c0].[UpdatedBy], [c0].[UpdatedDate]
FROM [CMReportForms] AS [c]
INNER JOIN [FormStatusWarehouses] AS [f] ON [c].[FormstatusID] = [f].[ID]
INNER JOIN [CMReportFormTypes] AS [c0] ON [c].[CMReportFormTypeID] = [c0].[ID]
WHERE [c].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:54:42.082 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (12ms) [Parameters=[@__twelveMonthsAgo_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [r0].[Year], [r0].[Month], COUNT(*) AS [Count]
FROM (
    SELECT DATEPART(year, [r].[CreatedDate]) AS [Year], DATEPART(month, [r].[CreatedDate]) AS [Month]
    FROM [ReportForms] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[CreatedDate] >= @__twelveMonthsAgo_0
) AS [r0]
GROUP BY [r0].[Year], [r0].[Month]
ORDER BY [r0].[Year], [r0].[Month]
2026-01-03 22:54:42.109 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [ReportForms] AS [r]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:54:42.124 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[ID], [r].[CreatedBy], [r].[CreatedDate], [r].[FormStatus], [r].[IsDeleted], [r].[JobNo], [r].[ReportFormTypeID], [r].[StationNameWarehouseID], [r].[SystemNameWarehouseID], [r].[UpdatedBy], [r].[UpdatedDate], [r].[UploadHostname], [r].[UploadIPAddress], [r].[UploadStatus], [r0].[ID], [r0].[CreatedBy], [r0].[CreatedDate], [r0].[IsDeleted], [r0].[Name], [r0].[UpdatedBy], [r0].[UpdatedDate], [s].[ID], [s].[IsDeleted], [s].[Name], [s0].[ID], [s0].[IsDeleted], [s0].[Name], [s0].[SystemNameWarehouseID], [u].[ID], [u].[CompanyID], [u].[CreatedBy], [u].[CreatedDate], [u].[DateOfBirth], [u].[DepartmentID], [u].[Email], [u].[EmergencyContactName], [u].[EmergencyContactNumber], [u].[EmergencyRelationship], [u].[FirstName], [u].[Gender], [u].[IsDeleted], [u].[LastLogin], [u].[LastName], [u].[LastWorkingDate], [u].[LoginPassword], [u].[MobileNo], [u].[Nationality], [u].[OccupationID], [u].[OccupationLevelID], [u].[Rating], [u].[Religion], [u].[Remark], [u].[StaffCardID], [u].[StaffRFIDCardID], [u].[StartWorkingDate], [u].[SubDepartmentID], [u].[UpdatedBy], [u].[UpdatedDate], [u].[WorkPassCardExpiredDate], [u].[WorkPassCardIssuedDate], [u].[WorkPassCardNumber], [u].[WorkPermit]
FROM [ReportForms] AS [r]
INNER JOIN [ReportFormTypes] AS [r0] ON [r].[ReportFormTypeID] = [r0].[ID]
INNER JOIN [SystemNameWarehouses] AS [s] ON [r].[SystemNameWarehouseID] = [s].[ID]
INNER JOIN [StationNameWarehouses] AS [s0] ON [r].[StationNameWarehouseID] = [s0].[ID]
INNER JOIN [Users] AS [u] ON [r].[CreatedBy] = [u].[ID]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:54:42.140 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[ID], [p].[ApprovedBy], [p].[AttendedBy], [p].[CleaningOfCabinet], [p].[CreatedBy], [p].[CreatedDate], [p].[Customer], [p].[DateOfService], [p].[FormstatusID], [p].[IsDeleted], [p].[PMReportFormTypeID], [p].[ProjectNo], [p].[Remarks], [p].[ReportFormID], [p].[ReportTitle], [p].[UpdatedBy], [p].[UpdatedDate], [f].[ID], [f].[CreatedBy], [f].[CreatedDate], [f].[IsDeleted], [f].[Name], [f].[UpdatedBy], [f].[UpdatedDate], [p0].[ID], [p0].[CreatedBy], [p0].[CreatedDate], [p0].[IsDeleted], [p0].[Name], [p0].[UpdatedBy], [p0].[UpdatedDate]
FROM [PMReportFormRTU] AS [p]
INNER JOIN [FormStatusWarehouses] AS [f] ON [p].[FormstatusID] = [f].[ID]
INNER JOIN [PMReportFormTypes] AS [p0] ON [p].[PMReportFormTypeID] = [p0].[ID]
WHERE [p].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:54:42.156 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[ID], [p].[AttendedBy], [p].[CompletionDate], [p].[CreatedBy], [p].[CreatedDate], [p].[Customer], [p].[FormstatusID], [p].[IsDeleted], [p].[PMReportFormTypeID], [p].[ProjectNo], [p].[Remarks], [p].[ReportFormID], [p].[ReportTitle], [p].[StartDate], [p].[UpdatedBy], [p].[UpdatedDate], [p].[WitnessedBy], [f].[ID], [f].[CreatedBy], [f].[CreatedDate], [f].[IsDeleted], [f].[Name], [f].[UpdatedBy], [f].[UpdatedDate], [p0].[ID], [p0].[CreatedBy], [p0].[CreatedDate], [p0].[IsDeleted], [p0].[Name], [p0].[UpdatedBy], [p0].[UpdatedDate]
FROM [PMReportFormServer] AS [p]
INNER JOIN [FormStatusWarehouses] AS [f] ON [p].[FormstatusID] = [f].[ID]
INNER JOIN [PMReportFormTypes] AS [p0] ON [p].[PMReportFormTypeID] = [p0].[ID]
WHERE [p].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:54:42.180 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[ID], [c].[ActionTakenDescription], [c].[ApprovedBy], [c].[ArrivalDate], [c].[AttendedBy], [c].[CMReportFormTypeID], [c].[CompletionDate], [c].[CreatedBy], [c].[CreatedDate], [c].[Customer], [c].[FailureDetectedDate], [c].[FormstatusID], [c].[FurtherActionTakenID], [c].[IsDeleted], [c].[IssueFoundDescription], [c].[IssueReportedDescription], [c].[ProjectNo], [c].[Remark], [c].[ReportFormID], [c].[ReportTitle], [c].[ResponseDate], [c].[UpdatedBy], [c].[UpdatedDate], [f].[ID], [f].[CreatedBy], [f].[CreatedDate], [f].[IsDeleted], [f].[Name], [f].[UpdatedBy], [f].[UpdatedDate], [c0].[ID], [c0].[CreatedBy], [c0].[CreatedDate], [c0].[IsDeleted], [c0].[Name], [c0].[UpdatedBy], [c0].[UpdatedDate]
FROM [CMReportForms] AS [c]
INNER JOIN [FormStatusWarehouses] AS [f] ON [c].[FormstatusID] = [f].[ID]
INNER JOIN [CMReportFormTypes] AS [c0] ON [c].[CMReportFormTypeID] = [c0].[ID]
WHERE [c].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:54:42.211 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (5ms) [Parameters=[@__twelveMonthsAgo_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [r0].[Year], [r0].[Month], COUNT(*) AS [Count]
FROM (
    SELECT DATEPART(year, [r].[CreatedDate]) AS [Year], DATEPART(month, [r].[CreatedDate]) AS [Month]
    FROM [ReportForms] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[CreatedDate] >= @__twelveMonthsAgo_0
) AS [r0]
GROUP BY [r0].[Year], [r0].[Month]
ORDER BY [r0].[Year], [r0].[Month]
2026-01-03 22:55:33.547 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (15ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [ReportForms] AS [r]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:55:33.553 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (32ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[ID], [r].[Name], [r].[IsDeleted], [r].[CreatedDate], [r].[UpdatedDate], [r].[CreatedBy], [r].[UpdatedBy], CASE
    WHEN [u].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u].[FirstName], [u].[LastName], CASE
    WHEN [u0].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u0].[FirstName], [u0].[LastName]
FROM [ReportFormTypes] AS [r]
LEFT JOIN [Users] AS [u] ON [r].[CreatedBy] = [u].[ID]
LEFT JOIN [Users] AS [u0] ON [r].[UpdatedBy] = [u0].[ID]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:55:33.600 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (19ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[ID], [r].[Name], [r].[IsDeleted], [r].[CreatedDate], [r].[UpdatedDate], [r].[CreatedBy], [r].[UpdatedBy], CASE
    WHEN [u].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u].[FirstName], [u].[LastName], CASE
    WHEN [u0].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u0].[FirstName], [u0].[LastName]
FROM [ReportFormTypes] AS [r]
LEFT JOIN [Users] AS [u] ON [r].[CreatedBy] = [u].[ID]
LEFT JOIN [Users] AS [u0] ON [r].[UpdatedBy] = [u0].[ID]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:55:33.604 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[ID], [r].[CreatedBy], [r].[CreatedDate], [r].[FormStatus], [r].[IsDeleted], [r].[JobNo], [r].[ReportFormTypeID], [r].[StationNameWarehouseID], [r].[SystemNameWarehouseID], [r].[UpdatedBy], [r].[UpdatedDate], [r].[UploadHostname], [r].[UploadIPAddress], [r].[UploadStatus], [r0].[ID], [r0].[CreatedBy], [r0].[CreatedDate], [r0].[IsDeleted], [r0].[Name], [r0].[UpdatedBy], [r0].[UpdatedDate], [s].[ID], [s].[IsDeleted], [s].[Name], [s0].[ID], [s0].[IsDeleted], [s0].[Name], [s0].[SystemNameWarehouseID], [u].[ID], [u].[CompanyID], [u].[CreatedBy], [u].[CreatedDate], [u].[DateOfBirth], [u].[DepartmentID], [u].[Email], [u].[EmergencyContactName], [u].[EmergencyContactNumber], [u].[EmergencyRelationship], [u].[FirstName], [u].[Gender], [u].[IsDeleted], [u].[LastLogin], [u].[LastName], [u].[LastWorkingDate], [u].[LoginPassword], [u].[MobileNo], [u].[Nationality], [u].[OccupationID], [u].[OccupationLevelID], [u].[Rating], [u].[Religion], [u].[Remark], [u].[StaffCardID], [u].[StaffRFIDCardID], [u].[StartWorkingDate], [u].[SubDepartmentID], [u].[UpdatedBy], [u].[UpdatedDate], [u].[WorkPassCardExpiredDate], [u].[WorkPassCardIssuedDate], [u].[WorkPassCardNumber], [u].[WorkPermit]
FROM [ReportForms] AS [r]
INNER JOIN [ReportFormTypes] AS [r0] ON [r].[ReportFormTypeID] = [r0].[ID]
INNER JOIN [SystemNameWarehouses] AS [s] ON [r].[SystemNameWarehouseID] = [s].[ID]
INNER JOIN [StationNameWarehouses] AS [s0] ON [r].[StationNameWarehouseID] = [s0].[ID]
INNER JOIN [Users] AS [u] ON [r].[CreatedBy] = [u].[ID]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:55:33.665 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (19ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[ID], [p].[ApprovedBy], [p].[AttendedBy], [p].[CleaningOfCabinet], [p].[CreatedBy], [p].[CreatedDate], [p].[Customer], [p].[DateOfService], [p].[FormstatusID], [p].[IsDeleted], [p].[PMReportFormTypeID], [p].[ProjectNo], [p].[Remarks], [p].[ReportFormID], [p].[ReportTitle], [p].[UpdatedBy], [p].[UpdatedDate], [f].[ID], [f].[CreatedBy], [f].[CreatedDate], [f].[IsDeleted], [f].[Name], [f].[UpdatedBy], [f].[UpdatedDate], [p0].[ID], [p0].[CreatedBy], [p0].[CreatedDate], [p0].[IsDeleted], [p0].[Name], [p0].[UpdatedBy], [p0].[UpdatedDate]
FROM [PMReportFormRTU] AS [p]
INNER JOIN [FormStatusWarehouses] AS [f] ON [p].[FormstatusID] = [f].[ID]
INNER JOIN [PMReportFormTypes] AS [p0] ON [p].[PMReportFormTypeID] = [p0].[ID]
WHERE [p].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:55:33.696 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (20ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[ID], [p].[AttendedBy], [p].[CompletionDate], [p].[CreatedBy], [p].[CreatedDate], [p].[Customer], [p].[FormstatusID], [p].[IsDeleted], [p].[PMReportFormTypeID], [p].[ProjectNo], [p].[Remarks], [p].[ReportFormID], [p].[ReportTitle], [p].[StartDate], [p].[UpdatedBy], [p].[UpdatedDate], [p].[WitnessedBy], [f].[ID], [f].[CreatedBy], [f].[CreatedDate], [f].[IsDeleted], [f].[Name], [f].[UpdatedBy], [f].[UpdatedDate], [p0].[ID], [p0].[CreatedBy], [p0].[CreatedDate], [p0].[IsDeleted], [p0].[Name], [p0].[UpdatedBy], [p0].[UpdatedDate]
FROM [PMReportFormServer] AS [p]
INNER JOIN [FormStatusWarehouses] AS [f] ON [p].[FormstatusID] = [f].[ID]
INNER JOIN [PMReportFormTypes] AS [p0] ON [p].[PMReportFormTypeID] = [p0].[ID]
WHERE [p].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:55:33.739 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (31ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[ID], [c].[ActionTakenDescription], [c].[ApprovedBy], [c].[ArrivalDate], [c].[AttendedBy], [c].[CMReportFormTypeID], [c].[CompletionDate], [c].[CreatedBy], [c].[CreatedDate], [c].[Customer], [c].[FailureDetectedDate], [c].[FormstatusID], [c].[FurtherActionTakenID], [c].[IsDeleted], [c].[IssueFoundDescription], [c].[IssueReportedDescription], [c].[ProjectNo], [c].[Remark], [c].[ReportFormID], [c].[ReportTitle], [c].[ResponseDate], [c].[UpdatedBy], [c].[UpdatedDate], [f].[ID], [f].[CreatedBy], [f].[CreatedDate], [f].[IsDeleted], [f].[Name], [f].[UpdatedBy], [f].[UpdatedDate], [c0].[ID], [c0].[CreatedBy], [c0].[CreatedDate], [c0].[IsDeleted], [c0].[Name], [c0].[UpdatedBy], [c0].[UpdatedDate]
FROM [CMReportForms] AS [c]
INNER JOIN [FormStatusWarehouses] AS [f] ON [c].[FormstatusID] = [f].[ID]
INNER JOIN [CMReportFormTypes] AS [c0] ON [c].[CMReportFormTypeID] = [c0].[ID]
WHERE [c].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:55:33.776 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (19ms) [Parameters=[@__twelveMonthsAgo_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [r0].[Year], [r0].[Month], COUNT(*) AS [Count]
FROM (
    SELECT DATEPART(year, [r].[CreatedDate]) AS [Year], DATEPART(month, [r].[CreatedDate]) AS [Month]
    FROM [ReportForms] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[CreatedDate] >= @__twelveMonthsAgo_0
) AS [r0]
GROUP BY [r0].[Year], [r0].[Month]
ORDER BY [r0].[Year], [r0].[Month]
2026-01-03 22:55:33.806 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [ReportForms] AS [r]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:55:33.852 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (33ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[ID], [r].[CreatedBy], [r].[CreatedDate], [r].[FormStatus], [r].[IsDeleted], [r].[JobNo], [r].[ReportFormTypeID], [r].[StationNameWarehouseID], [r].[SystemNameWarehouseID], [r].[UpdatedBy], [r].[UpdatedDate], [r].[UploadHostname], [r].[UploadIPAddress], [r].[UploadStatus], [r0].[ID], [r0].[CreatedBy], [r0].[CreatedDate], [r0].[IsDeleted], [r0].[Name], [r0].[UpdatedBy], [r0].[UpdatedDate], [s].[ID], [s].[IsDeleted], [s].[Name], [s0].[ID], [s0].[IsDeleted], [s0].[Name], [s0].[SystemNameWarehouseID], [u].[ID], [u].[CompanyID], [u].[CreatedBy], [u].[CreatedDate], [u].[DateOfBirth], [u].[DepartmentID], [u].[Email], [u].[EmergencyContactName], [u].[EmergencyContactNumber], [u].[EmergencyRelationship], [u].[FirstName], [u].[Gender], [u].[IsDeleted], [u].[LastLogin], [u].[LastName], [u].[LastWorkingDate], [u].[LoginPassword], [u].[MobileNo], [u].[Nationality], [u].[OccupationID], [u].[OccupationLevelID], [u].[Rating], [u].[Religion], [u].[Remark], [u].[StaffCardID], [u].[StaffRFIDCardID], [u].[StartWorkingDate], [u].[SubDepartmentID], [u].[UpdatedBy], [u].[UpdatedDate], [u].[WorkPassCardExpiredDate], [u].[WorkPassCardIssuedDate], [u].[WorkPassCardNumber], [u].[WorkPermit]
FROM [ReportForms] AS [r]
INNER JOIN [ReportFormTypes] AS [r0] ON [r].[ReportFormTypeID] = [r0].[ID]
INNER JOIN [SystemNameWarehouses] AS [s] ON [r].[SystemNameWarehouseID] = [s].[ID]
INNER JOIN [StationNameWarehouses] AS [s0] ON [r].[StationNameWarehouseID] = [s0].[ID]
INNER JOIN [Users] AS [u] ON [r].[CreatedBy] = [u].[ID]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:55:33.879 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (14ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[ID], [p].[ApprovedBy], [p].[AttendedBy], [p].[CleaningOfCabinet], [p].[CreatedBy], [p].[CreatedDate], [p].[Customer], [p].[DateOfService], [p].[FormstatusID], [p].[IsDeleted], [p].[PMReportFormTypeID], [p].[ProjectNo], [p].[Remarks], [p].[ReportFormID], [p].[ReportTitle], [p].[UpdatedBy], [p].[UpdatedDate], [f].[ID], [f].[CreatedBy], [f].[CreatedDate], [f].[IsDeleted], [f].[Name], [f].[UpdatedBy], [f].[UpdatedDate], [p0].[ID], [p0].[CreatedBy], [p0].[CreatedDate], [p0].[IsDeleted], [p0].[Name], [p0].[UpdatedBy], [p0].[UpdatedDate]
FROM [PMReportFormRTU] AS [p]
INNER JOIN [FormStatusWarehouses] AS [f] ON [p].[FormstatusID] = [f].[ID]
INNER JOIN [PMReportFormTypes] AS [p0] ON [p].[PMReportFormTypeID] = [p0].[ID]
WHERE [p].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:55:33.909 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[ID], [p].[AttendedBy], [p].[CompletionDate], [p].[CreatedBy], [p].[CreatedDate], [p].[Customer], [p].[FormstatusID], [p].[IsDeleted], [p].[PMReportFormTypeID], [p].[ProjectNo], [p].[Remarks], [p].[ReportFormID], [p].[ReportTitle], [p].[StartDate], [p].[UpdatedBy], [p].[UpdatedDate], [p].[WitnessedBy], [f].[ID], [f].[CreatedBy], [f].[CreatedDate], [f].[IsDeleted], [f].[Name], [f].[UpdatedBy], [f].[UpdatedDate], [p0].[ID], [p0].[CreatedBy], [p0].[CreatedDate], [p0].[IsDeleted], [p0].[Name], [p0].[UpdatedBy], [p0].[UpdatedDate]
FROM [PMReportFormServer] AS [p]
INNER JOIN [FormStatusWarehouses] AS [f] ON [p].[FormstatusID] = [f].[ID]
INNER JOIN [PMReportFormTypes] AS [p0] ON [p].[PMReportFormTypeID] = [p0].[ID]
WHERE [p].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:55:33.925 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[ID], [c].[ActionTakenDescription], [c].[ApprovedBy], [c].[ArrivalDate], [c].[AttendedBy], [c].[CMReportFormTypeID], [c].[CompletionDate], [c].[CreatedBy], [c].[CreatedDate], [c].[Customer], [c].[FailureDetectedDate], [c].[FormstatusID], [c].[FurtherActionTakenID], [c].[IsDeleted], [c].[IssueFoundDescription], [c].[IssueReportedDescription], [c].[ProjectNo], [c].[Remark], [c].[ReportFormID], [c].[ReportTitle], [c].[ResponseDate], [c].[UpdatedBy], [c].[UpdatedDate], [f].[ID], [f].[CreatedBy], [f].[CreatedDate], [f].[IsDeleted], [f].[Name], [f].[UpdatedBy], [f].[UpdatedDate], [c0].[ID], [c0].[CreatedBy], [c0].[CreatedDate], [c0].[IsDeleted], [c0].[Name], [c0].[UpdatedBy], [c0].[UpdatedDate]
FROM [CMReportForms] AS [c]
INNER JOIN [FormStatusWarehouses] AS [f] ON [c].[FormstatusID] = [f].[ID]
INNER JOIN [CMReportFormTypes] AS [c0] ON [c].[CMReportFormTypeID] = [c0].[ID]
WHERE [c].[IsDeleted] = CAST(0 AS bit)
2026-01-03 22:55:33.939 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (2ms) [Parameters=[@__twelveMonthsAgo_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [r0].[Year], [r0].[Month], COUNT(*) AS [Count]
FROM (
    SELECT DATEPART(year, [r].[CreatedDate]) AS [Year], DATEPART(month, [r].[CreatedDate]) AS [Month]
    FROM [ReportForms] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[CreatedDate] >= @__twelveMonthsAgo_0
) AS [r0]
GROUP BY [r0].[Year], [r0].[Month]
ORDER BY [r0].[Year], [r0].[Month]
2026-01-03 23:01:51.669 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (148ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [ReportForms] AS [r]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 23:01:51.669 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (149ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[ID], [r].[Name], [r].[IsDeleted], [r].[CreatedDate], [r].[UpdatedDate], [r].[CreatedBy], [r].[UpdatedBy], CASE
    WHEN [u].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u].[FirstName], [u].[LastName], CASE
    WHEN [u0].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u0].[FirstName], [u0].[LastName]
FROM [ReportFormTypes] AS [r]
LEFT JOIN [Users] AS [u] ON [r].[CreatedBy] = [u].[ID]
LEFT JOIN [Users] AS [u0] ON [r].[UpdatedBy] = [u0].[ID]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 23:01:53.310 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (15ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[ID], [r].[Name], [r].[IsDeleted], [r].[CreatedDate], [r].[UpdatedDate], [r].[CreatedBy], [r].[UpdatedBy], CASE
    WHEN [u].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u].[FirstName], [u].[LastName], CASE
    WHEN [u0].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u0].[FirstName], [u0].[LastName]
FROM [ReportFormTypes] AS [r]
LEFT JOIN [Users] AS [u] ON [r].[CreatedBy] = [u].[ID]
LEFT JOIN [Users] AS [u0] ON [r].[UpdatedBy] = [u0].[ID]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 23:01:53.365 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (334ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[ID], [r].[CreatedBy], [r].[CreatedDate], [r].[FormStatus], [r].[IsDeleted], [r].[JobNo], [r].[ReportFormTypeID], [r].[StationNameWarehouseID], [r].[SystemNameWarehouseID], [r].[UpdatedBy], [r].[UpdatedDate], [r].[UploadHostname], [r].[UploadIPAddress], [r].[UploadStatus], [r0].[ID], [r0].[CreatedBy], [r0].[CreatedDate], [r0].[IsDeleted], [r0].[Name], [r0].[UpdatedBy], [r0].[UpdatedDate], [s].[ID], [s].[IsDeleted], [s].[Name], [s0].[ID], [s0].[IsDeleted], [s0].[Name], [s0].[SystemNameWarehouseID], [u].[ID], [u].[CompanyID], [u].[CreatedBy], [u].[CreatedDate], [u].[DateOfBirth], [u].[DepartmentID], [u].[Email], [u].[EmergencyContactName], [u].[EmergencyContactNumber], [u].[EmergencyRelationship], [u].[FirstName], [u].[Gender], [u].[IsDeleted], [u].[LastLogin], [u].[LastName], [u].[LastWorkingDate], [u].[LoginPassword], [u].[MobileNo], [u].[Nationality], [u].[OccupationID], [u].[OccupationLevelID], [u].[Rating], [u].[Religion], [u].[Remark], [u].[StaffCardID], [u].[StaffRFIDCardID], [u].[StartWorkingDate], [u].[SubDepartmentID], [u].[UpdatedBy], [u].[UpdatedDate], [u].[WorkPassCardExpiredDate], [u].[WorkPassCardIssuedDate], [u].[WorkPassCardNumber], [u].[WorkPermit]
FROM [ReportForms] AS [r]
INNER JOIN [ReportFormTypes] AS [r0] ON [r].[ReportFormTypeID] = [r0].[ID]
INNER JOIN [SystemNameWarehouses] AS [s] ON [r].[SystemNameWarehouseID] = [s].[ID]
INNER JOIN [StationNameWarehouses] AS [s0] ON [r].[StationNameWarehouseID] = [s0].[ID]
INNER JOIN [Users] AS [u] ON [r].[CreatedBy] = [u].[ID]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 23:01:53.427 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (42ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[ID], [p].[ApprovedBy], [p].[AttendedBy], [p].[CleaningOfCabinet], [p].[CreatedBy], [p].[CreatedDate], [p].[Customer], [p].[DateOfService], [p].[FormstatusID], [p].[IsDeleted], [p].[PMReportFormTypeID], [p].[ProjectNo], [p].[Remarks], [p].[ReportFormID], [p].[ReportTitle], [p].[UpdatedBy], [p].[UpdatedDate], [f].[ID], [f].[CreatedBy], [f].[CreatedDate], [f].[IsDeleted], [f].[Name], [f].[UpdatedBy], [f].[UpdatedDate], [p0].[ID], [p0].[CreatedBy], [p0].[CreatedDate], [p0].[IsDeleted], [p0].[Name], [p0].[UpdatedBy], [p0].[UpdatedDate]
FROM [PMReportFormRTU] AS [p]
INNER JOIN [FormStatusWarehouses] AS [f] ON [p].[FormstatusID] = [f].[ID]
INNER JOIN [PMReportFormTypes] AS [p0] ON [p].[PMReportFormTypeID] = [p0].[ID]
WHERE [p].[IsDeleted] = CAST(0 AS bit)
2026-01-03 23:01:53.464 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (21ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[ID], [p].[AttendedBy], [p].[CompletionDate], [p].[CreatedBy], [p].[CreatedDate], [p].[Customer], [p].[FormstatusID], [p].[IsDeleted], [p].[PMReportFormTypeID], [p].[ProjectNo], [p].[Remarks], [p].[ReportFormID], [p].[ReportTitle], [p].[StartDate], [p].[UpdatedBy], [p].[UpdatedDate], [p].[WitnessedBy], [f].[ID], [f].[CreatedBy], [f].[CreatedDate], [f].[IsDeleted], [f].[Name], [f].[UpdatedBy], [f].[UpdatedDate], [p0].[ID], [p0].[CreatedBy], [p0].[CreatedDate], [p0].[IsDeleted], [p0].[Name], [p0].[UpdatedBy], [p0].[UpdatedDate]
FROM [PMReportFormServer] AS [p]
INNER JOIN [FormStatusWarehouses] AS [f] ON [p].[FormstatusID] = [f].[ID]
INNER JOIN [PMReportFormTypes] AS [p0] ON [p].[PMReportFormTypeID] = [p0].[ID]
WHERE [p].[IsDeleted] = CAST(0 AS bit)
2026-01-03 23:01:53.507 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (27ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[ID], [c].[ActionTakenDescription], [c].[ApprovedBy], [c].[ArrivalDate], [c].[AttendedBy], [c].[CMReportFormTypeID], [c].[CompletionDate], [c].[CreatedBy], [c].[CreatedDate], [c].[Customer], [c].[FailureDetectedDate], [c].[FormstatusID], [c].[FurtherActionTakenID], [c].[IsDeleted], [c].[IssueFoundDescription], [c].[IssueReportedDescription], [c].[ProjectNo], [c].[Remark], [c].[ReportFormID], [c].[ReportTitle], [c].[ResponseDate], [c].[UpdatedBy], [c].[UpdatedDate], [f].[ID], [f].[CreatedBy], [f].[CreatedDate], [f].[IsDeleted], [f].[Name], [f].[UpdatedBy], [f].[UpdatedDate], [c0].[ID], [c0].[CreatedBy], [c0].[CreatedDate], [c0].[IsDeleted], [c0].[Name], [c0].[UpdatedBy], [c0].[UpdatedDate]
FROM [CMReportForms] AS [c]
INNER JOIN [FormStatusWarehouses] AS [f] ON [c].[FormstatusID] = [f].[ID]
INNER JOIN [CMReportFormTypes] AS [c0] ON [c].[CMReportFormTypeID] = [c0].[ID]
WHERE [c].[IsDeleted] = CAST(0 AS bit)
2026-01-03 23:01:53.529 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (10ms) [Parameters=[@__twelveMonthsAgo_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [r0].[Year], [r0].[Month], COUNT(*) AS [Count]
FROM (
    SELECT DATEPART(year, [r].[CreatedDate]) AS [Year], DATEPART(month, [r].[CreatedDate]) AS [Month]
    FROM [ReportForms] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[CreatedDate] >= @__twelveMonthsAgo_0
) AS [r0]
GROUP BY [r0].[Year], [r0].[Month]
ORDER BY [r0].[Year], [r0].[Month]
2026-01-03 23:01:53.555 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [ReportForms] AS [r]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 23:01:53.574 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[ID], [r].[CreatedBy], [r].[CreatedDate], [r].[FormStatus], [r].[IsDeleted], [r].[JobNo], [r].[ReportFormTypeID], [r].[StationNameWarehouseID], [r].[SystemNameWarehouseID], [r].[UpdatedBy], [r].[UpdatedDate], [r].[UploadHostname], [r].[UploadIPAddress], [r].[UploadStatus], [r0].[ID], [r0].[CreatedBy], [r0].[CreatedDate], [r0].[IsDeleted], [r0].[Name], [r0].[UpdatedBy], [r0].[UpdatedDate], [s].[ID], [s].[IsDeleted], [s].[Name], [s0].[ID], [s0].[IsDeleted], [s0].[Name], [s0].[SystemNameWarehouseID], [u].[ID], [u].[CompanyID], [u].[CreatedBy], [u].[CreatedDate], [u].[DateOfBirth], [u].[DepartmentID], [u].[Email], [u].[EmergencyContactName], [u].[EmergencyContactNumber], [u].[EmergencyRelationship], [u].[FirstName], [u].[Gender], [u].[IsDeleted], [u].[LastLogin], [u].[LastName], [u].[LastWorkingDate], [u].[LoginPassword], [u].[MobileNo], [u].[Nationality], [u].[OccupationID], [u].[OccupationLevelID], [u].[Rating], [u].[Religion], [u].[Remark], [u].[StaffCardID], [u].[StaffRFIDCardID], [u].[StartWorkingDate], [u].[SubDepartmentID], [u].[UpdatedBy], [u].[UpdatedDate], [u].[WorkPassCardExpiredDate], [u].[WorkPassCardIssuedDate], [u].[WorkPassCardNumber], [u].[WorkPermit]
FROM [ReportForms] AS [r]
INNER JOIN [ReportFormTypes] AS [r0] ON [r].[ReportFormTypeID] = [r0].[ID]
INNER JOIN [SystemNameWarehouses] AS [s] ON [r].[SystemNameWarehouseID] = [s].[ID]
INNER JOIN [StationNameWarehouses] AS [s0] ON [r].[StationNameWarehouseID] = [s0].[ID]
INNER JOIN [Users] AS [u] ON [r].[CreatedBy] = [u].[ID]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 23:01:53.606 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[ID], [p].[ApprovedBy], [p].[AttendedBy], [p].[CleaningOfCabinet], [p].[CreatedBy], [p].[CreatedDate], [p].[Customer], [p].[DateOfService], [p].[FormstatusID], [p].[IsDeleted], [p].[PMReportFormTypeID], [p].[ProjectNo], [p].[Remarks], [p].[ReportFormID], [p].[ReportTitle], [p].[UpdatedBy], [p].[UpdatedDate], [f].[ID], [f].[CreatedBy], [f].[CreatedDate], [f].[IsDeleted], [f].[Name], [f].[UpdatedBy], [f].[UpdatedDate], [p0].[ID], [p0].[CreatedBy], [p0].[CreatedDate], [p0].[IsDeleted], [p0].[Name], [p0].[UpdatedBy], [p0].[UpdatedDate]
FROM [PMReportFormRTU] AS [p]
INNER JOIN [FormStatusWarehouses] AS [f] ON [p].[FormstatusID] = [f].[ID]
INNER JOIN [PMReportFormTypes] AS [p0] ON [p].[PMReportFormTypeID] = [p0].[ID]
WHERE [p].[IsDeleted] = CAST(0 AS bit)
2026-01-03 23:01:53.619 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[ID], [p].[AttendedBy], [p].[CompletionDate], [p].[CreatedBy], [p].[CreatedDate], [p].[Customer], [p].[FormstatusID], [p].[IsDeleted], [p].[PMReportFormTypeID], [p].[ProjectNo], [p].[Remarks], [p].[ReportFormID], [p].[ReportTitle], [p].[StartDate], [p].[UpdatedBy], [p].[UpdatedDate], [p].[WitnessedBy], [f].[ID], [f].[CreatedBy], [f].[CreatedDate], [f].[IsDeleted], [f].[Name], [f].[UpdatedBy], [f].[UpdatedDate], [p0].[ID], [p0].[CreatedBy], [p0].[CreatedDate], [p0].[IsDeleted], [p0].[Name], [p0].[UpdatedBy], [p0].[UpdatedDate]
FROM [PMReportFormServer] AS [p]
INNER JOIN [FormStatusWarehouses] AS [f] ON [p].[FormstatusID] = [f].[ID]
INNER JOIN [PMReportFormTypes] AS [p0] ON [p].[PMReportFormTypeID] = [p0].[ID]
WHERE [p].[IsDeleted] = CAST(0 AS bit)
2026-01-03 23:01:53.632 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[ID], [c].[ActionTakenDescription], [c].[ApprovedBy], [c].[ArrivalDate], [c].[AttendedBy], [c].[CMReportFormTypeID], [c].[CompletionDate], [c].[CreatedBy], [c].[CreatedDate], [c].[Customer], [c].[FailureDetectedDate], [c].[FormstatusID], [c].[FurtherActionTakenID], [c].[IsDeleted], [c].[IssueFoundDescription], [c].[IssueReportedDescription], [c].[ProjectNo], [c].[Remark], [c].[ReportFormID], [c].[ReportTitle], [c].[ResponseDate], [c].[UpdatedBy], [c].[UpdatedDate], [f].[ID], [f].[CreatedBy], [f].[CreatedDate], [f].[IsDeleted], [f].[Name], [f].[UpdatedBy], [f].[UpdatedDate], [c0].[ID], [c0].[CreatedBy], [c0].[CreatedDate], [c0].[IsDeleted], [c0].[Name], [c0].[UpdatedBy], [c0].[UpdatedDate]
FROM [CMReportForms] AS [c]
INNER JOIN [FormStatusWarehouses] AS [f] ON [c].[FormstatusID] = [f].[ID]
INNER JOIN [CMReportFormTypes] AS [c0] ON [c].[CMReportFormTypeID] = [c0].[ID]
WHERE [c].[IsDeleted] = CAST(0 AS bit)
2026-01-03 23:01:53.645 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (3ms) [Parameters=[@__twelveMonthsAgo_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [r0].[Year], [r0].[Month], COUNT(*) AS [Count]
FROM (
    SELECT DATEPART(year, [r].[CreatedDate]) AS [Year], DATEPART(month, [r].[CreatedDate]) AS [Month]
    FROM [ReportForms] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[CreatedDate] >= @__twelveMonthsAgo_0
) AS [r0]
GROUP BY [r0].[Year], [r0].[Month]
ORDER BY [r0].[Year], [r0].[Month]
2026-01-03 23:06:03.979 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (17ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[ID], [r].[Name], [r].[IsDeleted], [r].[CreatedDate], [r].[UpdatedDate], [r].[CreatedBy], [r].[UpdatedBy], CASE
    WHEN [u].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u].[FirstName], [u].[LastName], CASE
    WHEN [u0].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u0].[FirstName], [u0].[LastName]
FROM [ReportFormTypes] AS [r]
LEFT JOIN [Users] AS [u] ON [r].[CreatedBy] = [u].[ID]
LEFT JOIN [Users] AS [u0] ON [r].[UpdatedBy] = [u0].[ID]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 23:06:04.055 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (37ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [ReportForms] AS [r]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 23:06:04.202 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (112ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[ID], [r].[Name], [r].[IsDeleted], [r].[CreatedDate], [r].[UpdatedDate], [r].[CreatedBy], [r].[UpdatedBy], CASE
    WHEN [u].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u].[FirstName], [u].[LastName], CASE
    WHEN [u0].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u0].[FirstName], [u0].[LastName]
FROM [ReportFormTypes] AS [r]
LEFT JOIN [Users] AS [u] ON [r].[CreatedBy] = [u].[ID]
LEFT JOIN [Users] AS [u0] ON [r].[UpdatedBy] = [u0].[ID]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 23:06:06.211 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (155ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[ID], [r].[CreatedBy], [r].[CreatedDate], [r].[FormStatus], [r].[IsDeleted], [r].[JobNo], [r].[ReportFormTypeID], [r].[StationNameWarehouseID], [r].[SystemNameWarehouseID], [r].[UpdatedBy], [r].[UpdatedDate], [r].[UploadHostname], [r].[UploadIPAddress], [r].[UploadStatus], [r0].[ID], [r0].[CreatedBy], [r0].[CreatedDate], [r0].[IsDeleted], [r0].[Name], [r0].[UpdatedBy], [r0].[UpdatedDate], [s].[ID], [s].[IsDeleted], [s].[Name], [s0].[ID], [s0].[IsDeleted], [s0].[Name], [s0].[SystemNameWarehouseID], [u].[ID], [u].[CompanyID], [u].[CreatedBy], [u].[CreatedDate], [u].[DateOfBirth], [u].[DepartmentID], [u].[Email], [u].[EmergencyContactName], [u].[EmergencyContactNumber], [u].[EmergencyRelationship], [u].[FirstName], [u].[Gender], [u].[IsDeleted], [u].[LastLogin], [u].[LastName], [u].[LastWorkingDate], [u].[LoginPassword], [u].[MobileNo], [u].[Nationality], [u].[OccupationID], [u].[OccupationLevelID], [u].[Rating], [u].[Religion], [u].[Remark], [u].[StaffCardID], [u].[StaffRFIDCardID], [u].[StartWorkingDate], [u].[SubDepartmentID], [u].[UpdatedBy], [u].[UpdatedDate], [u].[WorkPassCardExpiredDate], [u].[WorkPassCardIssuedDate], [u].[WorkPassCardNumber], [u].[WorkPermit]
FROM [ReportForms] AS [r]
INNER JOIN [ReportFormTypes] AS [r0] ON [r].[ReportFormTypeID] = [r0].[ID]
INNER JOIN [SystemNameWarehouses] AS [s] ON [r].[SystemNameWarehouseID] = [s].[ID]
INNER JOIN [StationNameWarehouses] AS [s0] ON [r].[StationNameWarehouseID] = [s0].[ID]
INNER JOIN [Users] AS [u] ON [r].[CreatedBy] = [u].[ID]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 23:06:08.626 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (83ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[ID], [p].[ApprovedBy], [p].[AttendedBy], [p].[CleaningOfCabinet], [p].[CreatedBy], [p].[CreatedDate], [p].[Customer], [p].[DateOfService], [p].[FormstatusID], [p].[IsDeleted], [p].[PMReportFormTypeID], [p].[ProjectNo], [p].[Remarks], [p].[ReportFormID], [p].[ReportTitle], [p].[UpdatedBy], [p].[UpdatedDate], [f].[ID], [f].[CreatedBy], [f].[CreatedDate], [f].[IsDeleted], [f].[Name], [f].[UpdatedBy], [f].[UpdatedDate], [p0].[ID], [p0].[CreatedBy], [p0].[CreatedDate], [p0].[IsDeleted], [p0].[Name], [p0].[UpdatedBy], [p0].[UpdatedDate]
FROM [PMReportFormRTU] AS [p]
INNER JOIN [FormStatusWarehouses] AS [f] ON [p].[FormstatusID] = [f].[ID]
INNER JOIN [PMReportFormTypes] AS [p0] ON [p].[PMReportFormTypeID] = [p0].[ID]
WHERE [p].[IsDeleted] = CAST(0 AS bit)
2026-01-03 23:06:08.795 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[ID], [p].[AttendedBy], [p].[CompletionDate], [p].[CreatedBy], [p].[CreatedDate], [p].[Customer], [p].[FormstatusID], [p].[IsDeleted], [p].[PMReportFormTypeID], [p].[ProjectNo], [p].[Remarks], [p].[ReportFormID], [p].[ReportTitle], [p].[StartDate], [p].[UpdatedBy], [p].[UpdatedDate], [p].[WitnessedBy], [f].[ID], [f].[CreatedBy], [f].[CreatedDate], [f].[IsDeleted], [f].[Name], [f].[UpdatedBy], [f].[UpdatedDate], [p0].[ID], [p0].[CreatedBy], [p0].[CreatedDate], [p0].[IsDeleted], [p0].[Name], [p0].[UpdatedBy], [p0].[UpdatedDate]
FROM [PMReportFormServer] AS [p]
INNER JOIN [FormStatusWarehouses] AS [f] ON [p].[FormstatusID] = [f].[ID]
INNER JOIN [PMReportFormTypes] AS [p0] ON [p].[PMReportFormTypeID] = [p0].[ID]
WHERE [p].[IsDeleted] = CAST(0 AS bit)
2026-01-03 23:06:08.929 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (101ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[ID], [c].[ActionTakenDescription], [c].[ApprovedBy], [c].[ArrivalDate], [c].[AttendedBy], [c].[CMReportFormTypeID], [c].[CompletionDate], [c].[CreatedBy], [c].[CreatedDate], [c].[Customer], [c].[FailureDetectedDate], [c].[FormstatusID], [c].[FurtherActionTakenID], [c].[IsDeleted], [c].[IssueFoundDescription], [c].[IssueReportedDescription], [c].[ProjectNo], [c].[Remark], [c].[ReportFormID], [c].[ReportTitle], [c].[ResponseDate], [c].[UpdatedBy], [c].[UpdatedDate], [f].[ID], [f].[CreatedBy], [f].[CreatedDate], [f].[IsDeleted], [f].[Name], [f].[UpdatedBy], [f].[UpdatedDate], [c0].[ID], [c0].[CreatedBy], [c0].[CreatedDate], [c0].[IsDeleted], [c0].[Name], [c0].[UpdatedBy], [c0].[UpdatedDate]
FROM [CMReportForms] AS [c]
INNER JOIN [FormStatusWarehouses] AS [f] ON [c].[FormstatusID] = [f].[ID]
INNER JOIN [CMReportFormTypes] AS [c0] ON [c].[CMReportFormTypeID] = [c0].[ID]
WHERE [c].[IsDeleted] = CAST(0 AS bit)
2026-01-03 23:06:09.052 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (7ms) [Parameters=[@__twelveMonthsAgo_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [r0].[Year], [r0].[Month], COUNT(*) AS [Count]
FROM (
    SELECT DATEPART(year, [r].[CreatedDate]) AS [Year], DATEPART(month, [r].[CreatedDate]) AS [Month]
    FROM [ReportForms] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[CreatedDate] >= @__twelveMonthsAgo_0
) AS [r0]
GROUP BY [r0].[Year], [r0].[Month]
ORDER BY [r0].[Year], [r0].[Month]
2026-01-03 23:06:09.117 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [ReportForms] AS [r]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 23:06:09.149 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[ID], [r].[CreatedBy], [r].[CreatedDate], [r].[FormStatus], [r].[IsDeleted], [r].[JobNo], [r].[ReportFormTypeID], [r].[StationNameWarehouseID], [r].[SystemNameWarehouseID], [r].[UpdatedBy], [r].[UpdatedDate], [r].[UploadHostname], [r].[UploadIPAddress], [r].[UploadStatus], [r0].[ID], [r0].[CreatedBy], [r0].[CreatedDate], [r0].[IsDeleted], [r0].[Name], [r0].[UpdatedBy], [r0].[UpdatedDate], [s].[ID], [s].[IsDeleted], [s].[Name], [s0].[ID], [s0].[IsDeleted], [s0].[Name], [s0].[SystemNameWarehouseID], [u].[ID], [u].[CompanyID], [u].[CreatedBy], [u].[CreatedDate], [u].[DateOfBirth], [u].[DepartmentID], [u].[Email], [u].[EmergencyContactName], [u].[EmergencyContactNumber], [u].[EmergencyRelationship], [u].[FirstName], [u].[Gender], [u].[IsDeleted], [u].[LastLogin], [u].[LastName], [u].[LastWorkingDate], [u].[LoginPassword], [u].[MobileNo], [u].[Nationality], [u].[OccupationID], [u].[OccupationLevelID], [u].[Rating], [u].[Religion], [u].[Remark], [u].[StaffCardID], [u].[StaffRFIDCardID], [u].[StartWorkingDate], [u].[SubDepartmentID], [u].[UpdatedBy], [u].[UpdatedDate], [u].[WorkPassCardExpiredDate], [u].[WorkPassCardIssuedDate], [u].[WorkPassCardNumber], [u].[WorkPermit]
FROM [ReportForms] AS [r]
INNER JOIN [ReportFormTypes] AS [r0] ON [r].[ReportFormTypeID] = [r0].[ID]
INNER JOIN [SystemNameWarehouses] AS [s] ON [r].[SystemNameWarehouseID] = [s].[ID]
INNER JOIN [StationNameWarehouses] AS [s0] ON [r].[StationNameWarehouseID] = [s0].[ID]
INNER JOIN [Users] AS [u] ON [r].[CreatedBy] = [u].[ID]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 23:06:09.250 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[ID], [p].[ApprovedBy], [p].[AttendedBy], [p].[CleaningOfCabinet], [p].[CreatedBy], [p].[CreatedDate], [p].[Customer], [p].[DateOfService], [p].[FormstatusID], [p].[IsDeleted], [p].[PMReportFormTypeID], [p].[ProjectNo], [p].[Remarks], [p].[ReportFormID], [p].[ReportTitle], [p].[UpdatedBy], [p].[UpdatedDate], [f].[ID], [f].[CreatedBy], [f].[CreatedDate], [f].[IsDeleted], [f].[Name], [f].[UpdatedBy], [f].[UpdatedDate], [p0].[ID], [p0].[CreatedBy], [p0].[CreatedDate], [p0].[IsDeleted], [p0].[Name], [p0].[UpdatedBy], [p0].[UpdatedDate]
FROM [PMReportFormRTU] AS [p]
INNER JOIN [FormStatusWarehouses] AS [f] ON [p].[FormstatusID] = [f].[ID]
INNER JOIN [PMReportFormTypes] AS [p0] ON [p].[PMReportFormTypeID] = [p0].[ID]
WHERE [p].[IsDeleted] = CAST(0 AS bit)
2026-01-03 23:06:09.280 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[ID], [p].[AttendedBy], [p].[CompletionDate], [p].[CreatedBy], [p].[CreatedDate], [p].[Customer], [p].[FormstatusID], [p].[IsDeleted], [p].[PMReportFormTypeID], [p].[ProjectNo], [p].[Remarks], [p].[ReportFormID], [p].[ReportTitle], [p].[StartDate], [p].[UpdatedBy], [p].[UpdatedDate], [p].[WitnessedBy], [f].[ID], [f].[CreatedBy], [f].[CreatedDate], [f].[IsDeleted], [f].[Name], [f].[UpdatedBy], [f].[UpdatedDate], [p0].[ID], [p0].[CreatedBy], [p0].[CreatedDate], [p0].[IsDeleted], [p0].[Name], [p0].[UpdatedBy], [p0].[UpdatedDate]
FROM [PMReportFormServer] AS [p]
INNER JOIN [FormStatusWarehouses] AS [f] ON [p].[FormstatusID] = [f].[ID]
INNER JOIN [PMReportFormTypes] AS [p0] ON [p].[PMReportFormTypeID] = [p0].[ID]
WHERE [p].[IsDeleted] = CAST(0 AS bit)
2026-01-03 23:06:09.310 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[ID], [c].[ActionTakenDescription], [c].[ApprovedBy], [c].[ArrivalDate], [c].[AttendedBy], [c].[CMReportFormTypeID], [c].[CompletionDate], [c].[CreatedBy], [c].[CreatedDate], [c].[Customer], [c].[FailureDetectedDate], [c].[FormstatusID], [c].[FurtherActionTakenID], [c].[IsDeleted], [c].[IssueFoundDescription], [c].[IssueReportedDescription], [c].[ProjectNo], [c].[Remark], [c].[ReportFormID], [c].[ReportTitle], [c].[ResponseDate], [c].[UpdatedBy], [c].[UpdatedDate], [f].[ID], [f].[CreatedBy], [f].[CreatedDate], [f].[IsDeleted], [f].[Name], [f].[UpdatedBy], [f].[UpdatedDate], [c0].[ID], [c0].[CreatedBy], [c0].[CreatedDate], [c0].[IsDeleted], [c0].[Name], [c0].[UpdatedBy], [c0].[UpdatedDate]
FROM [CMReportForms] AS [c]
INNER JOIN [FormStatusWarehouses] AS [f] ON [c].[FormstatusID] = [f].[ID]
INNER JOIN [CMReportFormTypes] AS [c0] ON [c].[CMReportFormTypeID] = [c0].[ID]
WHERE [c].[IsDeleted] = CAST(0 AS bit)
2026-01-03 23:06:09.335 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (8ms) [Parameters=[@__twelveMonthsAgo_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [r0].[Year], [r0].[Month], COUNT(*) AS [Count]
FROM (
    SELECT DATEPART(year, [r].[CreatedDate]) AS [Year], DATEPART(month, [r].[CreatedDate]) AS [Month]
    FROM [ReportForms] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[CreatedDate] >= @__twelveMonthsAgo_0
) AS [r0]
GROUP BY [r0].[Year], [r0].[Month]
ORDER BY [r0].[Year], [r0].[Month]
2026-01-03 23:13:33.849 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (37ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [ReportForms] AS [r]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 23:13:33.912 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[ID], [r].[CreatedBy], [r].[CreatedDate], [r].[FormStatus], [r].[IsDeleted], [r].[JobNo], [r].[ReportFormTypeID], [r].[StationNameWarehouseID], [r].[SystemNameWarehouseID], [r].[UpdatedBy], [r].[UpdatedDate], [r].[UploadHostname], [r].[UploadIPAddress], [r].[UploadStatus], [r0].[ID], [r0].[CreatedBy], [r0].[CreatedDate], [r0].[IsDeleted], [r0].[Name], [r0].[UpdatedBy], [r0].[UpdatedDate], [s].[ID], [s].[IsDeleted], [s].[Name], [s0].[ID], [s0].[IsDeleted], [s0].[Name], [s0].[SystemNameWarehouseID], [u].[ID], [u].[CompanyID], [u].[CreatedBy], [u].[CreatedDate], [u].[DateOfBirth], [u].[DepartmentID], [u].[Email], [u].[EmergencyContactName], [u].[EmergencyContactNumber], [u].[EmergencyRelationship], [u].[FirstName], [u].[Gender], [u].[IsDeleted], [u].[LastLogin], [u].[LastName], [u].[LastWorkingDate], [u].[LoginPassword], [u].[MobileNo], [u].[Nationality], [u].[OccupationID], [u].[OccupationLevelID], [u].[Rating], [u].[Religion], [u].[Remark], [u].[StaffCardID], [u].[StaffRFIDCardID], [u].[StartWorkingDate], [u].[SubDepartmentID], [u].[UpdatedBy], [u].[UpdatedDate], [u].[WorkPassCardExpiredDate], [u].[WorkPassCardIssuedDate], [u].[WorkPassCardNumber], [u].[WorkPermit]
FROM [ReportForms] AS [r]
INNER JOIN [ReportFormTypes] AS [r0] ON [r].[ReportFormTypeID] = [r0].[ID]
INNER JOIN [SystemNameWarehouses] AS [s] ON [r].[SystemNameWarehouseID] = [s].[ID]
INNER JOIN [StationNameWarehouses] AS [s0] ON [r].[StationNameWarehouseID] = [s0].[ID]
INNER JOIN [Users] AS [u] ON [r].[CreatedBy] = [u].[ID]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 23:13:34.285 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (290ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[ID], [p].[ApprovedBy], [p].[AttendedBy], [p].[CleaningOfCabinet], [p].[CreatedBy], [p].[CreatedDate], [p].[Customer], [p].[DateOfService], [p].[FormstatusID], [p].[IsDeleted], [p].[PMReportFormTypeID], [p].[ProjectNo], [p].[Remarks], [p].[ReportFormID], [p].[ReportTitle], [p].[UpdatedBy], [p].[UpdatedDate], [f].[ID], [f].[CreatedBy], [f].[CreatedDate], [f].[IsDeleted], [f].[Name], [f].[UpdatedBy], [f].[UpdatedDate], [p0].[ID], [p0].[CreatedBy], [p0].[CreatedDate], [p0].[IsDeleted], [p0].[Name], [p0].[UpdatedBy], [p0].[UpdatedDate]
FROM [PMReportFormRTU] AS [p]
INNER JOIN [FormStatusWarehouses] AS [f] ON [p].[FormstatusID] = [f].[ID]
INNER JOIN [PMReportFormTypes] AS [p0] ON [p].[PMReportFormTypeID] = [p0].[ID]
WHERE [p].[IsDeleted] = CAST(0 AS bit)
2026-01-03 23:13:34.664 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (30ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[ID], [p].[AttendedBy], [p].[CompletionDate], [p].[CreatedBy], [p].[CreatedDate], [p].[Customer], [p].[FormstatusID], [p].[IsDeleted], [p].[PMReportFormTypeID], [p].[ProjectNo], [p].[Remarks], [p].[ReportFormID], [p].[ReportTitle], [p].[StartDate], [p].[UpdatedBy], [p].[UpdatedDate], [p].[WitnessedBy], [f].[ID], [f].[CreatedBy], [f].[CreatedDate], [f].[IsDeleted], [f].[Name], [f].[UpdatedBy], [f].[UpdatedDate], [p0].[ID], [p0].[CreatedBy], [p0].[CreatedDate], [p0].[IsDeleted], [p0].[Name], [p0].[UpdatedBy], [p0].[UpdatedDate]
FROM [PMReportFormServer] AS [p]
INNER JOIN [FormStatusWarehouses] AS [f] ON [p].[FormstatusID] = [f].[ID]
INNER JOIN [PMReportFormTypes] AS [p0] ON [p].[PMReportFormTypeID] = [p0].[ID]
WHERE [p].[IsDeleted] = CAST(0 AS bit)
2026-01-03 23:13:34.852 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (36ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[ID], [c].[ActionTakenDescription], [c].[ApprovedBy], [c].[ArrivalDate], [c].[AttendedBy], [c].[CMReportFormTypeID], [c].[CompletionDate], [c].[CreatedBy], [c].[CreatedDate], [c].[Customer], [c].[FailureDetectedDate], [c].[FormstatusID], [c].[FurtherActionTakenID], [c].[IsDeleted], [c].[IssueFoundDescription], [c].[IssueReportedDescription], [c].[ProjectNo], [c].[Remark], [c].[ReportFormID], [c].[ReportTitle], [c].[ResponseDate], [c].[UpdatedBy], [c].[UpdatedDate], [f].[ID], [f].[CreatedBy], [f].[CreatedDate], [f].[IsDeleted], [f].[Name], [f].[UpdatedBy], [f].[UpdatedDate], [c0].[ID], [c0].[CreatedBy], [c0].[CreatedDate], [c0].[IsDeleted], [c0].[Name], [c0].[UpdatedBy], [c0].[UpdatedDate]
FROM [CMReportForms] AS [c]
INNER JOIN [FormStatusWarehouses] AS [f] ON [c].[FormstatusID] = [f].[ID]
INNER JOIN [CMReportFormTypes] AS [c0] ON [c].[CMReportFormTypeID] = [c0].[ID]
WHERE [c].[IsDeleted] = CAST(0 AS bit)
2026-01-03 23:13:36.617 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (124ms) [Parameters=[@__twelveMonthsAgo_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [r0].[Year], [r0].[Month], COUNT(*) AS [Count]
FROM (
    SELECT DATEPART(year, [r].[CreatedDate]) AS [Year], DATEPART(month, [r].[CreatedDate]) AS [Month]
    FROM [ReportForms] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[CreatedDate] >= @__twelveMonthsAgo_0
) AS [r0]
GROUP BY [r0].[Year], [r0].[Month]
ORDER BY [r0].[Year], [r0].[Month]
2026-01-03 23:13:43.710 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (17ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[ReportFormID]
FROM [CMReportForms] AS [c]
WHERE [c].[IsDeleted] = CAST(0 AS bit)
2026-01-03 23:13:43.925 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (17ms) [Parameters=[@__cmReportFormIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [ReportForms] AS [r]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[ID] IN (
    SELECT [c].[value]
    FROM OPENJSON(@__cmReportFormIds_0) WITH ([value] uniqueidentifier '$') AS [c]
)
2026-01-03 23:13:44.112 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (61ms) [Parameters=[@__cmReportFormIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[ID], [r].[CreatedBy], [r].[CreatedDate], [r].[FormStatus], [r].[IsDeleted], [r].[JobNo], [r].[ReportFormTypeID], [r].[StationNameWarehouseID], [r].[SystemNameWarehouseID], [r].[UpdatedBy], [r].[UpdatedDate], [r].[UploadHostname], [r].[UploadIPAddress], [r].[UploadStatus], [r0].[ID], [r0].[CreatedBy], [r0].[CreatedDate], [r0].[IsDeleted], [r0].[Name], [r0].[UpdatedBy], [r0].[UpdatedDate], [s].[ID], [s].[IsDeleted], [s].[Name], [s0].[ID], [s0].[IsDeleted], [s0].[Name], [s0].[SystemNameWarehouseID], [u].[ID], [u].[CompanyID], [u].[CreatedBy], [u].[CreatedDate], [u].[DateOfBirth], [u].[DepartmentID], [u].[Email], [u].[EmergencyContactName], [u].[EmergencyContactNumber], [u].[EmergencyRelationship], [u].[FirstName], [u].[Gender], [u].[IsDeleted], [u].[LastLogin], [u].[LastName], [u].[LastWorkingDate], [u].[LoginPassword], [u].[MobileNo], [u].[Nationality], [u].[OccupationID], [u].[OccupationLevelID], [u].[Rating], [u].[Religion], [u].[Remark], [u].[StaffCardID], [u].[StaffRFIDCardID], [u].[StartWorkingDate], [u].[SubDepartmentID], [u].[UpdatedBy], [u].[UpdatedDate], [u].[WorkPassCardExpiredDate], [u].[WorkPassCardIssuedDate], [u].[WorkPassCardNumber], [u].[WorkPermit]
FROM [ReportForms] AS [r]
INNER JOIN [ReportFormTypes] AS [r0] ON [r].[ReportFormTypeID] = [r0].[ID]
INNER JOIN [SystemNameWarehouses] AS [s] ON [r].[SystemNameWarehouseID] = [s].[ID]
INNER JOIN [StationNameWarehouses] AS [s0] ON [r].[StationNameWarehouseID] = [s0].[ID]
INNER JOIN [Users] AS [u] ON [r].[CreatedBy] = [u].[ID]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[ID] IN (
    SELECT [c].[value]
    FROM OPENJSON(@__cmReportFormIds_0) WITH ([value] uniqueidentifier '$') AS [c]
)
2026-01-03 23:13:44.135 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[ID], [p].[ApprovedBy], [p].[AttendedBy], [p].[CleaningOfCabinet], [p].[CreatedBy], [p].[CreatedDate], [p].[Customer], [p].[DateOfService], [p].[FormstatusID], [p].[IsDeleted], [p].[PMReportFormTypeID], [p].[ProjectNo], [p].[Remarks], [p].[ReportFormID], [p].[ReportTitle], [p].[UpdatedBy], [p].[UpdatedDate], [f].[ID], [f].[CreatedBy], [f].[CreatedDate], [f].[IsDeleted], [f].[Name], [f].[UpdatedBy], [f].[UpdatedDate], [p0].[ID], [p0].[CreatedBy], [p0].[CreatedDate], [p0].[IsDeleted], [p0].[Name], [p0].[UpdatedBy], [p0].[UpdatedDate]
FROM [PMReportFormRTU] AS [p]
INNER JOIN [FormStatusWarehouses] AS [f] ON [p].[FormstatusID] = [f].[ID]
INNER JOIN [PMReportFormTypes] AS [p0] ON [p].[PMReportFormTypeID] = [p0].[ID]
WHERE [p].[IsDeleted] = CAST(0 AS bit)
2026-01-03 23:13:44.153 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[ID], [p].[AttendedBy], [p].[CompletionDate], [p].[CreatedBy], [p].[CreatedDate], [p].[Customer], [p].[FormstatusID], [p].[IsDeleted], [p].[PMReportFormTypeID], [p].[ProjectNo], [p].[Remarks], [p].[ReportFormID], [p].[ReportTitle], [p].[StartDate], [p].[UpdatedBy], [p].[UpdatedDate], [p].[WitnessedBy], [f].[ID], [f].[CreatedBy], [f].[CreatedDate], [f].[IsDeleted], [f].[Name], [f].[UpdatedBy], [f].[UpdatedDate], [p0].[ID], [p0].[CreatedBy], [p0].[CreatedDate], [p0].[IsDeleted], [p0].[Name], [p0].[UpdatedBy], [p0].[UpdatedDate]
FROM [PMReportFormServer] AS [p]
INNER JOIN [FormStatusWarehouses] AS [f] ON [p].[FormstatusID] = [f].[ID]
INNER JOIN [PMReportFormTypes] AS [p0] ON [p].[PMReportFormTypeID] = [p0].[ID]
WHERE [p].[IsDeleted] = CAST(0 AS bit)
2026-01-03 23:13:44.262 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[ID], [c].[ActionTakenDescription], [c].[ApprovedBy], [c].[ArrivalDate], [c].[AttendedBy], [c].[CMReportFormTypeID], [c].[CompletionDate], [c].[CreatedBy], [c].[CreatedDate], [c].[Customer], [c].[FailureDetectedDate], [c].[FormstatusID], [c].[FurtherActionTakenID], [c].[IsDeleted], [c].[IssueFoundDescription], [c].[IssueReportedDescription], [c].[ProjectNo], [c].[Remark], [c].[ReportFormID], [c].[ReportTitle], [c].[ResponseDate], [c].[UpdatedBy], [c].[UpdatedDate], [f].[ID], [f].[CreatedBy], [f].[CreatedDate], [f].[IsDeleted], [f].[Name], [f].[UpdatedBy], [f].[UpdatedDate], [c0].[ID], [c0].[CreatedBy], [c0].[CreatedDate], [c0].[IsDeleted], [c0].[Name], [c0].[UpdatedBy], [c0].[UpdatedDate]
FROM [CMReportForms] AS [c]
INNER JOIN [FormStatusWarehouses] AS [f] ON [c].[FormstatusID] = [f].[ID]
INNER JOIN [CMReportFormTypes] AS [c0] ON [c].[CMReportFormTypeID] = [c0].[ID]
WHERE [c].[IsDeleted] = CAST(0 AS bit)
2026-01-03 23:13:44.278 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (2ms) [Parameters=[@__twelveMonthsAgo_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [r0].[Year], [r0].[Month], COUNT(*) AS [Count]
FROM (
    SELECT DATEPART(year, [r].[CreatedDate]) AS [Year], DATEPART(month, [r].[CreatedDate]) AS [Month]
    FROM [ReportForms] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[CreatedDate] >= @__twelveMonthsAgo_0
) AS [r0]
GROUP BY [r0].[Year], [r0].[Month]
ORDER BY [r0].[Year], [r0].[Month]
2026-01-03 23:14:00.378 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[ReportFormID]
FROM [PMReportFormServer] AS [p]
WHERE [p].[IsDeleted] = CAST(0 AS bit)
2026-01-03 23:14:00.611 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (8ms) [Parameters=[@__serverPMReportFormIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [ReportForms] AS [r]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[ID] IN (
    SELECT [s].[value]
    FROM OPENJSON(@__serverPMReportFormIds_0) WITH ([value] uniqueidentifier '$') AS [s]
)
2026-01-03 23:14:00.727 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (68ms) [Parameters=[@__serverPMReportFormIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[ID], [r].[CreatedBy], [r].[CreatedDate], [r].[FormStatus], [r].[IsDeleted], [r].[JobNo], [r].[ReportFormTypeID], [r].[StationNameWarehouseID], [r].[SystemNameWarehouseID], [r].[UpdatedBy], [r].[UpdatedDate], [r].[UploadHostname], [r].[UploadIPAddress], [r].[UploadStatus], [r0].[ID], [r0].[CreatedBy], [r0].[CreatedDate], [r0].[IsDeleted], [r0].[Name], [r0].[UpdatedBy], [r0].[UpdatedDate], [s0].[ID], [s0].[IsDeleted], [s0].[Name], [s1].[ID], [s1].[IsDeleted], [s1].[Name], [s1].[SystemNameWarehouseID], [u].[ID], [u].[CompanyID], [u].[CreatedBy], [u].[CreatedDate], [u].[DateOfBirth], [u].[DepartmentID], [u].[Email], [u].[EmergencyContactName], [u].[EmergencyContactNumber], [u].[EmergencyRelationship], [u].[FirstName], [u].[Gender], [u].[IsDeleted], [u].[LastLogin], [u].[LastName], [u].[LastWorkingDate], [u].[LoginPassword], [u].[MobileNo], [u].[Nationality], [u].[OccupationID], [u].[OccupationLevelID], [u].[Rating], [u].[Religion], [u].[Remark], [u].[StaffCardID], [u].[StaffRFIDCardID], [u].[StartWorkingDate], [u].[SubDepartmentID], [u].[UpdatedBy], [u].[UpdatedDate], [u].[WorkPassCardExpiredDate], [u].[WorkPassCardIssuedDate], [u].[WorkPassCardNumber], [u].[WorkPermit]
FROM [ReportForms] AS [r]
INNER JOIN [ReportFormTypes] AS [r0] ON [r].[ReportFormTypeID] = [r0].[ID]
INNER JOIN [SystemNameWarehouses] AS [s0] ON [r].[SystemNameWarehouseID] = [s0].[ID]
INNER JOIN [StationNameWarehouses] AS [s1] ON [r].[StationNameWarehouseID] = [s1].[ID]
INNER JOIN [Users] AS [u] ON [r].[CreatedBy] = [u].[ID]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[ID] IN (
    SELECT [s].[value]
    FROM OPENJSON(@__serverPMReportFormIds_0) WITH ([value] uniqueidentifier '$') AS [s]
)
2026-01-03 23:14:00.741 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[ID], [p].[ApprovedBy], [p].[AttendedBy], [p].[CleaningOfCabinet], [p].[CreatedBy], [p].[CreatedDate], [p].[Customer], [p].[DateOfService], [p].[FormstatusID], [p].[IsDeleted], [p].[PMReportFormTypeID], [p].[ProjectNo], [p].[Remarks], [p].[ReportFormID], [p].[ReportTitle], [p].[UpdatedBy], [p].[UpdatedDate], [f].[ID], [f].[CreatedBy], [f].[CreatedDate], [f].[IsDeleted], [f].[Name], [f].[UpdatedBy], [f].[UpdatedDate], [p0].[ID], [p0].[CreatedBy], [p0].[CreatedDate], [p0].[IsDeleted], [p0].[Name], [p0].[UpdatedBy], [p0].[UpdatedDate]
FROM [PMReportFormRTU] AS [p]
INNER JOIN [FormStatusWarehouses] AS [f] ON [p].[FormstatusID] = [f].[ID]
INNER JOIN [PMReportFormTypes] AS [p0] ON [p].[PMReportFormTypeID] = [p0].[ID]
WHERE [p].[IsDeleted] = CAST(0 AS bit)
2026-01-03 23:14:00.751 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[ID], [p].[AttendedBy], [p].[CompletionDate], [p].[CreatedBy], [p].[CreatedDate], [p].[Customer], [p].[FormstatusID], [p].[IsDeleted], [p].[PMReportFormTypeID], [p].[ProjectNo], [p].[Remarks], [p].[ReportFormID], [p].[ReportTitle], [p].[StartDate], [p].[UpdatedBy], [p].[UpdatedDate], [p].[WitnessedBy], [f].[ID], [f].[CreatedBy], [f].[CreatedDate], [f].[IsDeleted], [f].[Name], [f].[UpdatedBy], [f].[UpdatedDate], [p0].[ID], [p0].[CreatedBy], [p0].[CreatedDate], [p0].[IsDeleted], [p0].[Name], [p0].[UpdatedBy], [p0].[UpdatedDate]
FROM [PMReportFormServer] AS [p]
INNER JOIN [FormStatusWarehouses] AS [f] ON [p].[FormstatusID] = [f].[ID]
INNER JOIN [PMReportFormTypes] AS [p0] ON [p].[PMReportFormTypeID] = [p0].[ID]
WHERE [p].[IsDeleted] = CAST(0 AS bit)
2026-01-03 23:14:00.760 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[ID], [c].[ActionTakenDescription], [c].[ApprovedBy], [c].[ArrivalDate], [c].[AttendedBy], [c].[CMReportFormTypeID], [c].[CompletionDate], [c].[CreatedBy], [c].[CreatedDate], [c].[Customer], [c].[FailureDetectedDate], [c].[FormstatusID], [c].[FurtherActionTakenID], [c].[IsDeleted], [c].[IssueFoundDescription], [c].[IssueReportedDescription], [c].[ProjectNo], [c].[Remark], [c].[ReportFormID], [c].[ReportTitle], [c].[ResponseDate], [c].[UpdatedBy], [c].[UpdatedDate], [f].[ID], [f].[CreatedBy], [f].[CreatedDate], [f].[IsDeleted], [f].[Name], [f].[UpdatedBy], [f].[UpdatedDate], [c0].[ID], [c0].[CreatedBy], [c0].[CreatedDate], [c0].[IsDeleted], [c0].[Name], [c0].[UpdatedBy], [c0].[UpdatedDate]
FROM [CMReportForms] AS [c]
INNER JOIN [FormStatusWarehouses] AS [f] ON [c].[FormstatusID] = [f].[ID]
INNER JOIN [CMReportFormTypes] AS [c0] ON [c].[CMReportFormTypeID] = [c0].[ID]
WHERE [c].[IsDeleted] = CAST(0 AS bit)
2026-01-03 23:14:00.773 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (3ms) [Parameters=[@__twelveMonthsAgo_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [r0].[Year], [r0].[Month], COUNT(*) AS [Count]
FROM (
    SELECT DATEPART(year, [r].[CreatedDate]) AS [Year], DATEPART(month, [r].[CreatedDate]) AS [Month]
    FROM [ReportForms] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[CreatedDate] >= @__twelveMonthsAgo_0
) AS [r0]
GROUP BY [r0].[Year], [r0].[Month]
ORDER BY [r0].[Year], [r0].[Month]
2026-01-03 23:14:11.931 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (14ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[ReportFormID]
FROM [PMReportFormServer] AS [p]
WHERE [p].[IsDeleted] = CAST(0 AS bit)
2026-01-03 23:14:12.317 [ERR] Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware - An unhandled exception has occurred while executing the request.
System.InvalidOperationException: The LINQ expression 'DbSet<ReportForm>()
    .Where(r => !(r.IsDeleted))
    .Where(r => __serverPMReportFormIds_0
        .Contains(r.ID))
    .LeftJoin(
        inner: DbSet<PMReportFormRTU>()
            .Where(p => !(p.IsDeleted)), 
        outerKeySelector: r => (object)r.ID, 
        innerKeySelector: p => (object)p.ReportFormID, 
        resultSelector: (r, p) => new TransparentIdentifier<ReportForm, PMReportFormRTU>(
            Outer = r, 
            Inner = p
        ))
    .LeftJoin(
        inner: DbSet<PMReportFormServer>()
            .Where(p0 => !(p0.IsDeleted)), 
        outerKeySelector: ti => (object)ti.Outer.ID, 
        innerKeySelector: p0 => (object)p0.ReportFormID, 
        resultSelector: (ti, p0) => new TransparentIdentifier<TransparentIdentifier<ReportForm, PMReportFormRTU>, PMReportFormServer>(
            Outer = ti, 
            Inner = p0
        ))
    .LeftJoin(
        inner: DbSet<CMReportForm>()
            .Where(c => !(c.IsDeleted)), 
        outerKeySelector: ti0 => (object)ti0.Outer.Outer.ID, 
        innerKeySelector: c => (object)c.ReportFormID, 
        resultSelector: (ti0, c) => new TransparentIdentifier<TransparentIdentifier<TransparentIdentifier<ReportForm, PMReportFormRTU>, PMReportFormServer>, CMReportForm>(
            Outer = ti0, 
            Inner = c
        ))
    .LeftJoin(
        inner: DbSet<FormStatusWarehouse>(), 
        outerKeySelector: ti1 => EF.Property<Guid?>(ti1.Outer.Outer.Inner, "FormstatusID"), 
        innerKeySelector: f => EF.Property<Guid?>(f, "ID"), 
        resultSelector: (o, i) => new TransparentIdentifier<TransparentIdentifier<TransparentIdentifier<TransparentIdentifier<ReportForm, PMReportFormRTU>, PMReportFormServer>, CMReportForm>, FormStatusWarehouse>(
            Outer = o, 
            Inner = i
        ))
    .LeftJoin(
        inner: DbSet<FormStatusWarehouse>(), 
        outerKeySelector: ti1 => EF.Property<Guid?>(ti1.Outer.Outer.Inner, "FormstatusID"), 
        innerKeySelector: f0 => EF.Property<Guid?>(f0, "ID"), 
        resultSelector: (o, i) => new TransparentIdentifier<TransparentIdentifier<TransparentIdentifier<TransparentIdentifier<TransparentIdentifier<ReportForm, PMReportFormRTU>, PMReportFormServer>, CMReportForm>, FormStatusWarehouse>, FormStatusWarehouse>(
            Outer = o, 
            Inner = i
        ))
    .LeftJoin(
        inner: DbSet<FormStatusWarehouse>(), 
        outerKeySelector: ti1 => EF.Property<Guid?>(ti1.Outer.Outer.Inner, "FormstatusID"), 
        innerKeySelector: f1 => EF.Property<Guid?>(f1, "ID"), 
        resultSelector: (o, i) => new TransparentIdentifier<TransparentIdentifier<TransparentIdentifier<TransparentIdentifier<TransparentIdentifier<TransparentIdentifier<ReportForm, PMReportFormRTU>, PMReportFormServer>, CMReportForm>, FormStatusWarehouse>, FormStatusWarehouse>, FormStatusWarehouse>(
            Outer = o, 
            Inner = i
        ))
    .Where(ti1 => ti1.Outer.Outer.Inner.Name != null && ti1.Outer.Outer.Inner.Name.Equals(
        value: __formStatus_1, 
        comparisonType: OrdinalIgnoreCase) || ti1.Outer.Inner.Name != null && ti1.Outer.Inner.Name.Equals(
        value: __formStatus_1, 
        comparisonType: OrdinalIgnoreCase) || ti1.Inner.Name != null && ti1.Inner.Name.Equals(
        value: __formStatus_1, 
        comparisonType: OrdinalIgnoreCase) || ti1.Outer.Outer.Inner.Name == null && ti1.Outer.Inner.Name == null && ti1.Inner.Name == null && ti1.Outer.Outer.Outer.Outer.Outer.Outer.FormStatus != null && ti1.Outer.Outer.Outer.Outer.Outer.Outer.FormStatus.Equals(
        value: __formStatus_1, 
        comparisonType: OrdinalIgnoreCase))' could not be translated. Additional information: Translation of the 'string.Equals' overload with a 'StringComparison' parameter is not supported. See https://go.microsoft.com/fwlink/?linkid=2129535 for more information.
Translation of the 'string.Equals' overload with a 'StringComparison' parameter is not supported. See https://go.microsoft.com/fwlink/?linkid=2129535 for more information.
Translation of the 'string.Equals' overload with a 'StringComparison' parameter is not supported. See https://go.microsoft.com/fwlink/?linkid=2129535 for more information.
Translation of the 'string.Equals' overload with a 'StringComparison' parameter is not supported. See https://go.microsoft.com/fwlink/?linkid=2129535 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ExecuteAsync[TSource,TResult](MethodInfo operatorMethodInfo, IQueryable`1 source, Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ExecuteAsync[TSource,TResult](MethodInfo operatorMethodInfo, IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.CountAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at ControlTower.Controllers.ReportManagementSystem.ReportFormController.GetDashboardStatistics(Nullable`1 startDate, Nullable`1 endDate, Nullable`1 reportFormTypeId, String formStatus, String specificType) in C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower\ControlTower\Controllers\ReportManagementSystem\ReportFormController.cs:line 1185
   at lambda_method9(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2026-01-03 23:19:06.226 [INF]  - Starting ControlTower API
2026-01-03 23:19:09.340 [INF] Microsoft.Hosting.Lifetime - Now listening on: https://localhost:7145
2026-01-03 23:19:11.635 [INF] Microsoft.Hosting.Lifetime - Application started. Press Ctrl+C to shut down.
2026-01-03 23:19:11.941 [INF] Microsoft.Hosting.Lifetime - Hosting environment: Development
2026-01-03 23:19:12.192 [INF] Microsoft.Hosting.Lifetime - Content root path: C:\Users\thanthtet.myet\Documents\01_Willowglen\B_001_Workplace\ControlTower\ControlTower\ControlTower
2026-01-03 23:21:00.117 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (155ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[ID], [r].[Name], [r].[IsDeleted], [r].[CreatedDate], [r].[UpdatedDate], [r].[CreatedBy], [r].[UpdatedBy], CASE
    WHEN [u].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u].[FirstName], [u].[LastName], CASE
    WHEN [u0].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u0].[FirstName], [u0].[LastName]
FROM [ReportFormTypes] AS [r]
LEFT JOIN [Users] AS [u] ON [r].[CreatedBy] = [u].[ID]
LEFT JOIN [Users] AS [u0] ON [r].[UpdatedBy] = [u0].[ID]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 23:21:00.101 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (155ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [ReportForms] AS [r]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 23:21:00.100 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (159ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [ReportForms] AS [r]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 23:21:00.106 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (155ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[ID], [r].[Name], [r].[IsDeleted], [r].[CreatedDate], [r].[UpdatedDate], [r].[CreatedBy], [r].[UpdatedBy], CASE
    WHEN [u].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u].[FirstName], [u].[LastName], CASE
    WHEN [u0].[ID] IS NOT NULL THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END, [u0].[FirstName], [u0].[LastName]
FROM [ReportFormTypes] AS [r]
LEFT JOIN [Users] AS [u] ON [r].[CreatedBy] = [u].[ID]
LEFT JOIN [Users] AS [u0] ON [r].[UpdatedBy] = [u0].[ID]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 23:21:01.525 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (66ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[ID], [r].[CreatedBy], [r].[CreatedDate], [r].[FormStatus], [r].[IsDeleted], [r].[JobNo], [r].[ReportFormTypeID], [r].[StationNameWarehouseID], [r].[SystemNameWarehouseID], [r].[UpdatedBy], [r].[UpdatedDate], [r].[UploadHostname], [r].[UploadIPAddress], [r].[UploadStatus], [r0].[ID], [r0].[CreatedBy], [r0].[CreatedDate], [r0].[IsDeleted], [r0].[Name], [r0].[UpdatedBy], [r0].[UpdatedDate], [s].[ID], [s].[IsDeleted], [s].[Name], [s0].[ID], [s0].[IsDeleted], [s0].[Name], [s0].[SystemNameWarehouseID], [u].[ID], [u].[CompanyID], [u].[CreatedBy], [u].[CreatedDate], [u].[DateOfBirth], [u].[DepartmentID], [u].[Email], [u].[EmergencyContactName], [u].[EmergencyContactNumber], [u].[EmergencyRelationship], [u].[FirstName], [u].[Gender], [u].[IsDeleted], [u].[LastLogin], [u].[LastName], [u].[LastWorkingDate], [u].[LoginPassword], [u].[MobileNo], [u].[Nationality], [u].[OccupationID], [u].[OccupationLevelID], [u].[Rating], [u].[Religion], [u].[Remark], [u].[StaffCardID], [u].[StaffRFIDCardID], [u].[StartWorkingDate], [u].[SubDepartmentID], [u].[UpdatedBy], [u].[UpdatedDate], [u].[WorkPassCardExpiredDate], [u].[WorkPassCardIssuedDate], [u].[WorkPassCardNumber], [u].[WorkPermit]
FROM [ReportForms] AS [r]
INNER JOIN [ReportFormTypes] AS [r0] ON [r].[ReportFormTypeID] = [r0].[ID]
INNER JOIN [SystemNameWarehouses] AS [s] ON [r].[SystemNameWarehouseID] = [s].[ID]
INNER JOIN [StationNameWarehouses] AS [s0] ON [r].[StationNameWarehouseID] = [s0].[ID]
INNER JOIN [Users] AS [u] ON [r].[CreatedBy] = [u].[ID]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 23:21:01.525 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (66ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[ID], [r].[CreatedBy], [r].[CreatedDate], [r].[FormStatus], [r].[IsDeleted], [r].[JobNo], [r].[ReportFormTypeID], [r].[StationNameWarehouseID], [r].[SystemNameWarehouseID], [r].[UpdatedBy], [r].[UpdatedDate], [r].[UploadHostname], [r].[UploadIPAddress], [r].[UploadStatus], [r0].[ID], [r0].[CreatedBy], [r0].[CreatedDate], [r0].[IsDeleted], [r0].[Name], [r0].[UpdatedBy], [r0].[UpdatedDate], [s].[ID], [s].[IsDeleted], [s].[Name], [s0].[ID], [s0].[IsDeleted], [s0].[Name], [s0].[SystemNameWarehouseID], [u].[ID], [u].[CompanyID], [u].[CreatedBy], [u].[CreatedDate], [u].[DateOfBirth], [u].[DepartmentID], [u].[Email], [u].[EmergencyContactName], [u].[EmergencyContactNumber], [u].[EmergencyRelationship], [u].[FirstName], [u].[Gender], [u].[IsDeleted], [u].[LastLogin], [u].[LastName], [u].[LastWorkingDate], [u].[LoginPassword], [u].[MobileNo], [u].[Nationality], [u].[OccupationID], [u].[OccupationLevelID], [u].[Rating], [u].[Religion], [u].[Remark], [u].[StaffCardID], [u].[StaffRFIDCardID], [u].[StartWorkingDate], [u].[SubDepartmentID], [u].[UpdatedBy], [u].[UpdatedDate], [u].[WorkPassCardExpiredDate], [u].[WorkPassCardIssuedDate], [u].[WorkPassCardNumber], [u].[WorkPermit]
FROM [ReportForms] AS [r]
INNER JOIN [ReportFormTypes] AS [r0] ON [r].[ReportFormTypeID] = [r0].[ID]
INNER JOIN [SystemNameWarehouses] AS [s] ON [r].[SystemNameWarehouseID] = [s].[ID]
INNER JOIN [StationNameWarehouses] AS [s0] ON [r].[StationNameWarehouseID] = [s0].[ID]
INNER JOIN [Users] AS [u] ON [r].[CreatedBy] = [u].[ID]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
2026-01-03 23:21:08.352 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (83ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[ID], [p].[ApprovedBy], [p].[AttendedBy], [p].[CleaningOfCabinet], [p].[CreatedBy], [p].[CreatedDate], [p].[Customer], [p].[DateOfService], [p].[FormstatusID], [p].[IsDeleted], [p].[PMReportFormTypeID], [p].[ProjectNo], [p].[Remarks], [p].[ReportFormID], [p].[ReportTitle], [p].[UpdatedBy], [p].[UpdatedDate], [f].[ID], [f].[CreatedBy], [f].[CreatedDate], [f].[IsDeleted], [f].[Name], [f].[UpdatedBy], [f].[UpdatedDate], [p0].[ID], [p0].[CreatedBy], [p0].[CreatedDate], [p0].[IsDeleted], [p0].[Name], [p0].[UpdatedBy], [p0].[UpdatedDate]
FROM [PMReportFormRTU] AS [p]
INNER JOIN [FormStatusWarehouses] AS [f] ON [p].[FormstatusID] = [f].[ID]
INNER JOIN [PMReportFormTypes] AS [p0] ON [p].[PMReportFormTypeID] = [p0].[ID]
WHERE [p].[IsDeleted] = CAST(0 AS bit)
2026-01-03 23:21:08.375 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (23ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[ID], [p].[ApprovedBy], [p].[AttendedBy], [p].[CleaningOfCabinet], [p].[CreatedBy], [p].[CreatedDate], [p].[Customer], [p].[DateOfService], [p].[FormstatusID], [p].[IsDeleted], [p].[PMReportFormTypeID], [p].[ProjectNo], [p].[Remarks], [p].[ReportFormID], [p].[ReportTitle], [p].[UpdatedBy], [p].[UpdatedDate], [f].[ID], [f].[CreatedBy], [f].[CreatedDate], [f].[IsDeleted], [f].[Name], [f].[UpdatedBy], [f].[UpdatedDate], [p0].[ID], [p0].[CreatedBy], [p0].[CreatedDate], [p0].[IsDeleted], [p0].[Name], [p0].[UpdatedBy], [p0].[UpdatedDate]
FROM [PMReportFormRTU] AS [p]
INNER JOIN [FormStatusWarehouses] AS [f] ON [p].[FormstatusID] = [f].[ID]
INNER JOIN [PMReportFormTypes] AS [p0] ON [p].[PMReportFormTypeID] = [p0].[ID]
WHERE [p].[IsDeleted] = CAST(0 AS bit)
2026-01-03 23:21:09.459 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (107ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[ID], [p].[AttendedBy], [p].[CompletionDate], [p].[CreatedBy], [p].[CreatedDate], [p].[Customer], [p].[FormstatusID], [p].[IsDeleted], [p].[PMReportFormTypeID], [p].[ProjectNo], [p].[Remarks], [p].[ReportFormID], [p].[ReportTitle], [p].[StartDate], [p].[UpdatedBy], [p].[UpdatedDate], [p].[WitnessedBy], [f].[ID], [f].[CreatedBy], [f].[CreatedDate], [f].[IsDeleted], [f].[Name], [f].[UpdatedBy], [f].[UpdatedDate], [p0].[ID], [p0].[CreatedBy], [p0].[CreatedDate], [p0].[IsDeleted], [p0].[Name], [p0].[UpdatedBy], [p0].[UpdatedDate]
FROM [PMReportFormServer] AS [p]
INNER JOIN [FormStatusWarehouses] AS [f] ON [p].[FormstatusID] = [f].[ID]
INNER JOIN [PMReportFormTypes] AS [p0] ON [p].[PMReportFormTypeID] = [p0].[ID]
WHERE [p].[IsDeleted] = CAST(0 AS bit)
2026-01-03 23:21:09.466 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (115ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[ID], [p].[AttendedBy], [p].[CompletionDate], [p].[CreatedBy], [p].[CreatedDate], [p].[Customer], [p].[FormstatusID], [p].[IsDeleted], [p].[PMReportFormTypeID], [p].[ProjectNo], [p].[Remarks], [p].[ReportFormID], [p].[ReportTitle], [p].[StartDate], [p].[UpdatedBy], [p].[UpdatedDate], [p].[WitnessedBy], [f].[ID], [f].[CreatedBy], [f].[CreatedDate], [f].[IsDeleted], [f].[Name], [f].[UpdatedBy], [f].[UpdatedDate], [p0].[ID], [p0].[CreatedBy], [p0].[CreatedDate], [p0].[IsDeleted], [p0].[Name], [p0].[UpdatedBy], [p0].[UpdatedDate]
FROM [PMReportFormServer] AS [p]
INNER JOIN [FormStatusWarehouses] AS [f] ON [p].[FormstatusID] = [f].[ID]
INNER JOIN [PMReportFormTypes] AS [p0] ON [p].[PMReportFormTypeID] = [p0].[ID]
WHERE [p].[IsDeleted] = CAST(0 AS bit)
2026-01-03 23:21:12.567 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[ID], [c].[ActionTakenDescription], [c].[ApprovedBy], [c].[ArrivalDate], [c].[AttendedBy], [c].[CMReportFormTypeID], [c].[CompletionDate], [c].[CreatedBy], [c].[CreatedDate], [c].[Customer], [c].[FailureDetectedDate], [c].[FormstatusID], [c].[FurtherActionTakenID], [c].[IsDeleted], [c].[IssueFoundDescription], [c].[IssueReportedDescription], [c].[ProjectNo], [c].[Remark], [c].[ReportFormID], [c].[ReportTitle], [c].[ResponseDate], [c].[UpdatedBy], [c].[UpdatedDate], [f].[ID], [f].[CreatedBy], [f].[CreatedDate], [f].[IsDeleted], [f].[Name], [f].[UpdatedBy], [f].[UpdatedDate], [c0].[ID], [c0].[CreatedBy], [c0].[CreatedDate], [c0].[IsDeleted], [c0].[Name], [c0].[UpdatedBy], [c0].[UpdatedDate]
FROM [CMReportForms] AS [c]
INNER JOIN [FormStatusWarehouses] AS [f] ON [c].[FormstatusID] = [f].[ID]
INNER JOIN [CMReportFormTypes] AS [c0] ON [c].[CMReportFormTypeID] = [c0].[ID]
WHERE [c].[IsDeleted] = CAST(0 AS bit)
2026-01-03 23:21:12.567 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[ID], [c].[ActionTakenDescription], [c].[ApprovedBy], [c].[ArrivalDate], [c].[AttendedBy], [c].[CMReportFormTypeID], [c].[CompletionDate], [c].[CreatedBy], [c].[CreatedDate], [c].[Customer], [c].[FailureDetectedDate], [c].[FormstatusID], [c].[FurtherActionTakenID], [c].[IsDeleted], [c].[IssueFoundDescription], [c].[IssueReportedDescription], [c].[ProjectNo], [c].[Remark], [c].[ReportFormID], [c].[ReportTitle], [c].[ResponseDate], [c].[UpdatedBy], [c].[UpdatedDate], [f].[ID], [f].[CreatedBy], [f].[CreatedDate], [f].[IsDeleted], [f].[Name], [f].[UpdatedBy], [f].[UpdatedDate], [c0].[ID], [c0].[CreatedBy], [c0].[CreatedDate], [c0].[IsDeleted], [c0].[Name], [c0].[UpdatedBy], [c0].[UpdatedDate]
FROM [CMReportForms] AS [c]
INNER JOIN [FormStatusWarehouses] AS [f] ON [c].[FormstatusID] = [f].[ID]
INNER JOIN [CMReportFormTypes] AS [c0] ON [c].[CMReportFormTypeID] = [c0].[ID]
WHERE [c].[IsDeleted] = CAST(0 AS bit)
2026-01-03 23:21:14.473 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (468ms) [Parameters=[@__twelveMonthsAgo_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [r0].[Year], [r0].[Month], COUNT(*) AS [Count]
FROM (
    SELECT DATEPART(year, [r].[CreatedDate]) AS [Year], DATEPART(month, [r].[CreatedDate]) AS [Month]
    FROM [ReportForms] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[CreatedDate] >= @__twelveMonthsAgo_0
) AS [r0]
GROUP BY [r0].[Year], [r0].[Month]
ORDER BY [r0].[Year], [r0].[Month]
2026-01-03 23:21:14.473 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (467ms) [Parameters=[@__twelveMonthsAgo_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [r0].[Year], [r0].[Month], COUNT(*) AS [Count]
FROM (
    SELECT DATEPART(year, [r].[CreatedDate]) AS [Year], DATEPART(month, [r].[CreatedDate]) AS [Month]
    FROM [ReportForms] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[CreatedDate] >= @__twelveMonthsAgo_0
) AS [r0]
GROUP BY [r0].[Year], [r0].[Month]
ORDER BY [r0].[Year], [r0].[Month]
2026-01-03 23:21:25.257 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (392ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[ReportFormID]
FROM [PMReportFormServer] AS [p]
WHERE [p].[IsDeleted] = CAST(0 AS bit)
2026-01-03 23:21:28.060 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (487ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[ReportFormID]
FROM [PMReportFormServer] AS [p]
WHERE [p].[IsDeleted] = CAST(0 AS bit)
2026-01-03 23:21:29.828 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (140ms) [Parameters=[@__serverPMReportFormIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[ID]
FROM [ReportForms] AS [r]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[ID] IN (
    SELECT [s].[value]
    FROM OPENJSON(@__serverPMReportFormIds_0) WITH ([value] uniqueidentifier '$') AS [s]
)
2026-01-03 23:21:29.834 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (33ms) [Parameters=[@__serverPMReportFormIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [ReportForms] AS [r]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[ID] IN (
    SELECT [s].[value]
    FROM OPENJSON(@__serverPMReportFormIds_0) WITH ([value] uniqueidentifier '$') AS [s]
)
2026-01-03 23:21:30.550 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (66ms) [Parameters=[@__allReportFormIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[ReportFormID], [f].[Name] AS [Status]
FROM [PMReportFormRTU] AS [p]
INNER JOIN [FormStatusWarehouses] AS [f] ON [p].[FormstatusID] = [f].[ID]
WHERE [p].[IsDeleted] = CAST(0 AS bit) AND [p].[ReportFormID] IN (
    SELECT [a].[value]
    FROM OPENJSON(@__allReportFormIds_0) WITH ([value] uniqueidentifier '$') AS [a]
)
2026-01-03 23:21:30.803 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (54ms) [Parameters=[@__allReportFormIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[ReportFormID], [f].[Name] AS [Status]
FROM [PMReportFormServer] AS [p]
INNER JOIN [FormStatusWarehouses] AS [f] ON [p].[FormstatusID] = [f].[ID]
WHERE [p].[IsDeleted] = CAST(0 AS bit) AND [p].[ReportFormID] IN (
    SELECT [a].[value]
    FROM OPENJSON(@__allReportFormIds_0) WITH ([value] uniqueidentifier '$') AS [a]
)
2026-01-03 23:21:30.943 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (116ms) [Parameters=[@__serverPMReportFormIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[ID], [r].[CreatedBy], [r].[CreatedDate], [r].[FormStatus], [r].[IsDeleted], [r].[JobNo], [r].[ReportFormTypeID], [r].[StationNameWarehouseID], [r].[SystemNameWarehouseID], [r].[UpdatedBy], [r].[UpdatedDate], [r].[UploadHostname], [r].[UploadIPAddress], [r].[UploadStatus], [r0].[ID], [r0].[CreatedBy], [r0].[CreatedDate], [r0].[IsDeleted], [r0].[Name], [r0].[UpdatedBy], [r0].[UpdatedDate], [s0].[ID], [s0].[IsDeleted], [s0].[Name], [s1].[ID], [s1].[IsDeleted], [s1].[Name], [s1].[SystemNameWarehouseID], [u].[ID], [u].[CompanyID], [u].[CreatedBy], [u].[CreatedDate], [u].[DateOfBirth], [u].[DepartmentID], [u].[Email], [u].[EmergencyContactName], [u].[EmergencyContactNumber], [u].[EmergencyRelationship], [u].[FirstName], [u].[Gender], [u].[IsDeleted], [u].[LastLogin], [u].[LastName], [u].[LastWorkingDate], [u].[LoginPassword], [u].[MobileNo], [u].[Nationality], [u].[OccupationID], [u].[OccupationLevelID], [u].[Rating], [u].[Religion], [u].[Remark], [u].[StaffCardID], [u].[StaffRFIDCardID], [u].[StartWorkingDate], [u].[SubDepartmentID], [u].[UpdatedBy], [u].[UpdatedDate], [u].[WorkPassCardExpiredDate], [u].[WorkPassCardIssuedDate], [u].[WorkPassCardNumber], [u].[WorkPermit]
FROM [ReportForms] AS [r]
INNER JOIN [ReportFormTypes] AS [r0] ON [r].[ReportFormTypeID] = [r0].[ID]
INNER JOIN [SystemNameWarehouses] AS [s0] ON [r].[SystemNameWarehouseID] = [s0].[ID]
INNER JOIN [StationNameWarehouses] AS [s1] ON [r].[StationNameWarehouseID] = [s1].[ID]
INNER JOIN [Users] AS [u] ON [r].[CreatedBy] = [u].[ID]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[ID] IN (
    SELECT [s].[value]
    FROM OPENJSON(@__serverPMReportFormIds_0) WITH ([value] uniqueidentifier '$') AS [s]
)
2026-01-03 23:21:31.527 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (56ms) [Parameters=[@__allReportFormIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[ReportFormID], [f].[Name] AS [Status]
FROM [CMReportForms] AS [c]
INNER JOIN [FormStatusWarehouses] AS [f] ON [c].[FormstatusID] = [f].[ID]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[ReportFormID] IN (
    SELECT [a].[value]
    FROM OPENJSON(@__allReportFormIds_0) WITH ([value] uniqueidentifier '$') AS [a]
)
2026-01-03 23:21:31.903 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (65ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[ID], [p].[ApprovedBy], [p].[AttendedBy], [p].[CleaningOfCabinet], [p].[CreatedBy], [p].[CreatedDate], [p].[Customer], [p].[DateOfService], [p].[FormstatusID], [p].[IsDeleted], [p].[PMReportFormTypeID], [p].[ProjectNo], [p].[Remarks], [p].[ReportFormID], [p].[ReportTitle], [p].[UpdatedBy], [p].[UpdatedDate], [f].[ID], [f].[CreatedBy], [f].[CreatedDate], [f].[IsDeleted], [f].[Name], [f].[UpdatedBy], [f].[UpdatedDate], [p0].[ID], [p0].[CreatedBy], [p0].[CreatedDate], [p0].[IsDeleted], [p0].[Name], [p0].[UpdatedBy], [p0].[UpdatedDate]
FROM [PMReportFormRTU] AS [p]
INNER JOIN [FormStatusWarehouses] AS [f] ON [p].[FormstatusID] = [f].[ID]
INNER JOIN [PMReportFormTypes] AS [p0] ON [p].[PMReportFormTypeID] = [p0].[ID]
WHERE [p].[IsDeleted] = CAST(0 AS bit)
2026-01-03 23:21:32.038 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (18ms) [Parameters=[@__serverPMReportFormIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[ID], [r].[FormStatus]
FROM [ReportForms] AS [r]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[ID] IN (
    SELECT [s].[value]
    FROM OPENJSON(@__serverPMReportFormIds_0) WITH ([value] uniqueidentifier '$') AS [s]
)
2026-01-03 23:21:32.104 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (55ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[ID], [p].[AttendedBy], [p].[CompletionDate], [p].[CreatedBy], [p].[CreatedDate], [p].[Customer], [p].[FormstatusID], [p].[IsDeleted], [p].[PMReportFormTypeID], [p].[ProjectNo], [p].[Remarks], [p].[ReportFormID], [p].[ReportTitle], [p].[StartDate], [p].[UpdatedBy], [p].[UpdatedDate], [p].[WitnessedBy], [f].[ID], [f].[CreatedBy], [f].[CreatedDate], [f].[IsDeleted], [f].[Name], [f].[UpdatedBy], [f].[UpdatedDate], [p0].[ID], [p0].[CreatedBy], [p0].[CreatedDate], [p0].[IsDeleted], [p0].[Name], [p0].[UpdatedBy], [p0].[UpdatedDate]
FROM [PMReportFormServer] AS [p]
INNER JOIN [FormStatusWarehouses] AS [f] ON [p].[FormstatusID] = [f].[ID]
INNER JOIN [PMReportFormTypes] AS [p0] ON [p].[PMReportFormTypeID] = [p0].[ID]
WHERE [p].[IsDeleted] = CAST(0 AS bit)
2026-01-03 23:21:32.221 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (40ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[ID], [c].[ActionTakenDescription], [c].[ApprovedBy], [c].[ArrivalDate], [c].[AttendedBy], [c].[CMReportFormTypeID], [c].[CompletionDate], [c].[CreatedBy], [c].[CreatedDate], [c].[Customer], [c].[FailureDetectedDate], [c].[FormstatusID], [c].[FurtherActionTakenID], [c].[IsDeleted], [c].[IssueFoundDescription], [c].[IssueReportedDescription], [c].[ProjectNo], [c].[Remark], [c].[ReportFormID], [c].[ReportTitle], [c].[ResponseDate], [c].[UpdatedBy], [c].[UpdatedDate], [f].[ID], [f].[CreatedBy], [f].[CreatedDate], [f].[IsDeleted], [f].[Name], [f].[UpdatedBy], [f].[UpdatedDate], [c0].[ID], [c0].[CreatedBy], [c0].[CreatedDate], [c0].[IsDeleted], [c0].[Name], [c0].[UpdatedBy], [c0].[UpdatedDate]
FROM [CMReportForms] AS [c]
INNER JOIN [FormStatusWarehouses] AS [f] ON [c].[FormstatusID] = [f].[ID]
INNER JOIN [CMReportFormTypes] AS [c0] ON [c].[CMReportFormTypeID] = [c0].[ID]
WHERE [c].[IsDeleted] = CAST(0 AS bit)
2026-01-03 23:21:32.266 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (30ms) [Parameters=[@__serverPMReportFormIds_0='?' (Size = 4000), @__filteredReportFormIds_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [ReportForms] AS [r]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[ID] IN (
    SELECT [s].[value]
    FROM OPENJSON(@__serverPMReportFormIds_0) WITH ([value] uniqueidentifier '$') AS [s]
) AND [r].[ID] IN (
    SELECT [f].[value]
    FROM OPENJSON(@__filteredReportFormIds_1) WITH ([value] uniqueidentifier '$') AS [f]
)
2026-01-03 23:21:32.333 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (43ms) [Parameters=[@__twelveMonthsAgo_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [r0].[Year], [r0].[Month], COUNT(*) AS [Count]
FROM (
    SELECT DATEPART(year, [r].[CreatedDate]) AS [Year], DATEPART(month, [r].[CreatedDate]) AS [Month]
    FROM [ReportForms] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[CreatedDate] >= @__twelveMonthsAgo_0
) AS [r0]
GROUP BY [r0].[Year], [r0].[Month]
ORDER BY [r0].[Year], [r0].[Month]
2026-01-03 23:21:32.632 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (148ms) [Parameters=[@__serverPMReportFormIds_0='?' (Size = 4000), @__filteredReportFormIds_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[ID], [r].[CreatedBy], [r].[CreatedDate], [r].[FormStatus], [r].[IsDeleted], [r].[JobNo], [r].[ReportFormTypeID], [r].[StationNameWarehouseID], [r].[SystemNameWarehouseID], [r].[UpdatedBy], [r].[UpdatedDate], [r].[UploadHostname], [r].[UploadIPAddress], [r].[UploadStatus], [r0].[ID], [r0].[CreatedBy], [r0].[CreatedDate], [r0].[IsDeleted], [r0].[Name], [r0].[UpdatedBy], [r0].[UpdatedDate], [s0].[ID], [s0].[IsDeleted], [s0].[Name], [s1].[ID], [s1].[IsDeleted], [s1].[Name], [s1].[SystemNameWarehouseID], [u].[ID], [u].[CompanyID], [u].[CreatedBy], [u].[CreatedDate], [u].[DateOfBirth], [u].[DepartmentID], [u].[Email], [u].[EmergencyContactName], [u].[EmergencyContactNumber], [u].[EmergencyRelationship], [u].[FirstName], [u].[Gender], [u].[IsDeleted], [u].[LastLogin], [u].[LastName], [u].[LastWorkingDate], [u].[LoginPassword], [u].[MobileNo], [u].[Nationality], [u].[OccupationID], [u].[OccupationLevelID], [u].[Rating], [u].[Religion], [u].[Remark], [u].[StaffCardID], [u].[StaffRFIDCardID], [u].[StartWorkingDate], [u].[SubDepartmentID], [u].[UpdatedBy], [u].[UpdatedDate], [u].[WorkPassCardExpiredDate], [u].[WorkPassCardIssuedDate], [u].[WorkPassCardNumber], [u].[WorkPermit]
FROM [ReportForms] AS [r]
INNER JOIN [ReportFormTypes] AS [r0] ON [r].[ReportFormTypeID] = [r0].[ID]
INNER JOIN [SystemNameWarehouses] AS [s0] ON [r].[SystemNameWarehouseID] = [s0].[ID]
INNER JOIN [StationNameWarehouses] AS [s1] ON [r].[StationNameWarehouseID] = [s1].[ID]
INNER JOIN [Users] AS [u] ON [r].[CreatedBy] = [u].[ID]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[ID] IN (
    SELECT [s].[value]
    FROM OPENJSON(@__serverPMReportFormIds_0) WITH ([value] uniqueidentifier '$') AS [s]
) AND [r].[ID] IN (
    SELECT [f].[value]
    FROM OPENJSON(@__filteredReportFormIds_1) WITH ([value] uniqueidentifier '$') AS [f]
)
2026-01-03 23:21:32.722 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[ID], [p].[ApprovedBy], [p].[AttendedBy], [p].[CleaningOfCabinet], [p].[CreatedBy], [p].[CreatedDate], [p].[Customer], [p].[DateOfService], [p].[FormstatusID], [p].[IsDeleted], [p].[PMReportFormTypeID], [p].[ProjectNo], [p].[Remarks], [p].[ReportFormID], [p].[ReportTitle], [p].[UpdatedBy], [p].[UpdatedDate], [f].[ID], [f].[CreatedBy], [f].[CreatedDate], [f].[IsDeleted], [f].[Name], [f].[UpdatedBy], [f].[UpdatedDate], [p0].[ID], [p0].[CreatedBy], [p0].[CreatedDate], [p0].[IsDeleted], [p0].[Name], [p0].[UpdatedBy], [p0].[UpdatedDate]
FROM [PMReportFormRTU] AS [p]
INNER JOIN [FormStatusWarehouses] AS [f] ON [p].[FormstatusID] = [f].[ID]
INNER JOIN [PMReportFormTypes] AS [p0] ON [p].[PMReportFormTypeID] = [p0].[ID]
WHERE [p].[IsDeleted] = CAST(0 AS bit)
2026-01-03 23:21:32.737 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[ID], [p].[AttendedBy], [p].[CompletionDate], [p].[CreatedBy], [p].[CreatedDate], [p].[Customer], [p].[FormstatusID], [p].[IsDeleted], [p].[PMReportFormTypeID], [p].[ProjectNo], [p].[Remarks], [p].[ReportFormID], [p].[ReportTitle], [p].[StartDate], [p].[UpdatedBy], [p].[UpdatedDate], [p].[WitnessedBy], [f].[ID], [f].[CreatedBy], [f].[CreatedDate], [f].[IsDeleted], [f].[Name], [f].[UpdatedBy], [f].[UpdatedDate], [p0].[ID], [p0].[CreatedBy], [p0].[CreatedDate], [p0].[IsDeleted], [p0].[Name], [p0].[UpdatedBy], [p0].[UpdatedDate]
FROM [PMReportFormServer] AS [p]
INNER JOIN [FormStatusWarehouses] AS [f] ON [p].[FormstatusID] = [f].[ID]
INNER JOIN [PMReportFormTypes] AS [p0] ON [p].[PMReportFormTypeID] = [p0].[ID]
WHERE [p].[IsDeleted] = CAST(0 AS bit)
2026-01-03 23:21:32.752 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[ID], [c].[ActionTakenDescription], [c].[ApprovedBy], [c].[ArrivalDate], [c].[AttendedBy], [c].[CMReportFormTypeID], [c].[CompletionDate], [c].[CreatedBy], [c].[CreatedDate], [c].[Customer], [c].[FailureDetectedDate], [c].[FormstatusID], [c].[FurtherActionTakenID], [c].[IsDeleted], [c].[IssueFoundDescription], [c].[IssueReportedDescription], [c].[ProjectNo], [c].[Remark], [c].[ReportFormID], [c].[ReportTitle], [c].[ResponseDate], [c].[UpdatedBy], [c].[UpdatedDate], [f].[ID], [f].[CreatedBy], [f].[CreatedDate], [f].[IsDeleted], [f].[Name], [f].[UpdatedBy], [f].[UpdatedDate], [c0].[ID], [c0].[CreatedBy], [c0].[CreatedDate], [c0].[IsDeleted], [c0].[Name], [c0].[UpdatedBy], [c0].[UpdatedDate]
FROM [CMReportForms] AS [c]
INNER JOIN [FormStatusWarehouses] AS [f] ON [c].[FormstatusID] = [f].[ID]
INNER JOIN [CMReportFormTypes] AS [c0] ON [c].[CMReportFormTypeID] = [c0].[ID]
WHERE [c].[IsDeleted] = CAST(0 AS bit)
2026-01-03 23:21:32.770 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (2ms) [Parameters=[@__twelveMonthsAgo_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [r0].[Year], [r0].[Month], COUNT(*) AS [Count]
FROM (
    SELECT DATEPART(year, [r].[CreatedDate]) AS [Year], DATEPART(month, [r].[CreatedDate]) AS [Month]
    FROM [ReportForms] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[CreatedDate] >= @__twelveMonthsAgo_0
) AS [r0]
GROUP BY [r0].[Year], [r0].[Month]
ORDER BY [r0].[Year], [r0].[Month]
2026-01-03 23:21:32.953 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (113ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[ReportFormID]
FROM [PMReportFormServer] AS [p]
WHERE [p].[IsDeleted] = CAST(0 AS bit)
2026-01-03 23:21:33.009 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (2ms) [Parameters=[@__serverPMReportFormIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[ID]
FROM [ReportForms] AS [r]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[ID] IN (
    SELECT [s].[value]
    FROM OPENJSON(@__serverPMReportFormIds_0) WITH ([value] uniqueidentifier '$') AS [s]
)
2026-01-03 23:21:33.024 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (2ms) [Parameters=[@__allReportFormIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[ReportFormID], [f].[Name] AS [Status]
FROM [PMReportFormRTU] AS [p]
INNER JOIN [FormStatusWarehouses] AS [f] ON [p].[FormstatusID] = [f].[ID]
WHERE [p].[IsDeleted] = CAST(0 AS bit) AND [p].[ReportFormID] IN (
    SELECT [a].[value]
    FROM OPENJSON(@__allReportFormIds_0) WITH ([value] uniqueidentifier '$') AS [a]
)
2026-01-03 23:21:33.152 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (2ms) [Parameters=[@__allReportFormIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[ReportFormID], [f].[Name] AS [Status]
FROM [PMReportFormServer] AS [p]
INNER JOIN [FormStatusWarehouses] AS [f] ON [p].[FormstatusID] = [f].[ID]
WHERE [p].[IsDeleted] = CAST(0 AS bit) AND [p].[ReportFormID] IN (
    SELECT [a].[value]
    FROM OPENJSON(@__allReportFormIds_0) WITH ([value] uniqueidentifier '$') AS [a]
)
2026-01-03 23:21:33.257 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (16ms) [Parameters=[@__allReportFormIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[ReportFormID], [f].[Name] AS [Status]
FROM [CMReportForms] AS [c]
INNER JOIN [FormStatusWarehouses] AS [f] ON [c].[FormstatusID] = [f].[ID]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[ReportFormID] IN (
    SELECT [a].[value]
    FROM OPENJSON(@__allReportFormIds_0) WITH ([value] uniqueidentifier '$') AS [a]
)
2026-01-03 23:21:33.392 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (2ms) [Parameters=[@__serverPMReportFormIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[ID], [r].[FormStatus]
FROM [ReportForms] AS [r]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[ID] IN (
    SELECT [s].[value]
    FROM OPENJSON(@__serverPMReportFormIds_0) WITH ([value] uniqueidentifier '$') AS [s]
)
2026-01-03 23:21:33.606 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (27ms) [Parameters=[@__serverPMReportFormIds_0='?' (Size = 4000), @__filteredReportFormIds_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [ReportForms] AS [r]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[ID] IN (
    SELECT [s].[value]
    FROM OPENJSON(@__serverPMReportFormIds_0) WITH ([value] uniqueidentifier '$') AS [s]
) AND [r].[ID] IN (
    SELECT [f].[value]
    FROM OPENJSON(@__filteredReportFormIds_1) WITH ([value] uniqueidentifier '$') AS [f]
)
2026-01-03 23:21:33.663 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (5ms) [Parameters=[@__serverPMReportFormIds_0='?' (Size = 4000), @__filteredReportFormIds_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[ID], [r].[CreatedBy], [r].[CreatedDate], [r].[FormStatus], [r].[IsDeleted], [r].[JobNo], [r].[ReportFormTypeID], [r].[StationNameWarehouseID], [r].[SystemNameWarehouseID], [r].[UpdatedBy], [r].[UpdatedDate], [r].[UploadHostname], [r].[UploadIPAddress], [r].[UploadStatus], [r0].[ID], [r0].[CreatedBy], [r0].[CreatedDate], [r0].[IsDeleted], [r0].[Name], [r0].[UpdatedBy], [r0].[UpdatedDate], [s0].[ID], [s0].[IsDeleted], [s0].[Name], [s1].[ID], [s1].[IsDeleted], [s1].[Name], [s1].[SystemNameWarehouseID], [u].[ID], [u].[CompanyID], [u].[CreatedBy], [u].[CreatedDate], [u].[DateOfBirth], [u].[DepartmentID], [u].[Email], [u].[EmergencyContactName], [u].[EmergencyContactNumber], [u].[EmergencyRelationship], [u].[FirstName], [u].[Gender], [u].[IsDeleted], [u].[LastLogin], [u].[LastName], [u].[LastWorkingDate], [u].[LoginPassword], [u].[MobileNo], [u].[Nationality], [u].[OccupationID], [u].[OccupationLevelID], [u].[Rating], [u].[Religion], [u].[Remark], [u].[StaffCardID], [u].[StaffRFIDCardID], [u].[StartWorkingDate], [u].[SubDepartmentID], [u].[UpdatedBy], [u].[UpdatedDate], [u].[WorkPassCardExpiredDate], [u].[WorkPassCardIssuedDate], [u].[WorkPassCardNumber], [u].[WorkPermit]
FROM [ReportForms] AS [r]
INNER JOIN [ReportFormTypes] AS [r0] ON [r].[ReportFormTypeID] = [r0].[ID]
INNER JOIN [SystemNameWarehouses] AS [s0] ON [r].[SystemNameWarehouseID] = [s0].[ID]
INNER JOIN [StationNameWarehouses] AS [s1] ON [r].[StationNameWarehouseID] = [s1].[ID]
INNER JOIN [Users] AS [u] ON [r].[CreatedBy] = [u].[ID]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[ID] IN (
    SELECT [s].[value]
    FROM OPENJSON(@__serverPMReportFormIds_0) WITH ([value] uniqueidentifier '$') AS [s]
) AND [r].[ID] IN (
    SELECT [f].[value]
    FROM OPENJSON(@__filteredReportFormIds_1) WITH ([value] uniqueidentifier '$') AS [f]
)
2026-01-03 23:21:33.818 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[ID], [p].[ApprovedBy], [p].[AttendedBy], [p].[CleaningOfCabinet], [p].[CreatedBy], [p].[CreatedDate], [p].[Customer], [p].[DateOfService], [p].[FormstatusID], [p].[IsDeleted], [p].[PMReportFormTypeID], [p].[ProjectNo], [p].[Remarks], [p].[ReportFormID], [p].[ReportTitle], [p].[UpdatedBy], [p].[UpdatedDate], [f].[ID], [f].[CreatedBy], [f].[CreatedDate], [f].[IsDeleted], [f].[Name], [f].[UpdatedBy], [f].[UpdatedDate], [p0].[ID], [p0].[CreatedBy], [p0].[CreatedDate], [p0].[IsDeleted], [p0].[Name], [p0].[UpdatedBy], [p0].[UpdatedDate]
FROM [PMReportFormRTU] AS [p]
INNER JOIN [FormStatusWarehouses] AS [f] ON [p].[FormstatusID] = [f].[ID]
INNER JOIN [PMReportFormTypes] AS [p0] ON [p].[PMReportFormTypeID] = [p0].[ID]
WHERE [p].[IsDeleted] = CAST(0 AS bit)
2026-01-03 23:21:33.827 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[ID], [p].[AttendedBy], [p].[CompletionDate], [p].[CreatedBy], [p].[CreatedDate], [p].[Customer], [p].[FormstatusID], [p].[IsDeleted], [p].[PMReportFormTypeID], [p].[ProjectNo], [p].[Remarks], [p].[ReportFormID], [p].[ReportTitle], [p].[StartDate], [p].[UpdatedBy], [p].[UpdatedDate], [p].[WitnessedBy], [f].[ID], [f].[CreatedBy], [f].[CreatedDate], [f].[IsDeleted], [f].[Name], [f].[UpdatedBy], [f].[UpdatedDate], [p0].[ID], [p0].[CreatedBy], [p0].[CreatedDate], [p0].[IsDeleted], [p0].[Name], [p0].[UpdatedBy], [p0].[UpdatedDate]
FROM [PMReportFormServer] AS [p]
INNER JOIN [FormStatusWarehouses] AS [f] ON [p].[FormstatusID] = [f].[ID]
INNER JOIN [PMReportFormTypes] AS [p0] ON [p].[PMReportFormTypeID] = [p0].[ID]
WHERE [p].[IsDeleted] = CAST(0 AS bit)
2026-01-03 23:21:33.838 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[ID], [c].[ActionTakenDescription], [c].[ApprovedBy], [c].[ArrivalDate], [c].[AttendedBy], [c].[CMReportFormTypeID], [c].[CompletionDate], [c].[CreatedBy], [c].[CreatedDate], [c].[Customer], [c].[FailureDetectedDate], [c].[FormstatusID], [c].[FurtherActionTakenID], [c].[IsDeleted], [c].[IssueFoundDescription], [c].[IssueReportedDescription], [c].[ProjectNo], [c].[Remark], [c].[ReportFormID], [c].[ReportTitle], [c].[ResponseDate], [c].[UpdatedBy], [c].[UpdatedDate], [f].[ID], [f].[CreatedBy], [f].[CreatedDate], [f].[IsDeleted], [f].[Name], [f].[UpdatedBy], [f].[UpdatedDate], [c0].[ID], [c0].[CreatedBy], [c0].[CreatedDate], [c0].[IsDeleted], [c0].[Name], [c0].[UpdatedBy], [c0].[UpdatedDate]
FROM [CMReportForms] AS [c]
INNER JOIN [FormStatusWarehouses] AS [f] ON [c].[FormstatusID] = [f].[ID]
INNER JOIN [CMReportFormTypes] AS [c0] ON [c].[CMReportFormTypeID] = [c0].[ID]
WHERE [c].[IsDeleted] = CAST(0 AS bit)
2026-01-03 23:21:33.949 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (2ms) [Parameters=[@__twelveMonthsAgo_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [r0].[Year], [r0].[Month], COUNT(*) AS [Count]
FROM (
    SELECT DATEPART(year, [r].[CreatedDate]) AS [Year], DATEPART(month, [r].[CreatedDate]) AS [Month]
    FROM [ReportForms] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[CreatedDate] >= @__twelveMonthsAgo_0
) AS [r0]
GROUP BY [r0].[Year], [r0].[Month]
ORDER BY [r0].[Year], [r0].[Month]
2026-01-03 23:21:39.978 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[ReportFormID]
FROM [PMReportFormServer] AS [p]
WHERE [p].[IsDeleted] = CAST(0 AS bit)
2026-01-03 23:21:39.995 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (2ms) [Parameters=[@__serverPMReportFormIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[ID]
FROM [ReportForms] AS [r]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[ID] IN (
    SELECT [s].[value]
    FROM OPENJSON(@__serverPMReportFormIds_0) WITH ([value] uniqueidentifier '$') AS [s]
)
2026-01-03 23:21:40.002 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (1ms) [Parameters=[@__allReportFormIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[ReportFormID], [f].[Name] AS [Status]
FROM [PMReportFormRTU] AS [p]
INNER JOIN [FormStatusWarehouses] AS [f] ON [p].[FormstatusID] = [f].[ID]
WHERE [p].[IsDeleted] = CAST(0 AS bit) AND [p].[ReportFormID] IN (
    SELECT [a].[value]
    FROM OPENJSON(@__allReportFormIds_0) WITH ([value] uniqueidentifier '$') AS [a]
)
2026-01-03 23:21:40.017 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (1ms) [Parameters=[@__allReportFormIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[ReportFormID], [f].[Name] AS [Status]
FROM [PMReportFormServer] AS [p]
INNER JOIN [FormStatusWarehouses] AS [f] ON [p].[FormstatusID] = [f].[ID]
WHERE [p].[IsDeleted] = CAST(0 AS bit) AND [p].[ReportFormID] IN (
    SELECT [a].[value]
    FROM OPENJSON(@__allReportFormIds_0) WITH ([value] uniqueidentifier '$') AS [a]
)
2026-01-03 23:21:40.028 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (2ms) [Parameters=[@__allReportFormIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[ReportFormID], [f].[Name] AS [Status]
FROM [CMReportForms] AS [c]
INNER JOIN [FormStatusWarehouses] AS [f] ON [c].[FormstatusID] = [f].[ID]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND [c].[ReportFormID] IN (
    SELECT [a].[value]
    FROM OPENJSON(@__allReportFormIds_0) WITH ([value] uniqueidentifier '$') AS [a]
)
2026-01-03 23:21:40.035 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (1ms) [Parameters=[@__serverPMReportFormIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[ID], [r].[FormStatus]
FROM [ReportForms] AS [r]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[ID] IN (
    SELECT [s].[value]
    FROM OPENJSON(@__serverPMReportFormIds_0) WITH ([value] uniqueidentifier '$') AS [s]
)
2026-01-03 23:21:40.046 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (2ms) [Parameters=[@__serverPMReportFormIds_0='?' (Size = 4000), @__filteredReportFormIds_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [ReportForms] AS [r]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[ID] IN (
    SELECT [s].[value]
    FROM OPENJSON(@__serverPMReportFormIds_0) WITH ([value] uniqueidentifier '$') AS [s]
) AND [r].[ID] IN (
    SELECT [f].[value]
    FROM OPENJSON(@__filteredReportFormIds_1) WITH ([value] uniqueidentifier '$') AS [f]
)
2026-01-03 23:21:40.053 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (2ms) [Parameters=[@__serverPMReportFormIds_0='?' (Size = 4000), @__filteredReportFormIds_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[ID], [r].[CreatedBy], [r].[CreatedDate], [r].[FormStatus], [r].[IsDeleted], [r].[JobNo], [r].[ReportFormTypeID], [r].[StationNameWarehouseID], [r].[SystemNameWarehouseID], [r].[UpdatedBy], [r].[UpdatedDate], [r].[UploadHostname], [r].[UploadIPAddress], [r].[UploadStatus], [r0].[ID], [r0].[CreatedBy], [r0].[CreatedDate], [r0].[IsDeleted], [r0].[Name], [r0].[UpdatedBy], [r0].[UpdatedDate], [s0].[ID], [s0].[IsDeleted], [s0].[Name], [s1].[ID], [s1].[IsDeleted], [s1].[Name], [s1].[SystemNameWarehouseID], [u].[ID], [u].[CompanyID], [u].[CreatedBy], [u].[CreatedDate], [u].[DateOfBirth], [u].[DepartmentID], [u].[Email], [u].[EmergencyContactName], [u].[EmergencyContactNumber], [u].[EmergencyRelationship], [u].[FirstName], [u].[Gender], [u].[IsDeleted], [u].[LastLogin], [u].[LastName], [u].[LastWorkingDate], [u].[LoginPassword], [u].[MobileNo], [u].[Nationality], [u].[OccupationID], [u].[OccupationLevelID], [u].[Rating], [u].[Religion], [u].[Remark], [u].[StaffCardID], [u].[StaffRFIDCardID], [u].[StartWorkingDate], [u].[SubDepartmentID], [u].[UpdatedBy], [u].[UpdatedDate], [u].[WorkPassCardExpiredDate], [u].[WorkPassCardIssuedDate], [u].[WorkPassCardNumber], [u].[WorkPermit]
FROM [ReportForms] AS [r]
INNER JOIN [ReportFormTypes] AS [r0] ON [r].[ReportFormTypeID] = [r0].[ID]
INNER JOIN [SystemNameWarehouses] AS [s0] ON [r].[SystemNameWarehouseID] = [s0].[ID]
INNER JOIN [StationNameWarehouses] AS [s1] ON [r].[StationNameWarehouseID] = [s1].[ID]
INNER JOIN [Users] AS [u] ON [r].[CreatedBy] = [u].[ID]
WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[ID] IN (
    SELECT [s].[value]
    FROM OPENJSON(@__serverPMReportFormIds_0) WITH ([value] uniqueidentifier '$') AS [s]
) AND [r].[ID] IN (
    SELECT [f].[value]
    FROM OPENJSON(@__filteredReportFormIds_1) WITH ([value] uniqueidentifier '$') AS [f]
)
2026-01-03 23:21:40.070 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[ID], [p].[ApprovedBy], [p].[AttendedBy], [p].[CleaningOfCabinet], [p].[CreatedBy], [p].[CreatedDate], [p].[Customer], [p].[DateOfService], [p].[FormstatusID], [p].[IsDeleted], [p].[PMReportFormTypeID], [p].[ProjectNo], [p].[Remarks], [p].[ReportFormID], [p].[ReportTitle], [p].[UpdatedBy], [p].[UpdatedDate], [f].[ID], [f].[CreatedBy], [f].[CreatedDate], [f].[IsDeleted], [f].[Name], [f].[UpdatedBy], [f].[UpdatedDate], [p0].[ID], [p0].[CreatedBy], [p0].[CreatedDate], [p0].[IsDeleted], [p0].[Name], [p0].[UpdatedBy], [p0].[UpdatedDate]
FROM [PMReportFormRTU] AS [p]
INNER JOIN [FormStatusWarehouses] AS [f] ON [p].[FormstatusID] = [f].[ID]
INNER JOIN [PMReportFormTypes] AS [p0] ON [p].[PMReportFormTypeID] = [p0].[ID]
WHERE [p].[IsDeleted] = CAST(0 AS bit)
2026-01-03 23:21:40.081 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[ID], [p].[AttendedBy], [p].[CompletionDate], [p].[CreatedBy], [p].[CreatedDate], [p].[Customer], [p].[FormstatusID], [p].[IsDeleted], [p].[PMReportFormTypeID], [p].[ProjectNo], [p].[Remarks], [p].[ReportFormID], [p].[ReportTitle], [p].[StartDate], [p].[UpdatedBy], [p].[UpdatedDate], [p].[WitnessedBy], [f].[ID], [f].[CreatedBy], [f].[CreatedDate], [f].[IsDeleted], [f].[Name], [f].[UpdatedBy], [f].[UpdatedDate], [p0].[ID], [p0].[CreatedBy], [p0].[CreatedDate], [p0].[IsDeleted], [p0].[Name], [p0].[UpdatedBy], [p0].[UpdatedDate]
FROM [PMReportFormServer] AS [p]
INNER JOIN [FormStatusWarehouses] AS [f] ON [p].[FormstatusID] = [f].[ID]
INNER JOIN [PMReportFormTypes] AS [p0] ON [p].[PMReportFormTypeID] = [p0].[ID]
WHERE [p].[IsDeleted] = CAST(0 AS bit)
2026-01-03 23:21:40.094 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[ID], [c].[ActionTakenDescription], [c].[ApprovedBy], [c].[ArrivalDate], [c].[AttendedBy], [c].[CMReportFormTypeID], [c].[CompletionDate], [c].[CreatedBy], [c].[CreatedDate], [c].[Customer], [c].[FailureDetectedDate], [c].[FormstatusID], [c].[FurtherActionTakenID], [c].[IsDeleted], [c].[IssueFoundDescription], [c].[IssueReportedDescription], [c].[ProjectNo], [c].[Remark], [c].[ReportFormID], [c].[ReportTitle], [c].[ResponseDate], [c].[UpdatedBy], [c].[UpdatedDate], [f].[ID], [f].[CreatedBy], [f].[CreatedDate], [f].[IsDeleted], [f].[Name], [f].[UpdatedBy], [f].[UpdatedDate], [c0].[ID], [c0].[CreatedBy], [c0].[CreatedDate], [c0].[IsDeleted], [c0].[Name], [c0].[UpdatedBy], [c0].[UpdatedDate]
FROM [CMReportForms] AS [c]
INNER JOIN [FormStatusWarehouses] AS [f] ON [c].[FormstatusID] = [f].[ID]
INNER JOIN [CMReportFormTypes] AS [c0] ON [c].[CMReportFormTypeID] = [c0].[ID]
WHERE [c].[IsDeleted] = CAST(0 AS bit)
2026-01-03 23:21:40.113 [INF] Microsoft.EntityFrameworkCore.Database.Command - Executed DbCommand (12ms) [Parameters=[@__twelveMonthsAgo_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [r0].[Year], [r0].[Month], COUNT(*) AS [Count]
FROM (
    SELECT DATEPART(year, [r].[CreatedDate]) AS [Year], DATEPART(month, [r].[CreatedDate]) AS [Month]
    FROM [ReportForms] AS [r]
    WHERE [r].[IsDeleted] = CAST(0 AS bit) AND [r].[CreatedDate] >= @__twelveMonthsAgo_0
) AS [r0]
GROUP BY [r0].[Year], [r0].[Month]
ORDER BY [r0].[Year], [r0].[Month]
